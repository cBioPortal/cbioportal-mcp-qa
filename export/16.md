# Question 16

**Type:** Basic/statistical

**Question:** What is the range of tumor purity observed in metastatic breast cancer samples?

**Answer:**

Based on my analysis of the MSK-CHORD 2024 dataset, here are the key findings about tumor purity in metastatic breast cancer samples:

## Tumor Purity Range in Metastatic Breast Cancer Samples

**Range:** 5% to 95% tumor purity

**Key Statistics:**
- **Minimum:** 5%
- **Maximum:** 95%
- **Average:** 42.6%
- **Median:** 40%
- **Sample size:** 2,410 metastatic breast cancer samples with tumor purity data

**Distribution:**
- **10th percentile:** 10%
- **25th percentile (Q1):** 30%
- **75th percentile (Q3):** 60%
- **90th percentile:** 70%

**Summary:**
The tumor purity in metastatic breast cancer samples shows a wide range from 5% to 95%, with most samples (50%) falling between 30% and 60% purity. The average tumor purity is approximately 43%, indicating that metastatic breast cancer samples typically contain a significant mixture of cancer and non-cancer cells. The broad range suggests considerable heterogeneity in the cellular composition of metastatic breast cancer samples, which is clinically relevant for genomic analysis and treatment decisions.

---

## SQL Queries Executed

### Query 1
**Timestamp:** 2025-07-22 18:16:28

```sql
SELECT attr_id, description, patient_attribute
FROM cgds_public_2025_06_24.clinical_attribute_meta
WHERE cancer_study_id = (SELECT cancer_study_id FROM cgds_public_2025_06_24.cancer_study WHERE cancer_study_identifier = 'msk_chord_2024')
AND (LOWER(description) LIKE '%purity%' OR LOWER(attr_id) LIKE '%purity%')
ORDER BY attr_id
```

### Query 2
**Timestamp:** 2025-07-22 18:16:31

```sql
SELECT DISTINCT attribute_name, attribute_value
FROM cgds_public_2025_06_24.clinical_data_derived
WHERE cancer_study_identifier = 'msk_chord_2024'
AND attribute_name = 'CANCER_TYPE'
AND LOWER(attribute_value) LIKE '%breast%'
```

### Query 3
**Timestamp:** 2025-07-22 18:16:34

```sql
SELECT DISTINCT attribute_value
FROM cgds_public_2025_06_24.clinical_data_derived
WHERE cancer_study_identifier = 'msk_chord_2024'
AND attribute_name = 'SAMPLE_TYPE'
ORDER BY attribute_value
```

### Query 4
**Timestamp:** 2025-07-22 18:16:41

```sql
WITH breast_metastatic_samples AS (
SELECT DISTINCT cd1.sample_unique_id
FROM cgds_public_2025_06_24.clinical_data_derived cd1
INNER JOIN cgds_public_2025_06_24.clinical_data_derived cd2
ON cd1.sample_unique_id = cd2.sample_unique_id
AND cd1.cancer_study_identifier = cd2.cancer_study_identifier
WHERE cd1.cancer_study_identifier = 'msk_chord_2024'
AND cd1.attribute_name = 'CANCER_TYPE'
AND cd1.attribute_value = 'Breast Cancer'
AND cd2.attribute_name = 'SAMPLE_TYPE'
AND cd2.attribute_value = 'Metastasis'
)
SELECT
MIN(CAST(cd.attribute_value AS Float64)) as min_tumor_purity,
MAX(CAST(cd.attribute_value AS Float64)) as max_tumor_purity,
AVG(CAST(cd.attribute_value AS Float64)) as avg_tumor_purity,
COUNT(*) as sample_count,
COUNT(CASE WHEN cd.attribute_value != '' AND cd.attribute_value IS NOT NULL THEN 1 END) as samples_with_purity_data
FROM cgds_public_2025_06_24.clinical_data_derived cd
INNER JOIN breast_metastatic_samples bms ON cd.sample_unique_id = bms.sample_unique_id
WHERE cd.cancer_study_identifier = 'msk_chord_2024'
AND cd.attribute_name = 'TUMOR_PURITY'
AND cd.attribute_value != ''
AND cd.attribute_value IS NOT NULL
```

### Query 5
**Timestamp:** 2025-07-22 18:16:46

```sql
WITH breast_metastatic_samples AS (
SELECT DISTINCT cd1.sample_unique_id
FROM cgds_public_2025_06_24.clinical_data_derived cd1
INNER JOIN cgds_public_2025_06_24.clinical_data_derived cd2
ON cd1.sample_unique_id = cd2.sample_unique_id
AND cd1.cancer_study_identifier = cd2.cancer_study_identifier
WHERE cd1.cancer_study_identifier = 'msk_chord_2024'
AND cd1.attribute_name = 'CANCER_TYPE'
AND cd1.attribute_value = 'Breast Cancer'
AND cd2.attribute_name = 'SAMPLE_TYPE'
AND cd2.attribute_value = 'Metastasis'
),
purity_data AS (
SELECT CAST(cd.attribute_value AS Float64) as tumor_purity
FROM cgds_public_2025_06_24.clinical_data_derived cd
INNER JOIN breast_metastatic_samples bms ON cd.sample_unique_id = bms.sample_unique_id
WHERE cd.cancer_study_identifier = 'msk_chord_2024'
AND cd.attribute_name = 'TUMOR_PURITY'
AND cd.attribute_value != ''
AND cd.attribute_value IS NOT NULL
)
SELECT
quantile(0.25)(tumor_purity) as q25,
quantile(0.5)(tumor_purity) as median,
quantile(0.75)(tumor_purity) as q75,
quantile(0.9)(tumor_purity) as q90,
quantile(0.1)(tumor_purity) as q10
FROM purity_data
```


---

*Generated on 2025-07-22 18:16:52*