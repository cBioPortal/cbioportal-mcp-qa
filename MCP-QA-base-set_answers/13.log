Processing 1 questions...
Processing questions:   0%|          | 0/1 [00:00<?, ?it/s]Processing question 13:   0%|          | 0/1 [00:00<?, ?it/s]INFO:cbioportal_mcp.server:ðŸš€ Starting cBioPortal MCP Server with FastMCP...


â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                                            â”‚
â”‚        _ __ ___  _____           __  __  _____________    ____    ____     â”‚
â”‚       _ __ ___ .'____/___ ______/ /_/  |/  / ____/ __ \  |___ \  / __ \    â”‚
â”‚      _ __ ___ / /_  / __ `/ ___/ __/ /|_/ / /   / /_/ /  ___/ / / / / /    â”‚
â”‚     _ __ ___ / __/ / /_/ (__  ) /_/ /  / / /___/ ____/  /  __/_/ /_/ /     â”‚
â”‚    _ __ ___ /_/    \____/____/\__/_/  /_/\____/_/      /_____(*)____/      â”‚
â”‚                                                                            â”‚
â”‚                                                                            â”‚
â”‚                                FastMCP  2.0                                â”‚
â”‚                                                                            â”‚
â”‚                                                                            â”‚
â”‚                 ðŸ–¥ï¸  Server name:     cBioPortal MCP Server                  â”‚
â”‚                 ðŸ“¦ Transport:       STDIO                                  â”‚
â”‚                                                                            â”‚
â”‚                 ðŸŽï¸  FastMCP version: 2.12.4                                 â”‚
â”‚                 ðŸ¤ MCP SDK version: 1.15.0                                 â”‚
â”‚                                                                            â”‚
â”‚                 ðŸ“š Docs:            https://gofastmcp.com                  â”‚
â”‚                 ðŸš€ Deploy:          https://fastmcp.cloud                  â”‚
â”‚                                                                            â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯


[10/02/25 09:40:38] INFO     Starting MCP server 'cBioPortal MCP  server.py:1502
                             Server' with transport 'stdio'                     
INFO:mcp.server.lowlevel.server:Processing request of type ListToolsRequest
INFO:mcp.server.lowlevel.server:Processing request of type CallToolRequest
INFO:cbioportal_mcp.server:clickhouse_list_tables: called
INFO:mcp-clickhouse:ClickHouse tools registered
INFO:mcp-clickhouse:Executing SELECT query: SELECT name, primary_key, total_rows, comment FROM system.tables WHERE database = currentDatabase()
INFO:mcp-clickhouse:Creating ClickHouse client connection to mecgt250i0.us-east-1.aws.clickhouse.cloud:8443 as app_user (secure=True, verify=True, connect_timeout=30s, send_receive_timeout=300s)
INFO:mcp-clickhouse:Successfully connected to ClickHouse server version 25.6.2.6151
INFO:mcp-clickhouse:Query returned 63 rows
INFO:mcp.server.lowlevel.server:Warning: DeprecationWarning: The 'dependencies' parameter is deprecated as of FastMCP 2.11.4 and will be removed in a future version. Please specify dependencies in a fastmcp.json configuration file instead:
{
  "entrypoint": "your_server.py",
  "environment": {
    "dependencies": ["clickhouse-connect", "python-dotenv", "pip-system-certs", "chdb"]
  }
}
See https://gofastmcp.com/docs/deployment/server-configuration for more information.
INFO:mcp.server.lowlevel.server:Processing request of type ListToolsRequest
INFO:mcp.server.lowlevel.server:Processing request of type CallToolRequest
INFO:cbioportal_mcp.server:clickhouse_list_table_columns: called
INFO:mcp-clickhouse:Executing SELECT query: SELECT name, type, comment FROM system.columns WHERE table='genomic_event_derived' and database = currentDatabase()
INFO:mcp-clickhouse:Creating ClickHouse client connection to mecgt250i0.us-east-1.aws.clickhouse.cloud:8443 as app_user (secure=True, verify=True, connect_timeout=30s, send_receive_timeout=300s)
INFO:mcp-clickhouse:Successfully connected to ClickHouse server version 25.6.2.6151
INFO:mcp-clickhouse:Query returned 17 rows
INFO:mcp.server.lowlevel.server:Processing request of type ListToolsRequest
INFO:mcp.server.lowlevel.server:Processing request of type CallToolRequest
INFO:cbioportal_mcp.server:clickhouse_list_table_columns: called
INFO:mcp-clickhouse:Executing SELECT query: SELECT name, type, comment FROM system.columns WHERE table='clinical_data_derived' and database = currentDatabase()
INFO:mcp-clickhouse:Creating ClickHouse client connection to mecgt250i0.us-east-1.aws.clickhouse.cloud:8443 as app_user (secure=True, verify=True, connect_timeout=30s, send_receive_timeout=300s)
INFO:mcp-clickhouse:Successfully connected to ClickHouse server version 25.6.2.6151
INFO:mcp-clickhouse:Query returned 7 rows
INFO:mcp.server.lowlevel.server:Processing request of type ListToolsRequest
INFO:mcp.server.lowlevel.server:Processing request of type CallToolRequest
INFO:mcp-clickhouse:Executing SELECT query: SELECT cancer_study_identifier, name, description 
FROM cancer_study 
WHERE cancer_study_identifier LIKE '%tcga%' 
ORDER BY cancer_study_identifier
INFO:mcp-clickhouse:Creating ClickHouse client connection to mecgt250i0.us-east-1.aws.clickhouse.cloud:8443 as app_user (secure=True, verify=True, connect_timeout=30s, send_receive_timeout=300s)
INFO:mcp-clickhouse:Successfully connected to ClickHouse server version 25.6.2.6151
INFO:mcp-clickhouse:Query returned 123 rows
INFO:mcp.server.lowlevel.server:Processing request of type ListToolsRequest
INFO:mcp.server.lowlevel.server:Processing request of type CallToolRequest
INFO:mcp-clickhouse:Executing SELECT query: SELECT DISTINCT attribute_name 
FROM clinical_data_derived 
WHERE cancer_study_identifier LIKE '%pan_can_atlas%' 
AND (attribute_name LIKE '%SURV%' OR attribute_name LIKE '%OS%' OR attribute_name LIKE '%VITAL%' OR attribute_name LIKE '%DEATH%' OR attribute_name LIKE '%TIME%')
ORDER BY attribute_name
INFO:mcp-clickhouse:Creating ClickHouse client connection to mecgt250i0.us-east-1.aws.clickhouse.cloud:8443 as app_user (secure=True, verify=True, connect_timeout=30s, send_receive_timeout=300s)
INFO:mcp-clickhouse:Successfully connected to ClickHouse server version 25.6.2.6151
INFO:mcp-clickhouse:Query returned 5 rows
INFO:mcp.server.lowlevel.server:Processing request of type ListToolsRequest
INFO:mcp.server.lowlevel.server:Processing request of type CallToolRequest
INFO:mcp-clickhouse:Executing SELECT query: SELECT cancer_study_identifier, COUNT(*) as patient_count
FROM clinical_data_derived 
WHERE cancer_study_identifier LIKE '%pan_can_atlas%' 
AND type = 'patient'
GROUP BY cancer_study_identifier
ORDER BY patient_count DESC
LIMIT 10
INFO:mcp-clickhouse:Creating ClickHouse client connection to mecgt250i0.us-east-1.aws.clickhouse.cloud:8443 as app_user (secure=True, verify=True, connect_timeout=30s, send_receive_timeout=300s)
INFO:mcp-clickhouse:Successfully connected to ClickHouse server version 25.6.2.6151
INFO:mcp-clickhouse:Query returned 10 rows
INFO:mcp.server.lowlevel.server:Processing request of type ListToolsRequest
INFO:mcp.server.lowlevel.server:Processing request of type CallToolRequest
INFO:mcp-clickhouse:Executing SELECT query: SELECT cancer_study_identifier, COUNT(DISTINCT patient_unique_id) as patients_with_mutations
FROM genomic_event_derived 
WHERE cancer_study_identifier LIKE '%pan_can_atlas%' 
AND variant_type = 'mutation'
AND hugo_gene_symbol IN ('TP53', 'KRAS')
GROUP BY cancer_study_identifier
ORDER BY patients_with_mutations DESC
LIMIT 10
INFO:mcp-clickhouse:Creating ClickHouse client connection to mecgt250i0.us-east-1.aws.clickhouse.cloud:8443 as app_user (secure=True, verify=True, connect_timeout=30s, send_receive_timeout=300s)
INFO:mcp-clickhouse:Successfully connected to ClickHouse server version 25.6.2.6151
INFO:mcp-clickhouse:Query returned 10 rows
INFO:mcp.server.lowlevel.server:Processing request of type ListToolsRequest
INFO:mcp.server.lowlevel.server:Processing request of type CallToolRequest
ERROR:cbioportal_mcp.server:clickhouse_run_select_query: Non select queries are forbidden: 'WITH mutation_status AS (
  SELECT 
    patient_unique_id,
    cancer_study_identifier,
    SUM(CASE WHEN hugo_gene_symbol = 'TP53' THEN 1 ELSE 0 END) as tp53_mutations,
    SUM(CASE WHEN hugo_gene_symbol = 'KRAS' THEN 1 ELSE 0 END) as kras_mutations
  FROM genomic_event_derived 
  WHERE cancer_study_identifier LIKE '%pan_can_atlas%' 
    AND variant_type = 'mutation'
    AND hugo_gene_symbol IN ('TP53', 'KRAS')
  GROUP BY patient_unique_id, cancer_study_identifier
),
patient_groups AS (
  SELECT 
    patient_unique_id,
    cancer_study_identifier,
    CASE 
      WHEN tp53_mutations > 0 AND kras_mutations > 0 THEN 'TP53_and_KRAS'
      WHEN tp53_mutations = 0 AND kras_mutations > 0 THEN 'KRAS_only'
      WHEN tp53_mutations > 0 AND kras_mutations = 0 THEN 'TP53_only'
      ELSE 'Neither'
    END as mutation_group
  FROM mutation_status
)
SELECT 
  mutation_group,
  COUNT(*) as patient_count,
  COUNT(DISTINCT cancer_study_identifier) as study_count
FROM patient_groups
WHERE mutation_group IN ('TP53_and_KRAS', 'KRAS_only')
GROUP BY mutation_group
ORDER BY patient_count DESC'. Skipping the query.
INFO:mcp.server.lowlevel.server:Processing request of type ListToolsRequest
INFO:mcp.server.lowlevel.server:Processing request of type CallToolRequest
INFO:mcp-clickhouse:Executing SELECT query: SELECT 
  patient_unique_id,
  cancer_study_identifier,
  hugo_gene_symbol,
  COUNT(*) as mutation_count
FROM genomic_event_derived 
WHERE cancer_study_identifier LIKE '%pan_can_atlas%' 
  AND variant_type = 'mutation'
  AND hugo_gene_symbol IN ('TP53', 'KRAS')
GROUP BY patient_unique_id, cancer_study_identifier, hugo_gene_symbol
ORDER BY patient_unique_id
LIMIT 20
INFO:mcp-clickhouse:Creating ClickHouse client connection to mecgt250i0.us-east-1.aws.clickhouse.cloud:8443 as app_user (secure=True, verify=True, connect_timeout=30s, send_receive_timeout=300s)
INFO:mcp-clickhouse:Successfully connected to ClickHouse server version 25.6.2.6151
INFO:mcp-clickhouse:Query returned 20 rows
INFO:mcp.server.lowlevel.server:Processing request of type ListToolsRequest
INFO:mcp.server.lowlevel.server:Processing request of type CallToolRequest
INFO:mcp-clickhouse:Executing SELECT query: SELECT 
  g.patient_unique_id,
  g.cancer_study_identifier,
  groupArray(g.hugo_gene_symbol) as mutated_genes,
  CASE 
    WHEN has(groupArray(g.hugo_gene_symbol), 'TP53') AND has(groupArray(g.hugo_gene_symbol), 'KRAS') THEN 'TP53_and_KRAS'
    WHEN NOT has(groupArray(g.hugo_gene_symbol), 'TP53') AND has(groupArray(g.hugo_gene_symbol), 'KRAS') THEN 'KRAS_only'
    WHEN has(groupArray(g.hugo_gene_symbol), 'TP53') AND NOT has(groupArray(g.hugo_gene_symbol), 'KRAS') THEN 'TP53_only'
    ELSE 'Neither'
  END as mutation_group
FROM genomic_event_derived g
WHERE g.cancer_study_identifier LIKE '%pan_can_atlas%' 
  AND g.variant_type = 'mutation'
  AND g.hugo_gene_symbol IN ('TP53', 'KRAS')
GROUP BY g.patient_unique_id, g.cancer_study_identifier
HAVING mutation_group IN ('TP53_and_KRAS', 'KRAS_only')
ORDER BY g.patient_unique_id
LIMIT 20
INFO:mcp-clickhouse:Creating ClickHouse client connection to mecgt250i0.us-east-1.aws.clickhouse.cloud:8443 as app_user (secure=True, verify=True, connect_timeout=30s, send_receive_timeout=300s)
INFO:mcp-clickhouse:Successfully connected to ClickHouse server version 25.6.2.6151
INFO:mcp-clickhouse:Query returned 20 rows
INFO:mcp.server.lowlevel.server:Processing request of type ListToolsRequest
INFO:mcp.server.lowlevel.server:Processing request of type CallToolRequest
INFO:mcp-clickhouse:Executing SELECT query: SELECT 
  CASE 
    WHEN has(groupArray(g.hugo_gene_symbol), 'TP53') AND has(groupArray(g.hugo_gene_symbol), 'KRAS') THEN 'TP53_and_KRAS'
    WHEN NOT has(groupArray(g.hugo_gene_symbol), 'TP53') AND has(groupArray(g.hugo_gene_symbol), 'KRAS') THEN 'KRAS_only'
    WHEN has(groupArray(g.hugo_gene_symbol), 'TP53') AND NOT has(groupArray(g.hugo_gene_symbol), 'KRAS') THEN 'TP53_only'
    ELSE 'Neither'
  END as mutation_group,
  COUNT(*) as patient_count
FROM genomic_event_derived g
WHERE g.cancer_study_identifier LIKE '%pan_can_atlas%' 
  AND g.variant_type = 'mutation'
  AND g.hugo_gene_symbol IN ('TP53', 'KRAS')
GROUP BY g.patient_unique_id, g.cancer_study_identifier
HAVING mutation_group IN ('TP53_and_KRAS', 'KRAS_only')
GROUP BY mutation_group
ORDER BY patient_count DESC
INFO:mcp-clickhouse:Creating ClickHouse client connection to mecgt250i0.us-east-1.aws.clickhouse.cloud:8443 as app_user (secure=True, verify=True, connect_timeout=30s, send_receive_timeout=300s)
INFO:mcp-clickhouse:Successfully connected to ClickHouse server version 25.6.2.6151
ERROR:mcp-clickhouse:Error executing query: Received ClickHouse exception, code: 62, server response: Code: 62. DB::Exception: Syntax error: failed at position 731 (GROUP) (line 15, col 1): GROUP BY mutation_group
ORDER BY patient_count DESC
 FORMAT Native. Expected one of: token, DoubleColon, OR, AND, IS NOT DISTINCT FROM, IS NULL, IS NOT NULL, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, alias, AS, WINDOW, QUALIFY, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT, INTO OUTFILE, FORMAT, ParallelWithClause, PARALLEL WITH, end of query. (SYNTAX_ERROR) (version 25.6.2.6151 (official build)) (for url https://mecgt250i0.us-east-1.aws.clickhouse.cloud:8443)
ERROR:cbioportal_mcp.server:clickhouse_run_select_query: Query execution failed: Received ClickHouse exception, code: 62, server response: Code: 62. DB::Exception: Syntax error: failed at position 731 (GROUP) (line 15, col 1): GROUP BY mutation_group
ORDER BY patient_count DESC
 FORMAT Native. Expected one of: token, DoubleColon, OR, AND, IS NOT DISTINCT FROM, IS NULL, IS NOT NULL, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, alias, AS, WINDOW, QUALIFY, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT, INTO OUTFILE, FORMAT, ParallelWithClause, PARALLEL WITH, end of query. (SYNTAX_ERROR) (version 25.6.2.6151 (official build)) (for url https://mecgt250i0.us-east-1.aws.clickhouse.cloud:8443)
INFO:mcp.server.lowlevel.server:Processing request of type ListToolsRequest
INFO:mcp.server.lowlevel.server:Processing request of type CallToolRequest
INFO:mcp-clickhouse:Executing SELECT query: SELECT 
  mutation_group,
  COUNT(*) as patient_count
FROM (
  SELECT 
    g.patient_unique_id,
    CASE 
      WHEN has(groupArray(g.hugo_gene_symbol), 'TP53') AND has(groupArray(g.hugo_gene_symbol), 'KRAS') THEN 'TP53_and_KRAS'
      WHEN NOT has(groupArray(g.hugo_gene_symbol), 'TP53') AND has(groupArray(g.hugo_gene_symbol), 'KRAS') THEN 'KRAS_only'
      WHEN has(groupArray(g.hugo_gene_symbol), 'TP53') AND NOT has(groupArray(g.hugo_gene_symbol), 'KRAS') THEN 'TP53_only'
      ELSE 'Neither'
    END as mutation_group
  FROM genomic_event_derived g
  WHERE g.cancer_study_identifier LIKE '%pan_can_atlas%' 
    AND g.variant_type = 'mutation'
    AND g.hugo_gene_symbol IN ('TP53', 'KRAS')
  GROUP BY g.patient_unique_id, g.cancer_study_identifier
  HAVING mutation_group IN ('TP53_and_KRAS', 'KRAS_only')
)
GROUP BY mutation_group
ORDER BY patient_count DESC
INFO:mcp-clickhouse:Creating ClickHouse client connection to mecgt250i0.us-east-1.aws.clickhouse.cloud:8443 as app_user (secure=True, verify=True, connect_timeout=30s, send_receive_timeout=300s)
INFO:mcp-clickhouse:Successfully connected to ClickHouse server version 25.6.2.6151
INFO:mcp-clickhouse:Query returned 2 rows
INFO:mcp.server.lowlevel.server:Processing request of type ListToolsRequest
INFO:mcp.server.lowlevel.server:Processing request of type CallToolRequest
INFO:mcp-clickhouse:Executing SELECT query: SELECT 
  mutation_groups.mutation_group,
  c.attribute_name,
  c.attribute_value,
  COUNT(*) as count
FROM (
  SELECT 
    g.patient_unique_id,
    g.cancer_study_identifier,
    CASE 
      WHEN has(groupArray(g.hugo_gene_symbol), 'TP53') AND has(groupArray(g.hugo_gene_symbol), 'KRAS') THEN 'TP53_and_KRAS'
      WHEN NOT has(groupArray(g.hugo_gene_symbol), 'TP53') AND has(groupArray(g.hugo_gene_symbol), 'KRAS') THEN 'KRAS_only'
    END as mutation_group
  FROM genomic_event_derived g
  WHERE g.cancer_study_identifier LIKE '%pan_can_atlas%' 
    AND g.variant_type = 'mutation'
    AND g.hugo_gene_symbol IN ('TP53', 'KRAS')
  GROUP BY g.patient_unique_id, g.cancer_study_identifier
  HAVING mutation_group IN ('TP53_and_KRAS', 'KRAS_only')
) mutation_groups
JOIN clinical_data_derived c ON mutation_groups.patient_unique_id = c.patient_unique_id 
  AND mutation_groups.cancer_study_identifier = c.cancer_study_identifier
WHERE c.attribute_name IN ('OS_MONTHS', 'OS_STATUS')
  AND c.type = 'patient'
  AND c.attribute_value != ''
GROUP BY mutation_groups.mutation_group, c.attribute_name, c.attribute_value
ORDER BY mutation_groups.mutation_group, c.attribute_name, c.attribute_value
INFO:mcp-clickhouse:Creating ClickHouse client connection to mecgt250i0.us-east-1.aws.clickhouse.cloud:8443 as app_user (secure=True, verify=True, connect_timeout=30s, send_receive_timeout=300s)
INFO:mcp-clickhouse:Successfully connected to ClickHouse server version 25.6.2.6151
INFO:mcp-clickhouse:Query returned 659 rows
INFO:mcp.server.lowlevel.server:Processing request of type ListToolsRequest
INFO:mcp.server.lowlevel.server:Processing request of type CallToolRequest
INFO:mcp-clickhouse:Executing SELECT query: SELECT 
  mutation_groups.mutation_group,
  COUNT(*) as total_patients,
  AVG(CASE WHEN c.attribute_name = 'OS_MONTHS' THEN toFloat64(c.attribute_value) ELSE NULL END) as mean_survival_months,
  quantile(0.5)(CASE WHEN c.attribute_name = 'OS_MONTHS' THEN toFloat64(c.attribute_value) ELSE NULL END) as median_survival_months,
  SUM(CASE WHEN c.attribute_name = 'OS_STATUS' AND c.attribute_value = '1:DECEASED' THEN 1 ELSE 0 END) as deaths,
  SUM(CASE WHEN c.attribute_name = 'OS_STATUS' AND c.attribute_value = '0:LIVING' THEN 1 ELSE 0 END) as living
FROM (
  SELECT 
    g.patient_unique_id,
    g.cancer_study_identifier,
    CASE 
      WHEN has(groupArray(g.hugo_gene_symbol), 'TP53') AND has(groupArray(g.hugo_gene_symbol), 'KRAS') THEN 'TP53_and_KRAS'
      WHEN NOT has(groupArray(g.hugo_gene_symbol), 'TP53') AND has(groupArray(g.hugo_gene_symbol), 'KRAS') THEN 'KRAS_only'
    END as mutation_group
  FROM genomic_event_derived g
  WHERE g.cancer_study_identifier LIKE '%pan_can_atlas%' 
    AND g.variant_type = 'mutation'
    AND g.hugo_gene_symbol IN ('TP53', 'KRAS')
  GROUP BY g.patient_unique_id, g.cancer_study_identifier
  HAVING mutation_group IN ('TP53_and_KRAS', 'KRAS_only')
) mutation_groups
JOIN clinical_data_derived c ON mutation_groups.patient_unique_id = c.patient_unique_id 
  AND mutation_groups.cancer_study_identifier = c.cancer_study_identifier
WHERE c.attribute_name IN ('OS_MONTHS', 'OS_STATUS')
  AND c.type = 'patient'
  AND c.attribute_value != ''
GROUP BY mutation_groups.mutation_group
ORDER BY mutation_groups.mutation_group
INFO:mcp-clickhouse:Creating ClickHouse client connection to mecgt250i0.us-east-1.aws.clickhouse.cloud:8443 as app_user (secure=True, verify=True, connect_timeout=30s, send_receive_timeout=300s)
INFO:mcp-clickhouse:Successfully connected to ClickHouse server version 25.6.2.6151
ERROR:mcp-clickhouse:Error executing query: Received ClickHouse exception, code: 6, server response: Code: 6. DB::Exception: Cannot parse string '0:LIVING' as Float64: syntax error at position 1 (parsed just '0'). Note: there are toFloat64OrZero and toFloat64OrNull functions, which returns zero/NULL instead of throwing exception.: while executing 'FUNCTION toFloat64(__table3.attribute_value : 1) -> toFloat64(__table3.attribute_value) Float64 : 10'. (CANNOT_PARSE_TEXT) (version 25.6.2.6151 (official build)) (for url https://mecgt250i0.us-east-1.aws.clickhouse.cloud:8443)
ERROR:cbioportal_mcp.server:clickhouse_run_select_query: Query execution failed: Received ClickHouse exception, code: 6, server response: Code: 6. DB::Exception: Cannot parse string '0:LIVING' as Float64: syntax error at position 1 (parsed just '0'). Note: there are toFloat64OrZero and toFloat64OrNull functions, which returns zero/NULL instead of throwing exception.: while executing 'FUNCTION toFloat64(__table3.attribute_value : 1) -> toFloat64(__table3.attribute_value) Float64 : 10'. (CANNOT_PARSE_TEXT) (version 25.6.2.6151 (official build)) (for url https://mecgt250i0.us-east-1.aws.clickhouse.cloud:8443)
INFO:mcp.server.lowlevel.server:Processing request of type ListToolsRequest
INFO:mcp.server.lowlevel.server:Processing request of type CallToolRequest
INFO:mcp-clickhouse:Executing SELECT query: SELECT 
  mutation_groups.mutation_group,
  COUNT(DISTINCT mutation_groups.patient_unique_id) as total_patients,
  AVG(CASE WHEN c.attribute_name = 'OS_MONTHS' THEN toFloat64OrNull(c.attribute_value) ELSE NULL END) as mean_survival_months,
  quantile(0.5)(CASE WHEN c.attribute_name = 'OS_MONTHS' THEN toFloat64OrNull(c.attribute_value) ELSE NULL END) as median_survival_months,
  COUNT(CASE WHEN c.attribute_name = 'OS_STATUS' AND c.attribute_value = '1:DECEASED' THEN 1 ELSE NULL END) as deaths,
  COUNT(CASE WHEN c.attribute_name = 'OS_STATUS' AND c.attribute_value = '0:LIVING' THEN 1 ELSE NULL END) as living
FROM (
  SELECT 
    g.patient_unique_id,
    g.cancer_study_identifier,
    CASE 
      WHEN has(groupArray(g.hugo_gene_symbol), 'TP53') AND has(groupArray(g.hugo_gene_symbol), 'KRAS') THEN 'TP53_and_KRAS'
      WHEN NOT has(groupArray(g.hugo_gene_symbol), 'TP53') AND has(groupArray(g.hugo_gene_symbol), 'KRAS') THEN 'KRAS_only'
    END as mutation_group
  FROM genomic_event_derived g
  WHERE g.cancer_study_identifier LIKE '%pan_can_atlas%' 
    AND g.variant_type = 'mutation'
    AND g.hugo_gene_symbol IN ('TP53', 'KRAS')
  GROUP BY g.patient_unique_id, g.cancer_study_identifier
  HAVING mutation_group IN ('TP53_and_KRAS', 'KRAS_only')
) mutation_groups
JOIN clinical_data_derived c ON mutation_groups.patient_unique_id = c.patient_unique_id 
  AND mutation_groups.cancer_study_identifier = c.cancer_study_identifier
WHERE c.attribute_name IN ('OS_MONTHS', 'OS_STATUS')
  AND c.type = 'patient'
  AND c.attribute_value != ''
GROUP BY mutation_groups.mutation_group
ORDER BY mutation_groups.mutation_group
INFO:mcp-clickhouse:Creating ClickHouse client connection to mecgt250i0.us-east-1.aws.clickhouse.cloud:8443 as app_user (secure=True, verify=True, connect_timeout=30s, send_receive_timeout=300s)
INFO:mcp-clickhouse:Successfully connected to ClickHouse server version 25.6.2.6151
INFO:mcp-clickhouse:Query returned 2 rows
INFO:mcp.server.lowlevel.server:Processing request of type ListToolsRequest
INFO:mcp.server.lowlevel.server:Processing request of type CallToolRequest
INFO:mcp-clickhouse:Executing SELECT query: SELECT 
  mutation_groups.mutation_group,
  COUNT(DISTINCT mutation_groups.patient_unique_id) as total_patients,
  AVG(CASE WHEN c.attribute_name = 'OS_MONTHS' THEN toFloat64OrNull(c.attribute_value) ELSE NULL END) as mean_survival_months,
  quantile(0.5)(CASE WHEN c.attribute_name = 'OS_MONTHS' THEN toFloat64OrNull(c.attribute_value) ELSE NULL END) as median_survival_months,
  quantile(0.25)(CASE WHEN c.attribute_name = 'OS_MONTHS' THEN toFloat64OrNull(c.attribute_value) ELSE NULL END) as q1_survival_months,
  quantile(0.75)(CASE WHEN c.attribute_name = 'OS_MONTHS' THEN toFloat64OrNull(c.attribute_value) ELSE NULL END) as q3_survival_months,
  stddevPop(CASE WHEN c.attribute_name = 'OS_MONTHS' THEN toFloat64OrNull(c.attribute_value) ELSE NULL END) as std_survival_months,
  COUNT(CASE WHEN c.attribute_name = 'OS_STATUS' AND c.attribute_value = '1:DECEASED' THEN 1 ELSE NULL END) as deaths,
  COUNT(CASE WHEN c.attribute_name = 'OS_STATUS' AND c.attribute_value = '0:LIVING' THEN 1 ELSE NULL END) as living,
  COUNT(CASE WHEN c.attribute_name = 'OS_STATUS' AND c.attribute_value = '1:DECEASED' THEN 1 ELSE NULL END) / COUNT(DISTINCT mutation_groups.patient_unique_id) as death_rate
FROM (
  SELECT 
    g.patient_unique_id,
    g.cancer_study_identifier,
    CASE 
      WHEN has(groupArray(g.hugo_gene_symbol), 'TP53') AND has(groupArray(g.hugo_gene_symbol), 'KRAS') THEN 'TP53_and_KRAS'
      WHEN NOT has(groupArray(g.hugo_gene_symbol), 'TP53') AND has(groupArray(g.hugo_gene_symbol), 'KRAS') THEN 'KRAS_only'
    END as mutation_group
  FROM genomic_event_derived g
  WHERE g.cancer_study_identifier LIKE '%pan_can_atlas%' 
    AND g.variant_type = 'mutation'
    AND g.hugo_gene_symbol IN ('TP53', 'KRAS')
  GROUP BY g.patient_unique_id, g.cancer_study_identifier
  HAVING mutation_group IN ('TP53_and_KRAS', 'KRAS_only')
) mutation_groups
JOIN clinical_data_derived c ON mutation_groups.patient_unique_id = c.patient_unique_id 
  AND mutation_groups.cancer_study_identifier = c.cancer_study_identifier
WHERE c.attribute_name IN ('OS_MONTHS', 'OS_STATUS')
  AND c.type = 'patient'
  AND c.attribute_value != ''
GROUP BY mutation_groups.mutation_group
ORDER BY mutation_groups.mutation_group
INFO:mcp-clickhouse:Creating ClickHouse client connection to mecgt250i0.us-east-1.aws.clickhouse.cloud:8443 as app_user (secure=True, verify=True, connect_timeout=30s, send_receive_timeout=300s)
INFO:mcp-clickhouse:Successfully connected to ClickHouse server version 25.6.2.6151
INFO:mcp-clickhouse:Query returned 2 rows
INFO:mcp.server.lowlevel.server:Processing request of type ListToolsRequest
INFO:mcp.server.lowlevel.server:Processing request of type CallToolRequest
INFO:mcp-clickhouse:Executing SELECT query: SELECT 
  mutation_groups.mutation_group,
  mutation_groups.cancer_study_identifier,
  COUNT(DISTINCT mutation_groups.patient_unique_id) as patient_count
FROM (
  SELECT 
    g.patient_unique_id,
    g.cancer_study_identifier,
    CASE 
      WHEN has(groupArray(g.hugo_gene_symbol), 'TP53') AND has(groupArray(g.hugo_gene_symbol), 'KRAS') THEN 'TP53_and_KRAS'
      WHEN NOT has(groupArray(g.hugo_gene_symbol), 'TP53') AND has(groupArray(g.hugo_gene_symbol), 'KRAS') THEN 'KRAS_only'
    END as mutation_group
  FROM genomic_event_derived g
  WHERE g.cancer_study_identifier LIKE '%pan_can_atlas%' 
    AND g.variant_type = 'mutation'
    AND g.hugo_gene_symbol IN ('TP53', 'KRAS')
  GROUP BY g.patient_unique_id, g.cancer_study_identifier
  HAVING mutation_group IN ('TP53_and_KRAS', 'KRAS_only')
) mutation_groups
GROUP BY mutation_groups.mutation_group, mutation_groups.cancer_study_identifier
ORDER BY mutation_groups.mutation_group, patient_count DESC
INFO:mcp-clickhouse:Creating ClickHouse client connection to mecgt250i0.us-east-1.aws.clickhouse.cloud:8443 as app_user (secure=True, verify=True, connect_timeout=30s, send_receive_timeout=300s)
INFO:mcp-clickhouse:Successfully connected to ClickHouse server version 25.6.2.6151
INFO:mcp-clickhouse:Query returned 43 rows
INFO:mcp.server.lowlevel.server:Processing request of type ListToolsRequest
Question 13 -> MCP-QA-base-set_answers_t0/13.md
Processing question 13: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [04:26<00:00, 266.12s/it]Processing question 13: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [04:26<00:00, 266.12s/it]
âœ… Completed processing 1 questions
ðŸ“ Results saved to: MCP-QA-base-set_answers_t0
Question 13 completed in 268 seconds
