# Question 16

**Type:** Expression comparison

**Question:** In the Breast Invasive Carcinoma TCGA study what are the top 5 down-regulated genes in TP53 mutated samples compared to non-mutated ones?

**Answer:**

Based on my analysis of the Breast Invasive Carcinoma TCGA PanCancer Atlas 2018 dataset, here are the **top 5 most down-regulated genes in TP53 mutated samples compared to non-mutated ones**:

## Top 5 Down-regulated Genes in TP53 Mutated Samples

1. **AGR3** (Anterior Gradient 3)
   - Expression difference: -1.36 (z-score units)
   - TP53 mutated avg: -1.09
   - TP53 wildtype avg: +0.27

2. **SRARP** (Steroid Receptor Associated and Regulated Protein)
   - Expression difference: -1.34
   - TP53 mutated avg: -1.13
   - TP53 wildtype avg: +0.22

3. **TBC1D9** (TBC1 Domain Family Member 9)
   - Expression difference: -1.22
   - TP53 mutated avg: -0.83
   - TP53 wildtype avg: +0.39

4. **ABCC8** (ATP Binding Cassette Subfamily C Member 8)
   - Expression difference: -1.21
   - TP53 mutated avg: -1.02
   - TP53 wildtype avg: +0.19

5. **CT62** (Cancer/Testis Antigen 62)
   - Expression difference: -1.20
   - TP53 mutated avg: -0.97
   - TP53 wildtype avg: +0.23

## Analysis Summary

- **Sample sizes**: 347 TP53 mutated samples vs 735 TP53 wildtype samples
- **Expression data**: mRNA expression z-scores relative to all samples (RNA Seq V2 RSEM)
- **Study**: Breast Invasive Carcinoma (TCGA, PanCancer Atlas 2018)

These genes show the most significant down-regulation in breast cancer samples harboring TP53 mutations compared to those with wildtype TP53. The negative z-scores in the mutated samples indicate expression below the population mean, while the positive z-scores in wildtype samples indicate above-average expression.

---

## SQL Queries Executed

### Query 1
**Timestamp:** 2025-09-30 18:56:06

```sql
SELECT cancer_study_identifier, name, description
FROM cancer_study
WHERE LOWER(name) LIKE '%breast%'
AND LOWER(name) LIKE '%invasive%'
AND LOWER(name) LIKE '%tcga%'
```

### Query 2
**Timestamp:** 2025-09-30 18:56:11

```sql
SELECT COUNT(*) as tp53_mutations
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
```

### Query 3
**Timestamp:** 2025-09-30 18:56:15

```sql
SELECT stable_id, name, genetic_alteration_type, description
FROM genetic_profile
WHERE cancer_study_id = (SELECT internal_id FROM cancer_study WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018')
AND genetic_alteration_type LIKE '%RNA%'
```

### Query 4
**Timestamp:** 2025-09-30 18:56:25

```sql
SELECT stable_id, name, genetic_alteration_type, description
FROM genetic_profile
WHERE cancer_study_id = (SELECT cancer_study_id FROM cancer_study WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018')
AND genetic_alteration_type = 'MRNA_EXPRESSION'
```

### Query 5
**Timestamp:** 2025-09-30 18:56:39

```sql
WITH tp53_mutated_samples AS (
SELECT DISTINCT sample_unique_id
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
),
all_samples AS (
SELECT DISTINCT sample_unique_id
FROM genetic_alteration_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND profile_type = 'MRNA_EXPRESSION'
AND genetic_profile_stable_id = 'brca_tcga_pan_can_atlas_2018_rna_seq_v2_mrna_median_all_sample_Zscores'
),
sample_groups AS (
SELECT
a.sample_unique_id,
CASE WHEN t.sample_unique_id IS NOT NULL THEN 'TP53_mutated' ELSE 'TP53_wildtype' END as tp53_status
FROM all_samples a
LEFT JOIN tp53_mutated_samples t ON a.sample_unique_id = t.sample_unique_id
),
expression_comparison AS (
SELECT
gad.hugo_gene_symbol,
sg.tp53_status,
AVG(CAST(gad.alteration_value AS Float64)) as avg_expression,
COUNT(*) as sample_count
FROM genetic_alteration_derived gad
JOIN sample_groups sg ON gad.sample_unique_id = sg.sample_unique_id
WHERE gad.cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND gad.profile_type = 'MRNA_EXPRESSION'
AND gad.genetic_profile_stable_id = 'brca_tcga_pan_can_atlas_2018_rna_seq_v2_mrna_median_all_sample_Zscores'
AND gad.alteration_value != 'NA'
AND gad.hugo_gene_symbol != 'TP53'  -- exclude TP53 itself from comparison
GROUP BY gad.hugo_gene_symbol, sg.tp53_status
HAVING sample_count >= 10  -- ensure sufficient sample size
)
SELECT
hugo_gene_symbol,
MAX(CASE WHEN tp53_status = 'TP53_mutated' THEN avg_expression END) as mutated_avg,
MAX(CASE WHEN tp53_status = 'TP53_wildtype' THEN avg_expression END) as wildtype_avg,
MAX(CASE WHEN tp53_status = 'TP53_mutated' THEN avg_expression END) -
MAX(CASE WHEN tp53_status = 'TP53_wildtype' THEN avg_expression END) as expression_difference,
MAX(CASE WHEN tp53_status = 'TP53_mutated' THEN sample_count END) as mutated_samples,
MAX(CASE WHEN tp53_status = 'TP53_wildtype' THEN sample_count END) as wildtype_samples
FROM expression_comparison
GROUP BY hugo_gene_symbol
HAVING mutated_avg IS NOT NULL AND wildtype_avg IS NOT NULL
ORDER BY expression_difference ASC
LIMIT 5
```

### Query 6
**Timestamp:** 2025-09-30 18:56:44

```sql
SELECT COUNT(DISTINCT sample_unique_id) as tp53_mutated_sample_count
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
```

### Query 7
**Timestamp:** 2025-09-30 18:56:52

```sql
SELECT
gad.hugo_gene_symbol,
CASE WHEN tp53.sample_unique_id IS NOT NULL THEN 'TP53_mutated' ELSE 'TP53_wildtype' END as tp53_status,
AVG(CAST(gad.alteration_value AS Float64)) as avg_expression,
COUNT(*) as sample_count
FROM genetic_alteration_derived gad
LEFT JOIN (
SELECT DISTINCT sample_unique_id
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
) tp53 ON gad.sample_unique_id = tp53.sample_unique_id
WHERE gad.cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND gad.profile_type = 'MRNA_EXPRESSION'
AND gad.genetic_profile_stable_id = 'brca_tcga_pan_can_atlas_2018_rna_seq_v2_mrna_median_all_sample_Zscores'
AND gad.alteration_value != 'NA'
AND gad.hugo_gene_symbol != 'TP53'
GROUP BY gad.hugo_gene_symbol, tp53_status
HAVING sample_count >= 10
ORDER BY gad.hugo_gene_symbol, tp53_status
LIMIT 20
```

### Query 8
**Timestamp:** 2025-09-30 18:56:59

```sql
SELECT DISTINCT profile_type
FROM genetic_alteration_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND profile_type LIKE '%rna%' OR profile_type LIKE '%expression%'
```

### Query 9
**Timestamp:** 2025-09-30 18:57:23

```sql
SELECT
gad.hugo_gene_symbol,
CASE WHEN tp53.sample_unique_id IS NOT NULL THEN 'TP53_mutated' ELSE 'TP53_wildtype' END as tp53_status,
AVG(CAST(gad.alteration_value AS Float64)) as avg_expression,
COUNT(*) as sample_count
FROM genetic_alteration_derived gad
LEFT JOIN (
SELECT DISTINCT sample_unique_id
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
) tp53 ON gad.sample_unique_id = tp53.sample_unique_id
WHERE gad.cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND gad.profile_type = 'rna_seq_v2_mrna_median_all_sample_Zscores'
AND gad.alteration_value IS NOT NULL
AND gad.hugo_gene_symbol != 'TP53'
GROUP BY gad.hugo_gene_symbol, tp53_status
HAVING sample_count >= 50
ORDER BY gad.hugo_gene_symbol, tp53_status
LIMIT 20
```

### Query 10
**Timestamp:** 2025-09-30 18:57:33

```sql
SELECT
tp53_status,
COUNT(DISTINCT sample_unique_id) as unique_samples,
COUNT(*) as total_records
FROM (
SELECT
gad.sample_unique_id,
CASE WHEN tp53.sample_unique_id IS NOT NULL THEN 'TP53_mutated' ELSE 'TP53_wildtype' END as tp53_status
FROM genetic_alteration_derived gad
LEFT JOIN (
SELECT DISTINCT sample_unique_id
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
) tp53 ON gad.sample_unique_id = tp53.sample_unique_id
WHERE gad.cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND gad.profile_type = 'rna_seq_v2_mrna_median_all_sample_Zscores'
AND gad.alteration_value IS NOT NULL
) grouped
GROUP BY tp53_status
```

### Query 11
**Timestamp:** 2025-09-30 18:57:40

```sql
SELECT DISTINCT sample_unique_id
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
LIMIT 10
```

### Query 12
**Timestamp:** 2025-09-30 18:57:43

```sql
SELECT COUNT(DISTINCT sample_unique_id) as total_samples_with_expression
FROM genetic_alteration_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND profile_type = 'rna_seq_v2_mrna_median_all_sample_Zscores'
```

### Query 13
**Timestamp:** 2025-09-30 18:57:50

```sql
SELECT COUNT(*) as wildtype_samples
FROM (
SELECT DISTINCT sample_unique_id
FROM genetic_alteration_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND profile_type = 'rna_seq_v2_mrna_median_all_sample_Zscores'
) all_samples
WHERE sample_unique_id NOT IN (
SELECT DISTINCT sample_unique_id
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
)
```

### Query 14
**Timestamp:** 2025-09-30 18:57:58

```sql
SELECT
gad.hugo_gene_symbol,
CASE
WHEN gad.sample_unique_id IN (
SELECT DISTINCT sample_unique_id
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
) THEN 'TP53_mutated'
ELSE 'TP53_wildtype'
END as tp53_status,
AVG(CAST(gad.alteration_value AS Float64)) as avg_expression,
COUNT(*) as sample_count
FROM genetic_alteration_derived gad
WHERE gad.cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND gad.profile_type = 'rna_seq_v2_mrna_median_all_sample_Zscores'
AND gad.alteration_value IS NOT NULL
AND gad.hugo_gene_symbol != 'TP53'
GROUP BY gad.hugo_gene_symbol, tp53_status
HAVING sample_count >= 50
ORDER BY gad.hugo_gene_symbol, tp53_status
LIMIT 20
```

### Query 15
**Timestamp:** 2025-09-30 18:58:09

```sql
SELECT
hugo_gene_symbol,
MAX(CASE WHEN tp53_status = 'TP53_mutated' THEN avg_expression END) as mutated_avg,
MAX(CASE WHEN tp53_status = 'TP53_wildtype' THEN avg_expression END) as wildtype_avg,
MAX(CASE WHEN tp53_status = 'TP53_mutated' THEN avg_expression END) -
MAX(CASE WHEN tp53_status = 'TP53_wildtype' THEN avg_expression END) as expression_difference,
MAX(CASE WHEN tp53_status = 'TP53_mutated' THEN sample_count END) as mutated_samples,
MAX(CASE WHEN tp53_status = 'TP53_wildtype' THEN sample_count END) as wildtype_samples
FROM (
SELECT
gad.hugo_gene_symbol,
CASE
WHEN gad.sample_unique_id IN (
SELECT DISTINCT sample_unique_id
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
) THEN 'TP53_mutated'
ELSE 'TP53_wildtype'
END as tp53_status,
AVG(CAST(gad.alteration_value AS Float64)) as avg_expression,
COUNT(*) as sample_count
FROM genetic_alteration_derived gad
WHERE gad.cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND gad.profile_type = 'rna_seq_v2_mrna_median_all_sample_Zscores'
AND gad.alteration_value IS NOT NULL
AND gad.hugo_gene_symbol != 'TP53'
GROUP BY gad.hugo_gene_symbol, tp53_status
HAVING sample_count >= 50
) expression_data
GROUP BY hugo_gene_symbol
HAVING mutated_avg IS NOT NULL AND wildtype_avg IS NOT NULL
ORDER BY expression_difference ASC
LIMIT 5
```

### Query 16
**Timestamp:** 2025-09-30 18:58:17

```sql
SELECT hugo_gene_symbol, entrez_gene_id
FROM gene
WHERE hugo_gene_symbol IN ('AGR3', 'SRARP', 'TBC1D9', 'ABCC8', 'CT62')
```

### Query 17
**Timestamp:** 2025-09-30 18:58:25

```sql
SELECT
hugo_gene_symbol,
MAX(CASE WHEN tp53_status = 'TP53_mutated' THEN avg_expression END) as mutated_avg,
MAX(CASE WHEN tp53_status = 'TP53_wildtype' THEN avg_expression END) as wildtype_avg,
MAX(CASE WHEN tp53_status = 'TP53_mutated' THEN avg_expression END) -
MAX(CASE WHEN tp53_status = 'TP53_wildtype' THEN avg_expression END) as expression_difference,
MAX(CASE WHEN tp53_status = 'TP53_mutated' THEN sample_count END) as mutated_samples,
MAX(CASE WHEN tp53_status = 'TP53_wildtype' THEN sample_count END) as wildtype_samples
FROM (
SELECT
gad.hugo_gene_symbol,
CASE
WHEN gad.sample_unique_id IN (
SELECT DISTINCT sample_unique_id
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
) THEN 'TP53_mutated'
ELSE 'TP53_wildtype'
END as tp53_status,
AVG(CAST(gad.alteration_value AS Float64)) as avg_expression,
COUNT(*) as sample_count
FROM genetic_alteration_derived gad
WHERE gad.cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND gad.profile_type = 'rna_seq_v2_mrna_median_all_sample_Zscores'
AND gad.alteration_value IS NOT NULL
AND gad.hugo_gene_symbol != 'TP53'
GROUP BY gad.hugo_gene_symbol, tp53_status
HAVING sample_count >= 300  -- Require both groups to have sufficient samples
) expression_data
GROUP BY hugo_gene_symbol
HAVING mutated_avg IS NOT NULL AND wildtype_avg IS NOT NULL
AND mutated_samples >= 300 AND wildtype_samples >= 300
ORDER BY expression_difference ASC
LIMIT 10
```


---

## Model Information
**Model:** anthropic:claude-sonnet-4-20250514
**Provider:** Anthropic
**Max Tokens:** 4096

---

*Generated on 2025-09-30 18:58:39*