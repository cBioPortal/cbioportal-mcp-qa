# Question 16

**Type:** Expression comparison

**Question:** In the Breast Invasive Carcinoma TCGA study what are the top 5 down-regulated genes in TP53 mutated samples compared to non-mutated ones?

**Answer:**

Based on my analysis of the Breast Invasive Carcinoma TCGA PanCancer Atlas study, here are the **top 5 down-regulated genes in TP53 mutated samples compared to TP53 wild-type samples**:

## Results

1. **FGF4** (Fibroblast Growth Factor 4)
   - Expression difference: **-64.26** (Z-score units)
   - Mean expression in TP53 mutated: 5.63
   - Mean expression in TP53 wild-type: 69.89
   - Entrez Gene ID: 2249

2. **CCDC172** (Coiled-Coil Domain Containing 172)
   - Expression difference: **-14.40** 
   - Mean expression in TP53 mutated: 0.10
   - Mean expression in TP53 wild-type: 14.50
   - Entrez Gene ID: 374355

3. **PRM1** (Protamine 1)
   - Expression difference: **-12.97**
   - Mean expression in TP53 mutated: -0.05
   - Mean expression in TP53 wild-type: 12.92
   - Entrez Gene ID: 5619

4. **PSG11** (Pregnancy Specific Beta-1-Glycoprotein 11)
   - Expression difference: **-8.23**
   - Mean expression in TP53 mutated: 0.06
   - Mean expression in TP53 wild-type: 8.29
   - Entrez Gene ID: 5680

5. **ADAM5** (ADAM Metallopeptidase Domain 5)
   - Expression difference: **-6.82**
   - Mean expression in TP53 mutated: 0.21
   - Mean expression in TP53 wild-type: 7.03
   - Entrez Gene ID: 255926

## Study Details
- **Dataset**: Breast Invasive Carcinoma TCGA PanCancer Atlas 2018
- **TP53 mutated samples**: 347
- **TP53 wild-type samples**: 735
- **Expression data**: RNA-seq v2 mRNA median Z-scores

The most dramatically down-regulated gene is **FGF4**, which shows a substantial decrease in expression in TP53 mutated breast cancer samples. FGF4 is involved in cell growth, proliferation, and angiogenesis, and its downregulation in TP53-mutated samples suggests potential disruption of growth factor signaling pathways.

---

## SQL Queries Executed

### Query 1
**Timestamp:** 2025-09-30 18:52:18

```sql
SELECT cancer_study_identifier, name, description
FROM cancer_study
WHERE LOWER(name) LIKE '%breast%' AND LOWER(name) LIKE '%tcga%'
```

### Query 2
**Timestamp:** 2025-09-30 18:52:21

```sql
SELECT DISTINCT profile_type
FROM genetic_alteration_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
```

### Query 3
**Timestamp:** 2025-09-30 18:52:27

```sql
SELECT COUNT(*) as mutation_count
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
```

### Query 4
**Timestamp:** 2025-09-30 18:52:34

```sql
WITH tp53_mutated_samples AS (
SELECT DISTINCT sample_unique_id
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
),
all_samples_with_expression AS (
SELECT DISTINCT sample_unique_id
FROM genetic_alteration_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND profile_type = 'rna_seq_v2_mrna'
AND alteration_value != 'NA'
)
SELECT
COUNT(CASE WHEN tp53.sample_unique_id IS NOT NULL THEN 1 END) as tp53_mutated_samples,
COUNT(CASE WHEN tp53.sample_unique_id IS NULL THEN 1 END) as tp53_wildtype_samples,
COUNT(*) as total_samples
FROM all_samples_with_expression exp
LEFT JOIN tp53_mutated_samples tp53 ON exp.sample_unique_id = tp53.sample_unique_id
```

### Query 5
**Timestamp:** 2025-09-30 18:52:39

```sql
SELECT
COUNT(DISTINCT CASE WHEN tp53.sample_unique_id IS NOT NULL THEN exp.sample_unique_id END) as tp53_mutated_samples,
COUNT(DISTINCT CASE WHEN tp53.sample_unique_id IS NULL THEN exp.sample_unique_id END) as tp53_wildtype_samples,
COUNT(DISTINCT exp.sample_unique_id) as total_samples
FROM (
SELECT DISTINCT sample_unique_id
FROM genetic_alteration_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND profile_type = 'rna_seq_v2_mrna'
AND alteration_value != 'NA'
) exp
LEFT JOIN (
SELECT DISTINCT sample_unique_id
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
) tp53 ON exp.sample_unique_id = tp53.sample_unique_id
```

### Query 6
**Timestamp:** 2025-09-30 18:52:45

```sql
SELECT COUNT(DISTINCT sample_unique_id) as total_samples_with_expression
FROM genetic_alteration_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND profile_type = 'rna_seq_v2_mrna'
```

### Query 7
**Timestamp:** 2025-09-30 18:52:51

```sql
SELECT COUNT(DISTINCT sample_unique_id) as tp53_mutated_samples
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
```

### Query 8
**Timestamp:** 2025-09-30 18:53:00

```sql
SELECT
hugo_gene_symbol,
AVG(CASE WHEN tp53_status = 'mutated' THEN alteration_value END) as mean_mutated,
AVG(CASE WHEN tp53_status = 'wildtype' THEN alteration_value END) as mean_wildtype,
AVG(CASE WHEN tp53_status = 'mutated' THEN alteration_value END) -
AVG(CASE WHEN tp53_status = 'wildtype' THEN alteration_value END) as fold_change,
COUNT(CASE WHEN tp53_status = 'mutated' THEN 1 END) as mutated_count,
COUNT(CASE WHEN tp53_status = 'wildtype' THEN 1 END) as wildtype_count
FROM (
SELECT
exp.hugo_gene_symbol,
exp.sample_unique_id,
toFloat64(exp.alteration_value) as alteration_value,
CASE WHEN tp53.sample_unique_id IS NOT NULL THEN 'mutated' ELSE 'wildtype' END as tp53_status
FROM genetic_alteration_derived exp
LEFT JOIN (
SELECT DISTINCT sample_unique_id
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
) tp53 ON exp.sample_unique_id = tp53.sample_unique_id
WHERE exp.cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND exp.profile_type = 'rna_seq_v2_mrna'
AND exp.alteration_value != 'NA'
AND isFinite(toFloat64(exp.alteration_value))
) subq
GROUP BY hugo_gene_symbol
HAVING mutated_count >= 10 AND wildtype_count >= 10
ORDER BY fold_change ASC
LIMIT 5
```

### Query 9
**Timestamp:** 2025-09-30 18:53:08

```sql
SELECT
hugo_gene_symbol,
alteration_value,
profile_type
FROM genetic_alteration_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND profile_type = 'rna_seq_v2_mrna'
AND hugo_gene_symbol = 'ACTB'
LIMIT 5
```

### Query 10
**Timestamp:** 2025-09-30 18:53:17

```sql
SELECT
hugo_gene_symbol,
AVG(CASE WHEN tp53_status = 'mutated' THEN alteration_value END) as mean_mutated,
AVG(CASE WHEN tp53_status = 'wildtype' THEN alteration_value END) as mean_wildtype,
AVG(CASE WHEN tp53_status = 'mutated' THEN alteration_value END) -
AVG(CASE WHEN tp53_status = 'wildtype' THEN alteration_value END) as fold_change,
COUNT(CASE WHEN tp53_status = 'mutated' THEN 1 END) as mutated_count,
COUNT(CASE WHEN tp53_status = 'wildtype' THEN 1 END) as wildtype_count
FROM (
SELECT
exp.hugo_gene_symbol,
exp.sample_unique_id,
toFloat64(exp.alteration_value) as alteration_value,
CASE WHEN tp53.sample_unique_id IS NOT NULL THEN 'mutated' ELSE 'wildtype' END as tp53_status
FROM genetic_alteration_derived exp
LEFT JOIN (
SELECT DISTINCT sample_unique_id
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
) tp53 ON exp.sample_unique_id = tp53.sample_unique_id
WHERE exp.cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND exp.profile_type = 'rna_seq_v2_mrna_median_Zscores'
AND exp.alteration_value != 'NA'
AND isFinite(toFloat64(exp.alteration_value))
) subq
GROUP BY hugo_gene_symbol
HAVING mutated_count >= 10 AND wildtype_count >= 10
ORDER BY fold_change ASC
LIMIT 5
```

### Query 11
**Timestamp:** 2025-09-30 18:53:25

```sql
SELECT COUNT(*) as total_records
FROM genetic_alteration_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND profile_type = 'rna_seq_v2_mrna_median_Zscores'
```

### Query 12
**Timestamp:** 2025-09-30 18:53:31

```sql
SELECT
COUNT(*) as total,
COUNT(CASE WHEN tp53_status = 'mutated' THEN 1 END) as mutated,
COUNT(CASE WHEN tp53_status = 'wildtype' THEN 1 END) as wildtype
FROM (
SELECT
exp.sample_unique_id,
CASE WHEN tp53.sample_unique_id IS NOT NULL THEN 'mutated' ELSE 'wildtype' END as tp53_status
FROM (
SELECT DISTINCT sample_unique_id
FROM genetic_alteration_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND profile_type = 'rna_seq_v2_mrna_median_Zscores'
) exp
LEFT JOIN (
SELECT DISTINCT sample_unique_id
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
) tp53 ON exp.sample_unique_id = tp53.sample_unique_id
)
```

### Query 13
**Timestamp:** 2025-09-30 18:53:35

```sql
SELECT sample_unique_id
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
LIMIT 5
```

### Query 14
**Timestamp:** 2025-09-30 18:53:39

```sql
SELECT DISTINCT sample_unique_id
FROM genetic_alteration_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND profile_type = 'rna_seq_v2_mrna_median_Zscores'
AND sample_unique_id NOT IN (
SELECT DISTINCT sample_unique_id
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
)
LIMIT 10
```

### Query 15
**Timestamp:** 2025-09-30 18:53:46

```sql
SELECT
hugo_gene_symbol,
ROUND(AVG(CASE WHEN tp53_status = 'mutated' THEN alteration_value END), 4) as mean_mutated,
ROUND(AVG(CASE WHEN tp53_status = 'wildtype' THEN alteration_value END), 4) as mean_wildtype,
ROUND(AVG(CASE WHEN tp53_status = 'mutated' THEN alteration_value END) -
AVG(CASE WHEN tp53_status = 'wildtype' THEN alteration_value END), 4) as expression_diff,
COUNT(CASE WHEN tp53_status = 'mutated' THEN 1 END) as mutated_count,
COUNT(CASE WHEN tp53_status = 'wildtype' THEN 1 END) as wildtype_count
FROM (
SELECT
exp.hugo_gene_symbol,
exp.sample_unique_id,
toFloat64(exp.alteration_value) as alteration_value,
CASE WHEN tp53.sample_unique_id IS NOT NULL THEN 'mutated' ELSE 'wildtype' END as tp53_status
FROM genetic_alteration_derived exp
LEFT JOIN (
SELECT DISTINCT sample_unique_id
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
) tp53 ON exp.sample_unique_id = tp53.sample_unique_id
WHERE exp.cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND exp.profile_type = 'rna_seq_v2_mrna_median_Zscores'
AND exp.alteration_value != 'NA'
AND isFinite(toFloat64(exp.alteration_value))
) subq
GROUP BY hugo_gene_symbol
HAVING mutated_count >= 50 AND wildtype_count >= 50
ORDER BY expression_diff ASC
LIMIT 5
```

### Query 16
**Timestamp:** 2025-09-30 18:53:57

```sql
SELECT
hugo_gene_symbol,
COUNT(CASE WHEN tp53_status = 'mutated' THEN 1 END) as mutated_count,
COUNT(CASE WHEN tp53_status = 'wildtype' THEN 1 END) as wildtype_count
FROM (
SELECT
exp.hugo_gene_symbol,
exp.sample_unique_id,
CASE WHEN tp53.sample_unique_id IS NOT NULL THEN 'mutated' ELSE 'wildtype' END as tp53_status
FROM genetic_alteration_derived exp
LEFT JOIN (
SELECT DISTINCT sample_unique_id
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
) tp53 ON exp.sample_unique_id = tp53.sample_unique_id
WHERE exp.cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND exp.profile_type = 'rna_seq_v2_mrna_median_Zscores'
AND exp.hugo_gene_symbol = 'ACTB'
) subq
GROUP BY hugo_gene_symbol
```

### Query 17
**Timestamp:** 2025-09-30 18:54:01

```sql
SELECT
COUNT(DISTINCT sample_unique_id) as tp53_mutated_samples
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
```

### Query 18
**Timestamp:** 2025-09-30 18:54:04

```sql
SELECT
COUNT(DISTINCT sample_unique_id) as expression_samples
FROM genetic_alteration_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND profile_type = 'rna_seq_v2_mrna_median_Zscores'
```

### Query 19
**Timestamp:** 2025-09-30 18:54:12

```sql
SELECT
exp_samples.total_exp_samples,
mut_samples.total_mut_samples,
COUNT(CASE WHEN tp53.sample_unique_id IS NOT NULL THEN 1 END) as overlap_mutated,
COUNT(CASE WHEN tp53.sample_unique_id IS NULL THEN 1 END) as overlap_wildtype
FROM (
SELECT DISTINCT sample_unique_id, COUNT(*) OVER() as total_exp_samples
FROM genetic_alteration_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND profile_type = 'rna_seq_v2_mrna_median_Zscores'
) exp_samples
LEFT JOIN (
SELECT DISTINCT sample_unique_id, COUNT(*) OVER() as total_mut_samples
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
) tp53 ON exp_samples.sample_unique_id = tp53.sample_unique_id
CROSS JOIN (
SELECT COUNT(DISTINCT sample_unique_id) as total_mut_samples
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
) mut_samples
GROUP BY exp_samples.total_exp_samples, mut_samples.total_mut_samples
```

### Query 20
**Timestamp:** 2025-09-30 18:54:20

```sql
SELECT
SUM(CASE WHEN is_tp53_mutated = 1 THEN 1 ELSE 0 END) as mutated_samples,
SUM(CASE WHEN is_tp53_mutated = 0 THEN 1 ELSE 0 END) as wildtype_samples
FROM (
SELECT DISTINCT
exp.sample_unique_id,
CASE WHEN tp53.sample_unique_id IS NOT NULL THEN 1 ELSE 0 END as is_tp53_mutated
FROM (
SELECT DISTINCT sample_unique_id
FROM genetic_alteration_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND profile_type = 'rna_seq_v2_mrna_median_Zscores'
) exp
LEFT JOIN (
SELECT DISTINCT sample_unique_id
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
) tp53 ON exp.sample_unique_id = tp53.sample_unique_id
)
```

### Query 21
**Timestamp:** 2025-09-30 18:54:28

```sql
SELECT
COUNT(DISTINCT sample_unique_id) as wildtype_samples
FROM genetic_alteration_derived exp
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND profile_type = 'rna_seq_v2_mrna_median_Zscores'
AND NOT EXISTS (
SELECT 1
FROM genomic_event_derived tp53
WHERE tp53.cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND tp53.hugo_gene_symbol = 'TP53'
AND tp53.variant_type = 'mutation'
AND tp53.sample_unique_id = exp.sample_unique_id
)
```

### Query 22
**Timestamp:** 2025-09-30 18:54:32

```sql
SELECT
COUNT(DISTINCT sample_unique_id) as wildtype_samples
FROM genetic_alteration_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND profile_type = 'rna_seq_v2_mrna_median_Zscores'
AND sample_unique_id NOT IN (
SELECT DISTINCT sample_unique_id
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
)
```

### Query 23
**Timestamp:** 2025-09-30 18:54:42

```sql
SELECT
hugo_gene_symbol,
ROUND(avg_mutated, 4) as mean_expression_tp53_mutated,
ROUND(avg_wildtype, 4) as mean_expression_tp53_wildtype,
ROUND(avg_mutated - avg_wildtype, 4) as expression_difference,
mutated_count,
wildtype_count
FROM (
SELECT
hugo_gene_symbol,
AVG(CASE WHEN is_tp53_mutated = 1 THEN alteration_value END) as avg_mutated,
AVG(CASE WHEN is_tp53_mutated = 0 THEN alteration_value END) as avg_wildtype,
COUNT(CASE WHEN is_tp53_mutated = 1 THEN 1 END) as mutated_count,
COUNT(CASE WHEN is_tp53_mutated = 0 THEN 1 END) as wildtype_count
FROM (
SELECT
exp.hugo_gene_symbol,
toFloat64(exp.alteration_value) as alteration_value,
CASE WHEN exp.sample_unique_id IN (
SELECT DISTINCT sample_unique_id
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
) THEN 1 ELSE 0 END as is_tp53_mutated
FROM genetic_alteration_derived exp
WHERE exp.cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND exp.profile_type = 'rna_seq_v2_mrna_median_Zscores'
AND exp.alteration_value != 'NA'
AND isFinite(toFloat64(exp.alteration_value))
) subq
GROUP BY hugo_gene_symbol
HAVING mutated_count >= 300 AND wildtype_count >= 500
) final
WHERE avg_mutated IS NOT NULL AND avg_wildtype IS NOT NULL
ORDER BY expression_difference ASC
LIMIT 5
```

### Query 24
**Timestamp:** 2025-09-30 18:54:49

```sql
SELECT
hugo_gene_symbol,
ROUND(avg_mutated, 4) as mean_expression_tp53_mutated,
ROUND(avg_wildtype, 4) as mean_expression_tp53_wildtype,
ROUND(avg_mutated - avg_wildtype, 4) as expression_difference,
mutated_count,
wildtype_count
FROM (
SELECT
hugo_gene_symbol,
AVG(CASE WHEN is_tp53_mutated = 1 THEN alteration_value END) as avg_mutated,
AVG(CASE WHEN is_tp53_mutated = 0 THEN alteration_value END) as avg_wildtype,
COUNT(CASE WHEN is_tp53_mutated = 1 THEN 1 END) as mutated_count,
COUNT(CASE WHEN is_tp53_mutated = 0 THEN 1 END) as wildtype_count
FROM (
SELECT
exp.hugo_gene_symbol,
toFloat64(exp.alteration_value) as alteration_value,
CASE WHEN exp.sample_unique_id IN (
SELECT DISTINCT sample_unique_id
FROM genomic_event_derived
WHERE cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND hugo_gene_symbol = 'TP53'
AND variant_type = 'mutation'
) THEN 1 ELSE 0 END as is_tp53_mutated
FROM genetic_alteration_derived exp
WHERE exp.cancer_study_identifier = 'brca_tcga_pan_can_atlas_2018'
AND exp.profile_type = 'rna_seq_v2_mrna_median_Zscores'
AND exp.alteration_value != 'NA'
AND isFinite(toFloat64(exp.alteration_value))
) subq
GROUP BY hugo_gene_symbol
HAVING mutated_count >= 300 AND wildtype_count >= 500
) results
WHERE avg_mutated IS NOT NULL AND avg_wildtype IS NOT NULL
ORDER BY expression_difference ASC
LIMIT 5
```

### Query 25
**Timestamp:** 2025-09-30 18:54:57

```sql
SELECT hugo_gene_symbol, entrez_gene_id
FROM gene
WHERE hugo_gene_symbol IN ('FGF4', 'CCDC172', 'PRM1', 'PSG11', 'ADAM5')
ORDER BY FIELD(hugo_gene_symbol, 'FGF4', 'CCDC172', 'PRM1', 'PSG11', 'ADAM5')
```

### Query 26
**Timestamp:** 2025-09-30 18:55:00

```sql
SELECT hugo_gene_symbol, entrez_gene_id
FROM gene
WHERE hugo_gene_symbol IN ('FGF4', 'CCDC172', 'PRM1', 'PSG11', 'ADAM5')
ORDER BY hugo_gene_symbol
```


---

## Model Information
**Model:** anthropic:claude-sonnet-4-20250514
**Provider:** Anthropic
**Max Tokens:** 4096

---

*Generated on 2025-09-30 18:55:10*