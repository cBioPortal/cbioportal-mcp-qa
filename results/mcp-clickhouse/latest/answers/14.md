# Question 14

**Type:** Clinical Data

**Question:** Which cancer type has the highest average tumor mutational burden across all studies?

**Answer:**

I'll help you find which cancer type has the highest average tumor mutational burden (TMB) across all studies in the database.

Let me query the clinical data to find TMB values by cancer type:



Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\nSELECT \n    cancer_type.attribute_value AS cancer_type,\n    AVG(CAST(tmb.attribute_value AS Float64)) AS avg_tmb,\n    COUNT(DISTINCT tmb.sample_unique_id) AS sample_count,\n    COUNT(DISTINCT tmb.study_id) AS study_count\nFROM clinical_data_derived AS tmb\nINNER JOIN clinical_data_derived AS cancer_type \n    ON tmb.sample_unique_id = cancer_type.sample_unique_id\nWHERE tmb.attribute_name = 'TMB_NONSYNONYMOUS'\n    AND cancer_type.attribute_name = 'CANCER_TYPE'\n    AND tmb.attribute_value != ''\n    AND cancer_type.attribute_value != ''\nGROUP BY cancer_type.attribute_value\nHAVING sample_count >= 10\nORDER BY avg_tmb DESC\nLIMIT 20\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"error_message":"Query execution failed: Received ClickHouse exception, code: 47, server response: Code: 47. DB::Exception: Identifier 'tmb.study_id' cannot be resolved from table with name tmb. In scope SELECT cancer_type.attribute_value AS cancer_type, AVG(CAST(tmb.attribute_value, 'Float64')) AS avg_tmb, COUNTDistinct(tmb.sample_unique_id) AS sample_count, COUNTDistinct(tmb.study_id) AS study_count FROM clinical_data_derived AS tmb INNER JOIN clinical_data_derived AS cancer_type ON tmb.sample_unique_id = cancer_type.sample_unique_id WHERE (tmb.attribute_name = 'TMB_NONSYNONYMOUS') AND (cancer_type.attribute_name = 'CANCER_TYPE') AND (tmb.attribute_value != '') AND (cancer_type.attribute_value != '') GROUP BY cancer_type.attribute_value HAVING sample_count >= 10 ORDER BY avg_tmb DESC LIMIT 20. (UNKNOWN_IDENTIFIER) (version 25.8.1.36912 (official build)) (for url https://dl96orhu96.us-east-1.aws.clickhouse.cloud:8443)"}
```


Let me check the structure of the clinical_data_derived table first:



Calling `clickhouse_list_table_columns` with args:
```json
{
  "table": "clinical_data_derived"
}
```



Result from `clickhouse_list_table_columns`:
```json
{"columns":[{"name":"internal_id","type":"Int32","comment":"Internal database identifier. For sample-level data, references sample.internal_id; for patient-level data, references patient.internal_id."},{"name":"sample_unique_id","type":"String","comment":"Globally unique sample identifier constructed as cancer_study_identifier + \"_\" + sample.stable_id. Populated only for sample-level clinical data; empty string for patient-level data."},{"name":"patient_unique_id","type":"String","comment":"Globally unique patient identifier constructed as cancer_study_identifier + \"_\" + patient.stable_id. Populated for both sample-level and patient-level clinical data."},{"name":"attribute_name","type":"LowCardinality(String)","comment":"Name/identifier of the clinical attribute. References clinical_attribute_meta.attr_id."},{"name":"attribute_value","type":"String","comment":"Value of the clinical attribute for this patient/sample. Empty string when no value is recorded but attribute is defined for the study."},{"name":"cancer_study_identifier","type":"LowCardinality(String)","comment":"Stable string identifier for the cancer study. References cancer_study.cancer_study_identifier."},{"name":"type","type":"LowCardinality(String)","comment":"Level of the clinical data: \"sample\" for sample-level attributes, \"patient\" for patient-level attributes. Determined by clinical_attribute_meta.patient_attribute flag."}]}
```


Now let me fix the query using the correct column name:



Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\nSELECT \n    cancer_type.attribute_value AS cancer_type,\n    AVG(CAST(tmb.attribute_value AS Float64)) AS avg_tmb,\n    COUNT(DISTINCT tmb.sample_unique_id) AS sample_count,\n    COUNT(DISTINCT tmb.cancer_study_identifier) AS study_count\nFROM clinical_data_derived AS tmb\nINNER JOIN clinical_data_derived AS cancer_type \n    ON tmb.sample_unique_id = cancer_type.sample_unique_id\nWHERE tmb.attribute_name = 'TMB_NONSYNONYMOUS'\n    AND cancer_type.attribute_name = 'CANCER_TYPE'\n    AND tmb.attribute_value != ''\n    AND cancer_type.attribute_value != ''\nGROUP BY cancer_type.attribute_value\nHAVING sample_count >= 10\nORDER BY avg_tmb DESC\nLIMIT 20\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"cancer_type":"Skin Cancer, Non-Melanoma","avg_tmb":41.731649849710394,"sample_count":809,"study_count":16},{"cancer_type":"Penile Cancer","avg_tmb":38.39495660312308,"sample_count":13,"study_count":3},{"cancer_type":"Diffuse Large B-Cell Lymphoma, NOS","avg_tmb":23.20711280789,"sample_count":10,"study_count":1},{"cancer_type":"Uterine Endometrioid Carcinoma","avg_tmb":19.12214022138129,"sample_count":271,"study_count":2},{"cancer_type":"Endometrial Carcinoma","avg_tmb":18.26771929890526,"sample_count":95,"study_count":1},{"cancer_type":"Breast Cancer, NOS","avg_tmb":15.758718942732314,"sample_count":95,"study_count":4},{"cancer_type":"Melanoma","avg_tmb":15.280194898901877,"sample_count":4984,"study_count":39},{"cancer_type":"Endometrial Cancer","avg_tmb":15.246726552063192,"sample_count":5342,"study_count":26},{"cancer_type":"Rectal Adenocarcinoma","avg_tmb":14.816138681607145,"sample_count":28,"study_count":1},{"cancer_type":"T-Lymphoblastic Leukemia/Lymphoma","avg_tmb":14.741672131169727,"sample_count":109,"study_count":6},{"cancer_type":"Bladder/Urinary Tract Cancer","avg_tmb":14.699867614499999,"sample_count":10,"study_count":1},{"cancer_type":"Colon Adenocarcinoma","avg_tmb":14.007766767279414,"sample_count":136,"study_count":2},{"cancer_type":"Colorectal Cancer","avg_tmb":12.764382728302769,"sample_count":17858,"study_count":41},{"cancer_type":"Bladder Cancer","avg_tmb":11.946462864089803,"sample_count":7662,"study_count":40},{"cancer_type":"Blood Cancer","avg_tmb":11.23821398125,"sample_count":20,"study_count":2},{"cancer_type":"Lung cancer","avg_tmb":9.409890110006593,"sample_count":91,"study_count":2},{"cancer_type":"Small Bowel Cancer","avg_tmb":8.891960703000159,"sample_count":201,"study_count":10},{"cancer_type":"Lung Squamous Cell Carcinoma","avg_tmb":8.26438209331496,"sample_count":127,"study_count":3},{"cancer_type":"Lung Adenocarcinoma","avg_tmb":8.250910146960166,"sample_count":463,"study_count":6},{"cancer_type":"Myelodysplastic/Myeloproliferative Neoplasms","avg_tmb":8.223602181816418,"sample_count":237,"study_count":7}]}
```


Based on the analysis across all studies in the database, **Skin Cancer, Non-Melanoma** has the highest average tumor mutational burden (TMB) with:

- **Average TMB: 41.73 mutations/Mb**
- **Sample count: 809 samples**
- **Study count: 16 studies**

This is followed by:
2. **Penile Cancer** - 38.39 mutations/Mb (13 samples, 3 studies)
3. **Diffuse Large B-Cell Lymphoma, NOS** - 23.21 mutations/Mb (10 samples, 1 study)
4. **Uterine Endometrioid Carcinoma** - 19.12 mutations/Mb (271 samples, 2 studies)
5. **Melanoma** - 15.28 mutations/Mb (4,984 samples, 39 studies)

The high TMB in non-melanoma skin cancers makes biological sense, as these cancers are typically caused by UV radiation exposure, which induces a high number of DNA mutations. Similarly, melanoma (ranked 7th) also shows elevated TMB due to UV-induced mutagenesis. Endometrial cancers (ranks 4, 5, and 8) also show high TMB, often due to microsatellite instability and mismatch repair deficiency.

---

## Model Information
- **model**: us.anthropic.claude-sonnet-4-5-20250929-v1:0
- **temperature**: 0.0
- **max_output_tokens**: 1024
- **thinking_enabled**: False
- **thinking_budget_tokens**: 1024
- **response_time_seconds**: 16.75235916499514
- **agent_type**: mcp-clickhouse

### Usage
- **input_tokens**: 17067
- **output_tokens**: 1009
- **total_tokens**: 18076
- **cache_creation_input_tokens**: 0
- **cache_read_input_tokens**: 0

---

*Generated on 2026-02-05 12:44:12*