# Question 68

**Type:** Cross-Cohort Comparison

**Question:** What are the key genomic differences between lung adenocarcinomas and squamous cell carcinomas identified in the Pan-Lung Cancer TCGA study?

**Answer:**

I'll help you explore the genomic differences between lung adenocarcinomas and squamous cell carcinomas in the Pan-Lung Cancer TCGA study. Let me start by finding the relevant study and understanding its structure.



Calling `list_studies` with args:
```json
{
  "search": "pan lung tcga"
}
```



Result from `list_studies`:
```json

```




Calling `list_studies` with args:
```json
{
  "search": "lung tcga"
}
```



Result from `list_studies`:
```json

```


Let me search more broadly:



Calling `list_studies` with args:
```json
{
  "search": "lung",
  "limit": 50
}
```



Result from `list_studies`:
```json
[{"cancer_study_identifier":"lung_msk_2017","name":"Non-Small Cell Cancer (MSK, Cancer Discov 2017)","type_of_cancer_id":"luad","sample_count":916,"has_guide":false},{"cancer_study_identifier":"lung_msk_pdx","name":"Thoracic PDX (MSK, Provisional)","type_of_cancer_id":"lung","sample_count":319,"has_guide":false},{"cancer_study_identifier":"lung_msk_mind_2020","name":"Lung Adenocarcinoma (MSK Mind,Nature Cancer 2022)","type_of_cancer_id":"lung","sample_count":248,"has_guide":false},{"cancer_study_identifier":"lung_nci_2022","name":"Lung Cancer in Never Smokers (NCI, Nature Genetics 2021)","type_of_cancer_id":"luad","sample_count":233,"has_guide":false},{"cancer_study_identifier":"lung_pdx_msk_2021","name":"Thoracic Cancer (MSK, Nat Commun 2021)","type_of_cancer_id":"lung","sample_count":70,"has_guide":false},{"cancer_study_identifier":"asclc_msk_2024","name":"Atypical Small Cell Lung Cancer (MSK, Cancer Discov 2024)","type_of_cancer_id":"lung","sample_count":32,"has_guide":false},{"cancer_study_identifier":"lung_smc_2016","name":"Lung Cancer (SMC, Cancer Research 2016)","type_of_cancer_id":"lung","sample_count":23,"has_guide":false}]
```




Calling `list_studies` with args:
```json
{
  "search": "tcga",
  "limit": 50
}
```



Result from `list_studies`:
```json
[{"cancer_study_identifier":"nsclc_tcga_broad_2016","name":"Pan-Lung Cancer (TCGA, Nat Genet 2016)","type_of_cancer_id":"nsclc","sample_count":1145,"has_guide":false},{"cancer_study_identifier":"lgggbm_tcga_pub","name":"Merged Cohort of LGG and GBM (TCGA, Cell 2016)","type_of_cancer_id":"difg","sample_count":1123,"has_guide":false},{"cancer_study_identifier":"brca_tcga","name":"Breast Invasive Carcinoma (TCGA, Firehose Legacy)","type_of_cancer_id":"brca","sample_count":1109,"has_guide":false},{"cancer_study_identifier":"brca_tcga_gdc","name":"Invasive Breast Carcinoma (TCGA, GDC)","type_of_cancer_id":"brca","sample_count":1106,"has_guide":false},{"cancer_study_identifier":"brca_tcga_pan_can_atlas_2018","name":"Breast Invasive Carcinoma (TCGA, PanCancer Atlas)","type_of_cancer_id":"brca","sample_count":1085,"has_guide":true},{"cancer_study_identifier":"brca_tcga_pub","name":"Breast Invasive Carcinoma (TCGA, Nature 2012)","type_of_cancer_id":"brca","sample_count":826,"has_guide":false},{"cancer_study_identifier":"brca_tcga_pub2015","name":"Breast Invasive Carcinoma (TCGA, Cell 2015)","type_of_cancer_id":"brca","sample_count":819,"has_guide":false},{"cancer_study_identifier":"coadread_tcga","name":"Colorectal Adenocarcinoma (TCGA, Firehose Legacy)","type_of_cancer_id":"coadread","sample_count":641,"has_guide":false},{"cancer_study_identifier":"gbm_tcga","name":"Glioblastoma Multiforme (TCGA, Firehose Legacy)","type_of_cancer_id":"difg","sample_count":620,"has_guide":false},{"cancer_study_identifier":"ov_tcga","name":"Ovarian Serous Cystadenocarcinoma (TCGA, Firehose Legacy)","type_of_cancer_id":"hgsoc","sample_count":618,"has_guide":false},{"cancer_study_identifier":"hgsoc_tcga_gdc","name":"High-Grade Serous Ovarian Cancer (TCGA, GDC)","type_of_cancer_id":"hgsoc","sample_count":618,"has_guide":false},{"cancer_study_identifier":"gbm_tcga_gdc","name":"Glioblastoma Multiforme (TCGA GDC, 2025)","type_of_cancer_id":"difg","sample_count":612,"has_guide":false},{"cancer_study_identifier":"coadread_tcga_pan_can_atlas_2018","name":"Colorectal Adenocarcinoma (TCGA, PanCancer Atlas)","type_of_cancer_id":"coadread","sample_count":595,"has_guide":true},{"cancer_study_identifier":"gbm_tcga_pan_can_atlas_2018","name":"Glioblastoma Multiforme (TCGA, PanCancer Atlas)","type_of_cancer_id":"difg","sample_count":593,"has_guide":true},{"cancer_study_identifier":"luad_tcga_gdc","name":"Lung Adenocarcinoma (TCGA, GDC)","type_of_cancer_id":"luad","sample_count":588,"has_guide":false},{"cancer_study_identifier":"luad_tcga","name":"Lung Adenocarcinoma (TCGA, Firehose Legacy)","type_of_cancer_id":"luad","sample_count":587,"has_guide":false},{"cancer_study_identifier":"ov_tcga_pan_can_atlas_2018","name":"Ovarian Serous Cystadenocarcinoma (TCGA, PanCancer Atlas)","type_of_cancer_id":"hgsoc","sample_count":586,"has_guide":true},{"cancer_study_identifier":"gbm_tcga_pub2013","name":"Glioblastoma (TCGA, Cell 2013)","type_of_cancer_id":"difg","sample_count":578,"has_guide":false},{"cancer_study_identifier":"luad_tcga_pan_can_atlas_2018","name":"Lung Adenocarcinoma (TCGA, PanCancer Atlas)","type_of_cancer_id":"luad","sample_count":567,"has_guide":true},{"cancer_study_identifier":"stes_tcga_pub","name":"Esophageal Carcinoma (TCGA, Nature 2017)","type_of_cancer_id":"egc","sample_count":560,"has_guide":false},{"cancer_study_identifier":"ucec_tcga","name":"Uterine Corpus Endometrial Carcinoma (TCGA, Firehose Legacy)","type_of_cancer_id":"ucec","sample_count":550,"has_guide":false},{"cancer_study_identifier":"ucec_tcga_gdc","name":"Endometrial Carcinoma (TCGA, GDC)","type_of_cancer_id":"ucec","sample_count":550,"has_guide":false},{"cancer_study_identifier":"kirc_tcga","name":"Kidney Renal Clear Cell Carcinoma (TCGA, Firehose Legacy)","type_of_cancer_id":"ccrcc","sample_count":539,"has_guide":false},{"cancer_study_identifier":"ccrcc_tcga_gdc","name":"Renal Clear Cell Carcinoma (TCGA, GDC)","type_of_cancer_id":"ccrcc","sample_count":539,"has_guide":false},{"cancer_study_identifier":"difg_tcga_gdc","name":"Diffuse Glioma (TCGA, GDC)","type_of_cancer_id":"difg","sample_count":533,"has_guide":false},{"cancer_study_identifier":"hnsc_tcga","name":"Head and Neck Squamous Cell Carcinoma (TCGA, Firehose Legacy)","type_of_cancer_id":"hnsc","sample_count":531,"has_guide":false},{"cancer_study_identifier":"lgg_tcga","name":"Brain Lower Grade Glioma (TCGA, Firehose Legacy)","type_of_cancer_id":"difg","sample_count":531,"has_guide":false},{"cancer_study_identifier":"hnsc_tcga_gdc","name":"Head and Neck Squamous Cell Carcinoma (TCGA, GDC)","type_of_cancer_id":"hnsc","sample_count":531,"has_guide":false},{"cancer_study_identifier":"ucec_tcga_pan_can_atlas_2018","name":"Uterine Corpus Endometrial Carcinoma (TCGA, PanCancer Atlas)","type_of_cancer_id":"ucec","sample_count":530,"has_guide":true},{"cancer_study_identifier":"hnsc_tcga_pan_can_atlas_2018","name":"Head and Neck Squamous Cell Carcinoma (TCGA, PanCancer Atlas)","type_of_cancer_id":"hnsc","sample_count":524,"has_guide":false},{"cancer_study_identifier":"thca_tcga","name":"Thyroid Carcinoma (TCGA, Firehose Legacy)","type_of_cancer_id":"thpa","sample_count":517,"has_guide":false},{"cancer_study_identifier":"thpa_tcga_gdc","name":"Papillary Thyroid Cancer (TCGA, GDC)","type_of_cancer_id":"thpa","sample_count":516,"has_guide":false},{"cancer_study_identifier":"lgg_tcga_pan_can_atlas_2018","name":"Brain Lower Grade Glioma (TCGA, PanCancer Atlas)","type_of_cancer_id":"difg","sample_count":515,"has_guide":false},{"cancer_study_identifier":"kirc_tcga_pan_can_atlas_2018","name":"Kidney Renal Clear Cell Carcinoma (TCGA, PanCancer Atlas)","type_of_cancer_id":"ccrcc","sample_count":513,"has_guide":false},{"cancer_study_identifier":"lusc_tcga","name":"Lung Squamous Cell Carcinoma (TCGA, Firehose Legacy)","type_of_cancer_id":"lusc","sample_count":512,"has_guide":false},{"cancer_study_identifier":"lusc_tcga_gdc","name":"Lung Squamous Cell Carcinoma (TCGA, GDC)","type_of_cancer_id":"lusc","sample_count":505,"has_guide":false},{"cancer_study_identifier":"prad_tcga_gdc","name":"Prostate Adenocarcinoma (TCGA, GDC)","type_of_cancer_id":"prad","sample_count":502,"has_guide":false},{"cancer_study_identifier":"prad_tcga","name":"Prostate Adenocarcinoma (TCGA, Firehose Legacy)","type_of_cancer_id":"prad","sample_count":502,"has_guide":false},{"cancer_study_identifier":"thca_tcga_pan_can_atlas_2018","name":"Thyroid Carcinoma (TCGA, PanCancer Atlas)","type_of_cancer_id":"thpa","sample_count":501,"has_guide":false},{"cancer_study_identifier":"thca_tcga_pub","name":"Papillary Thyroid Carcinoma (TCGA, Cell 2014)","type_of_cancer_id":"thpa","sample_count":497,"has_guide":false},{"cancer_study_identifier":"prad_tcga_pan_can_atlas_2018","name":"Prostate Adenocarcinoma (TCGA, PanCancer Atlas)","type_of_cancer_id":"prad","sample_count":495,"has_guide":false},{"cancer_study_identifier":"ov_tcga_pub","name":"Ovarian Serous Cystadenocarcinoma (TCGA, Nature 2011)","type_of_cancer_id":"hgsoc","sample_count":490,"has_guide":false},{"cancer_study_identifier":"lusc_tcga_pan_can_atlas_2018","name":"Lung Squamous Cell Carcinoma (TCGA, PanCancer Atlas)","type_of_cancer_id":"lusc","sample_count":488,"has_guide":false},{"cancer_study_identifier":"skcm_tcga","name":"Skin Cutaneous Melanoma (TCGA, Firehose Legacy)","type_of_cancer_id":"skcm","sample_count":481,"has_guide":false},{"cancer_study_identifier":"stad_tcga","name":"Stomach Adenocarcinoma (TCGA, Firehose Legacy)","type_of_cancer_id":"stad","sample_count":479,"has_guide":false},{"cancer_study_identifier":"blca_msk_tcga_2020","name":"Bladder Cancer (MSK/TCGA, 2020)","type_of_cancer_id":"blca","sample_count":477,"has_guide":false},{"cancer_study_identifier":"skcm_tcga_gdc","name":"Cutaneous Melanoma (TCGA, GDC)","type_of_cancer_id":"skcm","sample_count":475,"has_guide":false},{"cancer_study_identifier":"coad_tcga_gdc","name":"Colon Adenocarcinoma (TCGA, GDC)","type_of_cancer_id":"coad","sample_count":465,"has_guide":false},{"cancer_study_identifier":"skcm_tcga_pan_can_atlas_2018","name":"Skin Cutaneous Melanoma (TCGA, PanCancer Atlas)","type_of_cancer_id":"skcm","sample_count":449,"has_guide":false},{"cancer_study_identifier":"kirc_tcga_pub","name":"Kidney Renal Clear Cell Carcinoma (TCGA, Nature 2013)","type_of_cancer_id":"ccrcc","sample_count":447,"has_guide":false}]
```


Perfect! I found the Pan-Lung Cancer TCGA study: **nsclc_tcga_broad_2016**. Let me get the study guide and then analyze the genomic differences between adenocarcinomas and squamous cell carcinomas.



Calling `get_study_guide` with args:
```json
{
  "study_id": "nsclc_tcga_broad_2016"
}
```



Result from `get_study_guide`:
```json
# Study Guide: Pan-Lung Cancer (TCGA, Nat Genet 2016)

**Study ID:** `nsclc_tcga_broad_2016`
**Cancer Type:** nsclc
**Description:** Whole-exome sequencing of 660 lung ADC and 484 lung SqCC tumor/normal pairs.

## Cohort Statistics
- **Patients:** 1,144
- **Samples:** 1,145

## Available Data Types

- **COPY_NUMBER_ALTERATION**: Putative copy-number alterations
- **MUTATION_EXTENDED**: Somatic mutations
- **STRUCTURAL_VARIANT**: Structural variants

## Gene Panels

- **WES** (Whole Exome): 1,144 samples â€” all genes profiled

## Available Clinical Attributes

| Attribute | Samples with Data |
|-----------|------------------|
| CANCER_TYPE_DETAILED | 1,144 |
| MUTATION_COUNT | 1,144 |
| SOMATIC_STATUS | 1,144 |
| FRACTION_GENOME_ALTERED | 1,144 |
| TMB_NONSYNONYMOUS | 1,144 |
| ONCOTREE_CODE | 1,144 |
| T_STAGE | 1,144 |
| CANCER_TYPE | 1,144 |
| OS_MONTHS | 1 |
| DAYS_TO_DEATH | 1 |
| SMOKING_HISTORY | 1 |
| DAYS_TO_LAST_FOLLOWUP | 1 |
| SEX | 1 |
| HISTORY_OTHER_MALIGNANCY | 1 |
| STAGE | 1 |
| SMOKING_PACK_YEARS | 1 |
| HISTORY_NEOADJUVANT_TRTYN | 1 |
| SAMPLE_COUNT | 1 |
| AGE | 1 |
| AGE_AT_SURGERY | 1 |

## Top Mutated Genes

| Gene | Altered Samples |
|------|----------------|
| TP53 | 775 |
| TTN | 682 |
| CSMD3 | 477 |
| MUC16 | 463 |
| RYR2 | 448 |
| LRP1B | 402 |
| USH2A | 390 |
| ZFHX4 | 356 |
| SPTA1 | 284 |
| XIRP2 | 268 |

## Query Tips for nsclc_tcga_broad_2016

```sql
-- Get all samples in this study
SELECT DISTINCT sample_unique_id, patient_unique_id
FROM clinical_data_derived
WHERE cancer_study_identifier = 'nsclc_tcga_broad_2016';

-- Get mutations for a specific gene
SELECT sample_unique_id, hugo_gene_symbol, mutation_variant, mutation_type
FROM genomic_event_derived
WHERE cancer_study_identifier = 'nsclc_tcga_broad_2016'
    AND hugo_gene_symbol = 'TP53'
    AND variant_type = 'mutation';

-- Get clinical data for specific attributes
SELECT sample_unique_id, attribute_name, attribute_value
FROM clinical_data_derived
WHERE cancer_study_identifier = 'nsclc_tcga_broad_2016'
    AND attribute_name IN ('CANCER_TYPE', 'SAMPLE_TYPE', 'OS_MONTHS');
```

```


Great! Now let me analyze the genomic differences between lung adenocarcinomas (LUAD) and squamous cell carcinomas (LUSC). I'll look at:
1. Cancer type distribution
2. Mutation frequency differences for key genes
3. Tumor mutational burden (TMB) differences
4. Copy number alteration patterns



Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\n-- First, let's see the cancer type distribution\nSELECT \n    attribute_value as cancer_type,\n    COUNT(DISTINCT sample_unique_id) as sample_count\nFROM clinical_data_derived\nWHERE cancer_study_identifier = 'nsclc_tcga_broad_2016'\n    AND attribute_name = 'CANCER_TYPE_DETAILED'\nGROUP BY attribute_value\nORDER BY sample_count DESC\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"cancer_type":"Lung Adenocarcinoma","sample_count":660},{"cancer_type":"Lung Squamous Cell Carcinoma","sample_count":484}]}
```




Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\n-- Compare TMB between adenocarcinoma and squamous cell carcinoma\nSELECT \n    c.attribute_value as cancer_type,\n    COUNT(DISTINCT c.sample_unique_id) as sample_count,\n    ROUND(AVG(CAST(tmb.attribute_value AS Float64)), 2) as avg_tmb,\n    ROUND(median(CAST(tmb.attribute_value AS Float64)), 2) as median_tmb,\n    ROUND(quantile(0.25)(CAST(tmb.attribute_value AS Float64)), 2) as q25_tmb,\n    ROUND(quantile(0.75)(CAST(tmb.attribute_value AS Float64)), 2) as q75_tmb\nFROM clinical_data_derived c\nJOIN clinical_data_derived tmb ON c.sample_unique_id = tmb.sample_unique_id \n    AND tmb.cancer_study_identifier = 'nsclc_tcga_broad_2016'\n    AND tmb.attribute_name = 'TMB_NONSYNONYMOUS'\nWHERE c.cancer_study_identifier = 'nsclc_tcga_broad_2016'\n    AND c.attribute_name = 'CANCER_TYPE_DETAILED'\nGROUP BY c.attribute_value\nORDER BY avg_tmb DESC\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"cancer_type":"Lung Adenocarcinoma","sample_count":660,"avg_tmb":9.01,"median_tmb":6.27,"q25_tmb":2.6,"q75_tmb":12.13},{"cancer_type":"Lung Squamous Cell Carcinoma","sample_count":484,"avg_tmb":8.53,"median_tmb":7.07,"q25_tmb":5.17,"q75_tmb":10.21}]}
```




Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\n-- Compare mutation counts between the two cancer types\nSELECT \n    c.attribute_value as cancer_type,\n    COUNT(DISTINCT c.sample_unique_id) as sample_count,\n    ROUND(AVG(CAST(mc.attribute_value AS Float64)), 2) as avg_mutation_count,\n    ROUND(median(CAST(mc.attribute_value AS Float64)), 2) as median_mutation_count\nFROM clinical_data_derived c\nJOIN clinical_data_derived mc ON c.sample_unique_id = mc.sample_unique_id \n    AND mc.cancer_study_identifier = 'nsclc_tcga_broad_2016'\n    AND mc.attribute_name = 'MUTATION_COUNT'\nWHERE c.cancer_study_identifier = 'nsclc_tcga_broad_2016'\n    AND c.attribute_name = 'CANCER_TYPE_DETAILED'\nGROUP BY c.attribute_value\nORDER BY avg_mutation_count DESC\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"cancer_type":"Lung Adenocarcinoma","sample_count":660,"avg_mutation_count":270.1,"median_mutation_count":188.0},{"cancer_type":"Lung Squamous Cell Carcinoma","sample_count":484,"avg_mutation_count":255.87,"median_mutation_count":212.0}]}
```




Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\n-- Get top mutated genes in adenocarcinoma\nSELECT \n    g.hugo_gene_symbol,\n    COUNT(DISTINCT g.sample_unique_id) as mutated_samples,\n    ROUND(COUNT(DISTINCT g.sample_unique_id) * 100.0 / 660, 2) as percentage\nFROM genomic_event_derived g\nJOIN clinical_data_derived c ON g.sample_unique_id = c.sample_unique_id\n    AND c.cancer_study_identifier = 'nsclc_tcga_broad_2016'\n    AND c.attribute_name = 'CANCER_TYPE_DETAILED'\n    AND c.attribute_value = 'Lung Adenocarcinoma'\nWHERE g.cancer_study_identifier = 'nsclc_tcga_broad_2016'\n    AND g.variant_type = 'mutation'\nGROUP BY g.hugo_gene_symbol\nORDER BY mutated_samples DESC\nLIMIT 20\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"hugo_gene_symbol":"TP53","mutated_samples":357,"percentage":54.09},{"hugo_gene_symbol":"TTN","mutated_samples":325,"percentage":49.24},{"hugo_gene_symbol":"MUC16","mutated_samples":271,"percentage":41.06},{"hugo_gene_symbol":"CSMD3","mutated_samples":262,"percentage":39.7},{"hugo_gene_symbol":"RYR2","mutated_samples":250,"percentage":37.88},{"hugo_gene_symbol":"LRP1B","mutated_samples":231,"percentage":35.0},{"hugo_gene_symbol":"USH2A","mutated_samples":224,"percentage":33.94},{"hugo_gene_symbol":"KRAS","mutated_samples":214,"percentage":32.42},{"hugo_gene_symbol":"ZFHX4","mutated_samples":205,"percentage":31.06},{"hugo_gene_symbol":"SPTA1","mutated_samples":178,"percentage":26.97},{"hugo_gene_symbol":"XIRP2","mutated_samples":173,"percentage":26.21},{"hugo_gene_symbol":"FLG","mutated_samples":161,"percentage":24.39},{"hugo_gene_symbol":"FAT3","mutated_samples":147,"percentage":22.27},{"hugo_gene_symbol":"CSMD1","mutated_samples":145,"percentage":21.97},{"hugo_gene_symbol":"MUC17","mutated_samples":136,"percentage":20.61},{"hugo_gene_symbol":"PCLO","mutated_samples":131,"percentage":19.85},{"hugo_gene_symbol":"PCDH15","mutated_samples":131,"percentage":19.85},{"hugo_gene_symbol":"APOB","mutated_samples":130,"percentage":19.7},{"hugo_gene_symbol":"COL11A1","mutated_samples":130,"percentage":19.7},{"hugo_gene_symbol":"NAV3","mutated_samples":130,"percentage":19.7}]}
```




Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\n-- Get top mutated genes in squamous cell carcinoma\nSELECT \n    g.hugo_gene_symbol,\n    COUNT(DISTINCT g.sample_unique_id) as mutated_samples,\n    ROUND(COUNT(DISTINCT g.sample_unique_id) * 100.0 / 484, 2) as percentage\nFROM genomic_event_derived g\nJOIN clinical_data_derived c ON g.sample_unique_id = c.sample_unique_id\n    AND c.cancer_study_identifier = 'nsclc_tcga_broad_2016'\n    AND c.attribute_name = 'CANCER_TYPE_DETAILED'\n    AND c.attribute_value = 'Lung Squamous Cell Carcinoma'\nWHERE g.cancer_study_identifier = 'nsclc_tcga_broad_2016'\n    AND g.variant_type = 'mutation'\nGROUP BY g.hugo_gene_symbol\nORDER BY mutated_samples DESC\nLIMIT 20\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"hugo_gene_symbol":"TP53","mutated_samples":418,"percentage":86.36},{"hugo_gene_symbol":"TTN","mutated_samples":357,"percentage":73.76},{"hugo_gene_symbol":"CSMD3","mutated_samples":215,"percentage":44.42},{"hugo_gene_symbol":"RYR2","mutated_samples":198,"percentage":40.91},{"hugo_gene_symbol":"MUC16","mutated_samples":192,"percentage":39.67},{"hugo_gene_symbol":"LRP1B","mutated_samples":171,"percentage":35.33},{"hugo_gene_symbol":"USH2A","mutated_samples":166,"percentage":34.3},{"hugo_gene_symbol":"SYNE1","mutated_samples":158,"percentage":32.64},{"hugo_gene_symbol":"ZFHX4","mutated_samples":151,"percentage":31.2},{"hugo_gene_symbol":"FAM135B","mutated_samples":121,"percentage":25.0},{"hugo_gene_symbol":"KMT2D","mutated_samples":114,"percentage":23.55},{"hugo_gene_symbol":"SPTA1","mutated_samples":106,"percentage":21.9},{"hugo_gene_symbol":"NAV3","mutated_samples":104,"percentage":21.49},{"hugo_gene_symbol":"PCDH15","mutated_samples":99,"percentage":20.45},{"hugo_gene_symbol":"RYR3","mutated_samples":97,"percentage":20.04},{"hugo_gene_symbol":"XIRP2","mutated_samples":95,"percentage":19.63},{"hugo_gene_symbol":"DNAH5","mutated_samples":94,"percentage":19.42},{"hugo_gene_symbol":"FLG","mutated_samples":92,"percentage":19.01},{"hugo_gene_symbol":"PKHD1L1","mutated_samples":92,"percentage":19.01},{"hugo_gene_symbol":"CDH10","mutated_samples":92,"percentage":19.01}]}
```


Now let me look at specific key driver genes that are known to differ between these subtypes:



Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\n-- Compare key driver genes between adenocarcinoma and squamous cell carcinoma\nWITH cancer_samples AS (\n    SELECT \n        sample_unique_id,\n        attribute_value as cancer_type\n    FROM clinical_data_derived\n    WHERE cancer_study_identifier = 'nsclc_tcga_broad_2016'\n        AND attribute_name = 'CANCER_TYPE_DETAILED'\n),\ngene_mutations AS (\n    SELECT \n        cs.cancer_type,\n        g.hugo_gene_symbol,\n        COUNT(DISTINCT g.sample_unique_id) as mutated_samples\n    FROM genomic_event_derived g\n    JOIN cancer_samples cs ON g.sample_unique_id = cs.sample_unique_id\n    WHERE g.cancer_study_identifier = 'nsclc_tcga_broad_2016'\n        AND g.variant_type = 'mutation'\n        AND g.hugo_gene_symbol IN ('TP53', 'KRAS', 'EGFR', 'STK11', 'KEAP1', 'NF1', 'BRAF', \n                                    'PIK3CA', 'CDKN2A', 'PTEN', 'RB1', 'NFE2L2', 'NOTCH1', \n                                    'FBXW7', 'HLA-A', 'EPHA3', 'SOX2', 'TP63', 'FGFR1')\n    GROUP BY cs.cancer_type, g.hugo_gene_symbol\n)\nSELECT \n    hugo_gene_symbol,\n    MAX(CASE WHEN cancer_type = 'Lung Adenocarcinoma' THEN mutated_samples ELSE 0 END) as luad_count,\n    ROUND(MAX(CASE WHEN cancer_type = 'Lung Adenocarcinoma' THEN mutated_samples ELSE 0 END) * 100.0 / 660, 2) as luad_pct,\n    MAX(CASE WHEN cancer_type = 'Lung Squamous Cell Carcinoma' THEN mutated_samples ELSE 0 END) as lusc_count,\n    ROUND(MAX(CASE WHEN cancer_type = 'Lung Squamous Cell Carcinoma' THEN mutated_samples ELSE 0 END) * 100.0 / 484, 2) as lusc_pct,\n    ROUND(MAX(CASE WHEN cancer_type = 'Lung Adenocarcinoma' THEN mutated_samples ELSE 0 END) * 100.0 / 660 - \n          MAX(CASE WHEN cancer_type = 'Lung Squamous Cell Carcinoma' THEN mutated_samples ELSE 0 END) * 100.0 / 484, 2) as diff_pct\nFROM gene_mutations\nGROUP BY hugo_gene_symbol\nORDER BY ABS(diff_pct) DESC\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"hugo_gene_symbol":"TP53","luad_count":357,"luad_pct":54.09,"lusc_count":418,"lusc_pct":86.36,"diff_pct":-32.27},{"hugo_gene_symbol":"KRAS","luad_count":214,"luad_pct":32.42,"lusc_count":8,"lusc_pct":1.65,"diff_pct":30.77},{"hugo_gene_symbol":"STK11","luad_count":104,"luad_pct":15.76,"lusc_count":7,"lusc_pct":1.45,"diff_pct":14.31},{"hugo_gene_symbol":"EGFR","luad_count":104,"luad_pct":15.76,"lusc_count":13,"lusc_pct":2.69,"diff_pct":13.07},{"hugo_gene_symbol":"NFE2L2","luad_count":14,"luad_pct":2.12,"lusc_count":70,"lusc_pct":14.46,"diff_pct":-12.34},{"hugo_gene_symbol":"CDKN2A","luad_count":27,"luad_pct":4.09,"lusc_count":75,"lusc_pct":15.5,"diff_pct":-11.4},{"hugo_gene_symbol":"PTEN","luad_count":11,"luad_pct":1.67,"lusc_count":56,"lusc_pct":11.57,"diff_pct":-9.9},{"hugo_gene_symbol":"KEAP1","luad_count":110,"luad_pct":16.67,"lusc_count":52,"lusc_pct":10.74,"diff_pct":5.92},{"hugo_gene_symbol":"PIK3CA","luad_count":39,"luad_pct":5.91,"lusc_count":55,"lusc_pct":11.36,"diff_pct":-5.45},{"hugo_gene_symbol":"BRAF","luad_count":54,"luad_pct":8.18,"lusc_count":16,"lusc_pct":3.31,"diff_pct":4.88},{"hugo_gene_symbol":"NOTCH1","luad_count":31,"luad_pct":4.7,"lusc_count":40,"lusc_pct":8.26,"diff_pct":-3.57},{"hugo_gene_symbol":"FBXW7","luad_count":17,"luad_pct":2.58,"lusc_count":24,"lusc_pct":4.96,"diff_pct":-2.38},{"hugo_gene_symbol":"EPHA3","luad_count":66,"luad_pct":10.0,"lusc_count":39,"lusc_pct":8.06,"diff_pct":1.94},{"hugo_gene_symbol":"RB1","luad_count":38,"luad_pct":5.76,"lusc_count":35,"lusc_pct":7.23,"diff_pct":-1.47},{"hugo_gene_symbol":"NF1","luad_count":76,"luad_pct":11.52,"lusc_count":51,"lusc_pct":10.54,"diff_pct":0.98},{"hugo_gene_symbol":"HLA-A","luad_count":8,"luad_pct":1.21,"lusc_count":10,"lusc_pct":2.07,"diff_pct":-0.85},{"hugo_gene_symbol":"SOX2","luad_count":4,"luad_pct":0.61,"lusc_count":4,"lusc_pct":0.83,"diff_pct":-0.22},{"hugo_gene_symbol":"TP63","luad_count":14,"luad_pct":2.12,"lusc_count":11,"lusc_pct":2.27,"diff_pct":-0.15},{"hugo_gene_symbol":"FGFR1","luad_count":5,"luad_pct":0.76,"lusc_count":4,"lusc_pct":0.83,"diff_pct":-0.07}]}
```


Now let me check for copy number alterations:



Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\n-- Compare fraction genome altered between the two cancer types\nSELECT \n    c.attribute_value as cancer_type,\n    COUNT(DISTINCT c.sample_unique_id) as sample_count,\n    ROUND(AVG(CAST(fga.attribute_value AS Float64)), 4) as avg_fga,\n    ROUND(median(CAST(fga.attribute_value AS Float64)), 4) as median_fga,\n    ROUND(quantile(0.25)(CAST(fga.attribute_value AS Float64)), 4) as q25_fga,\n    ROUND(quantile(0.75)(CAST(fga.attribute_value AS Float64)), 4) as q75_fga\nFROM clinical_data_derived c\nJOIN clinical_data_derived fga ON c.sample_unique_id = fga.sample_unique_id \n    AND fga.cancer_study_identifier = 'nsclc_tcga_broad_2016'\n    AND fga.attribute_name = 'FRACTION_GENOME_ALTERED'\nWHERE c.cancer_study_identifier = 'nsclc_tcga_broad_2016'\n    AND c.attribute_name = 'CANCER_TYPE_DETAILED'\nGROUP BY c.attribute_value\nORDER BY avg_fga DESC\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"cancer_type":"Lung Squamous Cell Carcinoma","sample_count":484,"avg_fga":0.3923,"median_fga":0.3924,"q25_fga":0.268,"q75_fga":0.5428},{"cancer_type":"Lung Adenocarcinoma","sample_count":660,"avg_fga":0.2639,"median_fga":0.2364,"q25_fga":0.1039,"q75_fga":0.3952}]}
```




Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\n-- Get top amplified/deleted genes in adenocarcinoma\nSELECT \n    g.hugo_gene_symbol,\n    g.alteration,\n    COUNT(DISTINCT g.sample_unique_id) as altered_samples,\n    ROUND(COUNT(DISTINCT g.sample_unique_id) * 100.0 / 660, 2) as percentage\nFROM genomic_event_derived g\nJOIN clinical_data_derived c ON g.sample_unique_id = c.sample_unique_id\n    AND c.cancer_study_identifier = 'nsclc_tcga_broad_2016'\n    AND c.attribute_name = 'CANCER_TYPE_DETAILED'\n    AND c.attribute_value = 'Lung Adenocarcinoma'\nWHERE g.cancer_study_identifier = 'nsclc_tcga_broad_2016'\n    AND g.variant_type = 'cna'\n    AND g.alteration IN ('Amplification', 'Deep Deletion')\nGROUP BY g.hugo_gene_symbol, g.alteration\nHAVING altered_samples >= 20\nORDER BY altered_samples DESC\nLIMIT 30\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"error_message":"Query execution failed: Received ClickHouse exception, code: 47, server response: Code: 47. DB::Exception: Identifier 'g.alteration' cannot be resolved from table with name g. In scope SELECT g.hugo_gene_symbol, g.alteration, COUNTDistinct(g.sample_unique_id) AS altered_samples, ROUND((COUNTDistinct(g.sample_unique_id) * 100.) / 660, 2) AS percentage FROM genomic_event_derived AS g INNER JOIN clinical_data_derived AS c ON (g.sample_unique_id = c.sample_unique_id) AND (c.cancer_study_identifier = 'nsclc_tcga_broad_2016') AND (c.attribute_name = 'CANCER_TYPE_DETAILED') AND (c.attribute_value = 'Lung Adenocarcinoma') WHERE (g.cancer_study_identifier = 'nsclc_tcga_broad_2016') AND (g.variant_type = 'cna') AND (g.alteration IN ('Amplification', 'Deep Deletion')) GROUP BY g.hugo_gene_symbol, g.alteration HAVING altered_samples >= 20 ORDER BY altered_samples DESC LIMIT 30. Maybe you meant: ['g.cna_alteration']. (UNKNOWN_IDENTIFIER) (version 25.8.1.36912 (official build)) (for url https://dl96orhu96.us-east-1.aws.clickhouse.cloud:8443)"}
```




Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\n-- Get top amplified/deleted genes in adenocarcinoma (corrected column name)\nSELECT \n    g.hugo_gene_symbol,\n    g.cna_alteration,\n    COUNT(DISTINCT g.sample_unique_id) as altered_samples,\n    ROUND(COUNT(DISTINCT g.sample_unique_id) * 100.0 / 660, 2) as percentage\nFROM genomic_event_derived g\nJOIN clinical_data_derived c ON g.sample_unique_id = c.sample_unique_id\n    AND c.cancer_study_identifier = 'nsclc_tcga_broad_2016'\n    AND c.attribute_name = 'CANCER_TYPE_DETAILED'\n    AND c.attribute_value = 'Lung Adenocarcinoma'\nWHERE g.cancer_study_identifier = 'nsclc_tcga_broad_2016'\n    AND g.variant_type = 'cna'\n    AND g.cna_alteration IN ('Amplification', 'Deep Deletion')\nGROUP BY g.hugo_gene_symbol, g.cna_alteration\nHAVING altered_samples >= 20\nORDER BY altered_samples DESC\nLIMIT 30\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"error_message":"Query execution failed: Received ClickHouse exception, code: 53, server response: Code: 53. DB::Exception: Cannot convert string 'Amplification' to type Int8. (TYPE_MISMATCH) (version 25.8.1.36912 (official build)) (for url https://dl96orhu96.us-east-1.aws.clickhouse.cloud:8443)"}
```


Let me check the structure of the CNA data:



Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\n-- Check CNA alteration values\nSELECT DISTINCT cna_alteration\nFROM genomic_event_derived\nWHERE cancer_study_identifier = 'nsclc_tcga_broad_2016'\n    AND variant_type = 'cna'\nLIMIT 10\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"cna_alteration":2},{"cna_alteration":-2}]}
```




Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\n-- Get top amplified genes (cna_alteration = 2) in adenocarcinoma\nSELECT \n    g.hugo_gene_symbol,\n    CASE WHEN g.cna_alteration = 2 THEN 'Amplification' ELSE 'Deep Deletion' END as alteration_type,\n    COUNT(DISTINCT g.sample_unique_id) as altered_samples,\n    ROUND(COUNT(DISTINCT g.sample_unique_id) * 100.0 / 660, 2) as percentage\nFROM genomic_event_derived g\nJOIN clinical_data_derived c ON g.sample_unique_id = c.sample_unique_id\n    AND c.cancer_study_identifier = 'nsclc_tcga_broad_2016'\n    AND c.attribute_name = 'CANCER_TYPE_DETAILED'\n    AND c.attribute_value = 'Lung Adenocarcinoma'\nWHERE g.cancer_study_identifier = 'nsclc_tcga_broad_2016'\n    AND g.variant_type = 'cna'\n    AND g.cna_alteration = 2\nGROUP BY g.hugo_gene_symbol, g.cna_alteration\nHAVING altered_samples >= 20\nORDER BY altered_samples DESC\nLIMIT 20\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"hugo_gene_symbol":"PDCD6","alteration_type":"Amplification","altered_samples":99,"percentage":15.0},{"hugo_gene_symbol":"EXOC3","alteration_type":"Amplification","altered_samples":99,"percentage":15.0},{"hugo_gene_symbol":"CEP72","alteration_type":"Amplification","altered_samples":99,"percentage":15.0},{"hugo_gene_symbol":"LRRC14B","alteration_type":"Amplification","altered_samples":99,"percentage":15.0},{"hugo_gene_symbol":"PLEKHG4B","alteration_type":"Amplification","altered_samples":99,"percentage":15.0},{"hugo_gene_symbol":"AHRR","alteration_type":"Amplification","altered_samples":99,"percentage":15.0},{"hugo_gene_symbol":"CCDC127","alteration_type":"Amplification","altered_samples":99,"percentage":15.0},{"hugo_gene_symbol":"TPPP","alteration_type":"Amplification","altered_samples":99,"percentage":15.0},{"hugo_gene_symbol":"SLC9A3-OT1","alteration_type":"Amplification","altered_samples":99,"percentage":15.0},{"hugo_gene_symbol":"EXOC3-AS1","alteration_type":"Amplification","altered_samples":99,"percentage":15.0},{"hugo_gene_symbol":"TRIP13","alteration_type":"Amplification","altered_samples":99,"percentage":15.0},{"hugo_gene_symbol":"SLC9A3","alteration_type":"Amplification","altered_samples":99,"percentage":15.0},{"hugo_gene_symbol":"SDHA","alteration_type":"Amplification","altered_samples":99,"percentage":15.0},{"hugo_gene_symbol":"BRD9","alteration_type":"Amplification","altered_samples":99,"percentage":15.0},{"hugo_gene_symbol":"ZDHHC11","alteration_type":"Amplification","altered_samples":99,"percentage":15.0},{"hugo_gene_symbol":"LINC02982","alteration_type":"Amplification","altered_samples":98,"percentage":14.85},{"hugo_gene_symbol":"NKD2","alteration_type":"Amplification","altered_samples":98,"percentage":14.85},{"hugo_gene_symbol":"TERT","alteration_type":"Amplification","altered_samples":98,"percentage":14.85},{"hugo_gene_symbol":"SLC6A19","alteration_type":"Amplification","altered_samples":97,"percentage":14.7},{"hugo_gene_symbol":"SLC12A7","alteration_type":"Amplification","altered_samples":97,"percentage":14.7}]}
```




Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\n-- Get top amplified genes (cna_alteration = 2) in squamous cell carcinoma\nSELECT \n    g.hugo_gene_symbol,\n    CASE WHEN g.cna_alteration = 2 THEN 'Amplification' ELSE 'Deep Deletion' END as alteration_type,\n    COUNT(DISTINCT g.sample_unique_id) as altered_samples,\n    ROUND(COUNT(DISTINCT g.sample_unique_id) * 100.0 / 484, 2) as percentage\nFROM genomic_event_derived g\nJOIN clinical_data_derived c ON g.sample_unique_id = c.sample_unique_id\n    AND c.cancer_study_identifier = 'nsclc_tcga_broad_2016'\n    AND c.attribute_name = 'CANCER_TYPE_DETAILED'\n    AND c.attribute_value = 'Lung Squamous Cell Carcinoma'\nWHERE g.cancer_study_identifier = 'nsclc_tcga_broad_2016'\n    AND g.variant_type = 'cna'\n    AND g.cna_alteration = 2\nGROUP BY g.hugo_gene_symbol, g.cna_alteration\nHAVING altered_samples >= 20\nORDER BY altered_samples DESC\nLIMIT 20\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"hugo_gene_symbol":"SOX2-OT","alteration_type":"Amplification","altered_samples":205,"percentage":42.36},{"hugo_gene_symbol":"SOX2","alteration_type":"Amplification","altered_samples":205,"percentage":42.36},{"hugo_gene_symbol":"DCUN1D1","alteration_type":"Amplification","altered_samples":205,"percentage":42.36},{"hugo_gene_symbol":"MCCC1","alteration_type":"Amplification","altered_samples":204,"percentage":42.15},{"hugo_gene_symbol":"LINC01994","alteration_type":"Amplification","altered_samples":204,"percentage":42.15},{"hugo_gene_symbol":"B3GNT5","alteration_type":"Amplification","altered_samples":204,"percentage":42.15},{"hugo_gene_symbol":"ATP11B","alteration_type":"Amplification","altered_samples":204,"percentage":42.15},{"hugo_gene_symbol":"LAMP3","alteration_type":"Amplification","altered_samples":203,"percentage":41.94},{"hugo_gene_symbol":"MCF2L2","alteration_type":"Amplification","altered_samples":202,"percentage":41.74},{"hugo_gene_symbol":"DVL3","alteration_type":"Amplification","altered_samples":197,"percentage":40.7},{"hugo_gene_symbol":"HTR3E","alteration_type":"Amplification","altered_samples":197,"percentage":40.7},{"hugo_gene_symbol":"EIF2B5","alteration_type":"Amplification","altered_samples":197,"percentage":40.7},{"hugo_gene_symbol":"FXR1","alteration_type":"Amplification","altered_samples":197,"percentage":40.7},{"hugo_gene_symbol":"HTR3C","alteration_type":"Amplification","altered_samples":197,"percentage":40.7},{"hugo_gene_symbol":"KLHL24","alteration_type":"Amplification","altered_samples":197,"percentage":40.7},{"hugo_gene_symbol":"ABCC5","alteration_type":"Amplification","altered_samples":197,"percentage":40.7},{"hugo_gene_symbol":"DNAJC19","alteration_type":"Amplification","altered_samples":197,"percentage":40.7},{"hugo_gene_symbol":"KLHL6","alteration_type":"Amplification","altered_samples":197,"percentage":40.7},{"hugo_gene_symbol":"MAP6D1","alteration_type":"Amplification","altered_samples":197,"percentage":40.7},{"hugo_gene_symbol":"HTR3D","alteration_type":"Amplification","altered_samples":197,"percentage":40.7}]}
```




Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\n-- Compare key oncogenes and tumor suppressors for CNA between the two types\nWITH cancer_samples AS (\n    SELECT \n        sample_unique_id,\n        attribute_value as cancer_type\n    FROM clinical_data_derived\n    WHERE cancer_study_identifier = 'nsclc_tcga_broad_2016'\n        AND attribute_name = 'CANCER_TYPE_DETAILED'\n),\ngene_cnas AS (\n    SELECT \n        cs.cancer_type,\n        g.hugo_gene_symbol,\n        g.cna_alteration,\n        COUNT(DISTINCT g.sample_unique_id) as altered_samples\n    FROM genomic_event_derived g\n    JOIN cancer_samples cs ON g.sample_unique_id = cs.sample_unique_id\n    WHERE g.cancer_study_identifier = 'nsclc_tcga_broad_2016'\n        AND g.variant_type = 'cna'\n        AND g.hugo_gene_symbol IN ('SOX2', 'TP63', 'PIK3CA', 'FGFR1', 'CCND1', 'MYC', \n                                    'EGFR', 'KRAS', 'MET', 'ERBB2', 'MDM2', 'CDK4',\n                                    'CDKN2A', 'CDKN2B', 'PTEN', 'RB1', 'STK11', 'KEAP1')\n        AND g.cna_alteration IN (2, -2)\n    GROUP BY cs.cancer_type, g.hugo_gene_symbol, g.cna_alteration\n)\nSELECT \n    hugo_gene_symbol,\n    CASE WHEN cna_alteration = 2 THEN 'Amplification' ELSE 'Deep Deletion' END as alteration,\n    MAX(CASE WHEN cancer_type = 'Lung Adenocarcinoma' THEN altered_samples ELSE 0 END) as luad_count,\n    ROUND(MAX(CASE WHEN cancer_type = 'Lung Adenocarcinoma' THEN altered_samples ELSE 0 END) * 100.0 / 660, 2) as luad_pct,\n    MAX(CASE WHEN cancer_type = 'Lung Squamous Cell Carcinoma' THEN altered_samples ELSE 0 END) as lusc_count,\n    ROUND(MAX(CASE WHEN cancer_type = 'Lung Squamous Cell Carcinoma' THEN altered_samples ELSE 0 END) * 100.0 / 484, 2) as lusc_pct\nFROM gene_cnas\nGROUP BY hugo_gene_symbol, cna_alteration\nHAVING luad_count > 10 OR lusc_count > 10\nORDER BY hugo_gene_symbol, cna_alteration\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"hugo_gene_symbol":"CCND1","alteration":"Amplification","luad_count":26,"luad_pct":3.94,"lusc_count":63,"lusc_pct":13.02},{"hugo_gene_symbol":"CDK4","alteration":"Amplification","luad_count":43,"luad_pct":6.52,"lusc_count":2,"lusc_pct":0.41},{"hugo_gene_symbol":"CDKN2A","alteration":"Deep Deletion","luad_count":112,"luad_pct":16.97,"lusc_count":129,"lusc_pct":26.65},{"hugo_gene_symbol":"CDKN2B","alteration":"Deep Deletion","luad_count":108,"luad_pct":16.36,"lusc_count":129,"lusc_pct":26.65},{"hugo_gene_symbol":"EGFR","alteration":"Amplification","luad_count":36,"luad_pct":5.45,"lusc_count":33,"lusc_pct":6.82},{"hugo_gene_symbol":"ERBB2","alteration":"Amplification","luad_count":15,"luad_pct":2.27,"lusc_count":11,"lusc_pct":2.27},{"hugo_gene_symbol":"FGFR1","alteration":"Amplification","luad_count":19,"luad_pct":2.88,"lusc_count":83,"lusc_pct":17.15},{"hugo_gene_symbol":"KRAS","alteration":"Amplification","luad_count":40,"luad_pct":6.06,"lusc_count":18,"lusc_pct":3.72},{"hugo_gene_symbol":"MDM2","alteration":"Amplification","luad_count":36,"luad_pct":5.45,"lusc_count":10,"lusc_pct":2.07},{"hugo_gene_symbol":"MET","alteration":"Amplification","luad_count":14,"luad_pct":2.12,"lusc_count":5,"lusc_pct":1.03},{"hugo_gene_symbol":"MYC","alteration":"Amplification","luad_count":62,"luad_pct":9.39,"lusc_count":38,"lusc_pct":7.85},{"hugo_gene_symbol":"PIK3CA","alteration":"Amplification","luad_count":14,"luad_pct":2.12,"lusc_count":194,"lusc_pct":40.08},{"hugo_gene_symbol":"PTEN","alteration":"Deep Deletion","luad_count":5,"luad_pct":0.76,"lusc_count":31,"lusc_pct":6.4},{"hugo_gene_symbol":"SOX2","alteration":"Amplification","luad_count":15,"luad_pct":2.27,"lusc_count":205,"lusc_pct":42.36},{"hugo_gene_symbol":"TP63","alteration":"Amplification","luad_count":13,"luad_pct":1.97,"lusc_count":163,"lusc_pct":33.68}]}
```


Perfect! Now let me get some additional pathway-level information:



Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\n-- Look at additional pathway genes that differ\nWITH cancer_samples AS (\n    SELECT \n        sample_unique_id,\n        attribute_value as cancer_type\n    FROM clinical_data_derived\n    WHERE cancer_study_identifier = 'nsclc_tcga_broad_2016'\n        AND attribute_name = 'CANCER_TYPE_DETAILED'\n),\ngene_mutations AS (\n    SELECT \n        cs.cancer_type,\n        g.hugo_gene_symbol,\n        COUNT(DISTINCT g.sample_unique_id) as mutated_samples\n    FROM genomic_event_derived g\n    JOIN cancer_samples cs ON g.sample_unique_id = cs.sample_unique_id\n    WHERE g.cancer_study_identifier = 'nsclc_tcga_broad_2016'\n        AND g.variant_type = 'mutation'\n        AND g.hugo_gene_symbol IN ('ALK', 'RET', 'ROS1', 'ERBB2', 'MET', 'NTRK1', 'NTRK2', 'NTRK3')\n    GROUP BY cs.cancer_type, g.hugo_gene_symbol\n)\nSELECT \n    hugo_gene_symbol,\n    MAX(CASE WHEN cancer_type = 'Lung Adenocarcinoma' THEN mutated_samples ELSE 0 END) as luad_count,\n    ROUND(MAX(CASE WHEN cancer_type = 'Lung Adenocarcinoma' THEN mutated_samples ELSE 0 END) * 100.0 / 660, 2) as luad_pct,\n    MAX(CASE WHEN cancer_type = 'Lung Squamous Cell Carcinoma' THEN mutated_samples ELSE 0 END) as lusc_count,\n    ROUND(MAX(CASE WHEN cancer_type = 'Lung Squamous Cell Carcinoma' THEN mutated_samples ELSE 0 END) * 100.0 / 484, 2) as lusc_pct\nFROM gene_mutations\nGROUP BY hugo_gene_symbol\nHAVING luad_count > 0 OR lusc_count > 0\nORDER BY luad_pct DESC\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"hugo_gene_symbol":"NTRK3","luad_count":52,"luad_pct":7.88,"lusc_count":23,"lusc_pct":4.75},{"hugo_gene_symbol":"ALK","luad_count":33,"luad_pct":5.0,"lusc_count":18,"lusc_pct":3.72},{"hugo_gene_symbol":"MET","luad_count":28,"luad_pct":4.24,"lusc_count":6,"lusc_pct":1.24},{"hugo_gene_symbol":"ROS1","luad_count":25,"luad_pct":3.79,"lusc_count":37,"lusc_pct":7.64},{"hugo_gene_symbol":"RET","luad_count":25,"luad_pct":3.79,"lusc_count":17,"lusc_pct":3.51},{"hugo_gene_symbol":"NTRK2","luad_count":22,"luad_pct":3.33,"lusc_count":10,"lusc_pct":2.07},{"hugo_gene_symbol":"NTRK1","luad_count":17,"luad_pct":2.58,"lusc_count":11,"lusc_pct":2.27},{"hugo_gene_symbol":"ERBB2","luad_count":17,"luad_pct":2.58,"lusc_count":9,"lusc_pct":1.86}]}
```


Excellent! Now I have comprehensive data. Let me create a summary of the key genomic differences:

## Key Genomic Differences Between Lung Adenocarcinomas and Squamous Cell Carcinomas in the Pan-Lung Cancer TCGA Study

Based on the analysis of 660 lung adenocarcinomas (LUAD) and 484 lung squamous cell carcinomas (LUSC) from the TCGA Pan-Lung Cancer study (Nat Genet 2016), here are the major genomic differences:

### 1. **Overall Genomic Instability**

- **Fraction Genome Altered (FGA):**
  - LUSC: 39.2% (median: 39.2%)
  - LUAD: 26.4% (median: 23.6%)
  - **LUSC shows significantly higher chromosomal instability** (~50% more)

- **Tumor Mutational Burden (TMB):**
  - LUAD: 9.01 mutations/Mb (median: 6.27)
  - LUSC: 8.53 mutations/Mb (median: 7.07)
  - Similar overall, but LUSC has more consistent TMB

### 2. **Major Mutation Frequency Differences**

#### **Genes Enriched in Adenocarcinoma:**

| Gene | LUAD | LUSC | Difference | Pathway/Function |
|------|------|------|------------|------------------|
| **KRAS** | 32.4% | 1.7% | **+30.8%** | RAS/MAPK signaling |
| **STK11** | 15.8% | 1.4% | **+14.3%** | LKB1 tumor suppressor |
| **EGFR** | 15.8% | 2.7% | **+13.1%** | RTK signaling |
| **KEAP1** | 16.7% | 10.7% | **+5.9%** | NRF2 pathway |
| **BRAF** | 8.2% | 3.3% | **+4.9%** | MAPK signaling |

#### **Genes Enriched in Squamous Cell Carcinoma:**

| Gene | LUSC | LUAD | Difference | Pathway/Function |
|------|------|------|------------|------------------|
| **TP53** | 86.4% | 54.1% | **+32.3%** | Cell cycle/apoptosis |
| **NFE2L2** | 14.5% | 2.1% | **+12.3%** | NRF2 oxidative stress |
| **CDKN2A** | 15.5% | 4.1% | **+11.4%** | Cell cycle inhibitor |
| **PTEN** | 11.6% | 1.7% | **+9.9%** | PI3K/AKT pathway |
| **PIK3CA** | 11.4% | 5.9% | **+5.5%** | PI3K/AKT pathway |

### 3. **Copy Number Alteration Patterns**

#### **Amplifications Highly Enriched in LUSC:**

| Gene | LUSC | LUAD | Difference | Significance |
|------|------|------|------------|--------------|
| **SOX2** | 42.4% | 2.3% | **+40.1%** | Lineage transcription factor |
| **PIK3CA** | 40.1% | 2.1% | **+38.0%** | PI3K pathway activation |
| **TP63** | 33.7% | 2.0% | **+31.7%** | Squamous lineage marker |
| **FGFR1** | 17.2% | 2.9% | **+14.3%** | RTK signaling |
| **CCND1** | 13.0% | 3.9% | **+9.1%** | Cell cycle |

#### **Deletions More Common in LUSC:**

| Gene | LUSC | LUAD |

---

## Model Information
- **model**: us.anthropic.claude-sonnet-4-5-20250929-v1:0
- **temperature**: 0.0
- **max_output_tokens**: 1024
- **thinking_enabled**: False
- **thinking_budget_tokens**: 1024
- **response_time_seconds**: 110.26100527797826
- **agent_type**: mcp-clickhouse

### Usage
- **input_tokens**: 219222
- **output_tokens**: 7089
- **total_tokens**: 226311
- **cache_creation_input_tokens**: 0
- **cache_read_input_tokens**: 0

---

*Generated on 2026-02-05 13:39:21*