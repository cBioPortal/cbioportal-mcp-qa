# Question 47

**Type:** Cross-Study Expression Comparison

**Question:** How does ERBB2 mRNA expression vary across different cancer types in TCGA Pan-Cancer Atlas studies?

**Answer:**

I'll help you analyze ERBB2 mRNA expression across different cancer types in TCGA Pan-Cancer Atlas studies. Let me start by exploring the available data.



Calling `list_studies` with args:
```json
{
  "search": "pan cancer atlas",
  "limit": 50
}
```



Result from `list_studies`:
```json

```




Calling `list_studies` with args:
```json
{
  "search": "tcga",
  "limit": 50
}
```



Result from `list_studies`:
```json
[{"cancer_study_identifier":"nsclc_tcga_broad_2016","name":"Pan-Lung Cancer (TCGA, Nat Genet 2016)","type_of_cancer_id":"nsclc","sample_count":1145,"has_guide":false},{"cancer_study_identifier":"lgggbm_tcga_pub","name":"Merged Cohort of LGG and GBM (TCGA, Cell 2016)","type_of_cancer_id":"difg","sample_count":1123,"has_guide":false},{"cancer_study_identifier":"brca_tcga","name":"Breast Invasive Carcinoma (TCGA, Firehose Legacy)","type_of_cancer_id":"brca","sample_count":1109,"has_guide":false},{"cancer_study_identifier":"brca_tcga_gdc","name":"Invasive Breast Carcinoma (TCGA, GDC)","type_of_cancer_id":"brca","sample_count":1106,"has_guide":false},{"cancer_study_identifier":"brca_tcga_pan_can_atlas_2018","name":"Breast Invasive Carcinoma (TCGA, PanCancer Atlas)","type_of_cancer_id":"brca","sample_count":1085,"has_guide":true},{"cancer_study_identifier":"brca_tcga_pub","name":"Breast Invasive Carcinoma (TCGA, Nature 2012)","type_of_cancer_id":"brca","sample_count":826,"has_guide":false},{"cancer_study_identifier":"brca_tcga_pub2015","name":"Breast Invasive Carcinoma (TCGA, Cell 2015)","type_of_cancer_id":"brca","sample_count":819,"has_guide":false},{"cancer_study_identifier":"coadread_tcga","name":"Colorectal Adenocarcinoma (TCGA, Firehose Legacy)","type_of_cancer_id":"coadread","sample_count":641,"has_guide":false},{"cancer_study_identifier":"gbm_tcga","name":"Glioblastoma Multiforme (TCGA, Firehose Legacy)","type_of_cancer_id":"difg","sample_count":620,"has_guide":false},{"cancer_study_identifier":"ov_tcga","name":"Ovarian Serous Cystadenocarcinoma (TCGA, Firehose Legacy)","type_of_cancer_id":"hgsoc","sample_count":618,"has_guide":false},{"cancer_study_identifier":"hgsoc_tcga_gdc","name":"High-Grade Serous Ovarian Cancer (TCGA, GDC)","type_of_cancer_id":"hgsoc","sample_count":618,"has_guide":false},{"cancer_study_identifier":"gbm_tcga_gdc","name":"Glioblastoma Multiforme (TCGA GDC, 2025)","type_of_cancer_id":"difg","sample_count":612,"has_guide":false},{"cancer_study_identifier":"coadread_tcga_pan_can_atlas_2018","name":"Colorectal Adenocarcinoma (TCGA, PanCancer Atlas)","type_of_cancer_id":"coadread","sample_count":595,"has_guide":true},{"cancer_study_identifier":"gbm_tcga_pan_can_atlas_2018","name":"Glioblastoma Multiforme (TCGA, PanCancer Atlas)","type_of_cancer_id":"difg","sample_count":593,"has_guide":true},{"cancer_study_identifier":"luad_tcga_gdc","name":"Lung Adenocarcinoma (TCGA, GDC)","type_of_cancer_id":"luad","sample_count":588,"has_guide":false},{"cancer_study_identifier":"luad_tcga","name":"Lung Adenocarcinoma (TCGA, Firehose Legacy)","type_of_cancer_id":"luad","sample_count":587,"has_guide":false},{"cancer_study_identifier":"ov_tcga_pan_can_atlas_2018","name":"Ovarian Serous Cystadenocarcinoma (TCGA, PanCancer Atlas)","type_of_cancer_id":"hgsoc","sample_count":586,"has_guide":true},{"cancer_study_identifier":"gbm_tcga_pub2013","name":"Glioblastoma (TCGA, Cell 2013)","type_of_cancer_id":"difg","sample_count":578,"has_guide":false},{"cancer_study_identifier":"luad_tcga_pan_can_atlas_2018","name":"Lung Adenocarcinoma (TCGA, PanCancer Atlas)","type_of_cancer_id":"luad","sample_count":567,"has_guide":true},{"cancer_study_identifier":"stes_tcga_pub","name":"Esophageal Carcinoma (TCGA, Nature 2017)","type_of_cancer_id":"egc","sample_count":560,"has_guide":false},{"cancer_study_identifier":"ucec_tcga","name":"Uterine Corpus Endometrial Carcinoma (TCGA, Firehose Legacy)","type_of_cancer_id":"ucec","sample_count":550,"has_guide":false},{"cancer_study_identifier":"ucec_tcga_gdc","name":"Endometrial Carcinoma (TCGA, GDC)","type_of_cancer_id":"ucec","sample_count":550,"has_guide":false},{"cancer_study_identifier":"kirc_tcga","name":"Kidney Renal Clear Cell Carcinoma (TCGA, Firehose Legacy)","type_of_cancer_id":"ccrcc","sample_count":539,"has_guide":false},{"cancer_study_identifier":"ccrcc_tcga_gdc","name":"Renal Clear Cell Carcinoma (TCGA, GDC)","type_of_cancer_id":"ccrcc","sample_count":539,"has_guide":false},{"cancer_study_identifier":"difg_tcga_gdc","name":"Diffuse Glioma (TCGA, GDC)","type_of_cancer_id":"difg","sample_count":533,"has_guide":false},{"cancer_study_identifier":"hnsc_tcga","name":"Head and Neck Squamous Cell Carcinoma (TCGA, Firehose Legacy)","type_of_cancer_id":"hnsc","sample_count":531,"has_guide":false},{"cancer_study_identifier":"lgg_tcga","name":"Brain Lower Grade Glioma (TCGA, Firehose Legacy)","type_of_cancer_id":"difg","sample_count":531,"has_guide":false},{"cancer_study_identifier":"hnsc_tcga_gdc","name":"Head and Neck Squamous Cell Carcinoma (TCGA, GDC)","type_of_cancer_id":"hnsc","sample_count":531,"has_guide":false},{"cancer_study_identifier":"ucec_tcga_pan_can_atlas_2018","name":"Uterine Corpus Endometrial Carcinoma (TCGA, PanCancer Atlas)","type_of_cancer_id":"ucec","sample_count":530,"has_guide":true},{"cancer_study_identifier":"hnsc_tcga_pan_can_atlas_2018","name":"Head and Neck Squamous Cell Carcinoma (TCGA, PanCancer Atlas)","type_of_cancer_id":"hnsc","sample_count":524,"has_guide":false},{"cancer_study_identifier":"thca_tcga","name":"Thyroid Carcinoma (TCGA, Firehose Legacy)","type_of_cancer_id":"thpa","sample_count":517,"has_guide":false},{"cancer_study_identifier":"thpa_tcga_gdc","name":"Papillary Thyroid Cancer (TCGA, GDC)","type_of_cancer_id":"thpa","sample_count":516,"has_guide":false},{"cancer_study_identifier":"lgg_tcga_pan_can_atlas_2018","name":"Brain Lower Grade Glioma (TCGA, PanCancer Atlas)","type_of_cancer_id":"difg","sample_count":515,"has_guide":false},{"cancer_study_identifier":"kirc_tcga_pan_can_atlas_2018","name":"Kidney Renal Clear Cell Carcinoma (TCGA, PanCancer Atlas)","type_of_cancer_id":"ccrcc","sample_count":513,"has_guide":false},{"cancer_study_identifier":"lusc_tcga","name":"Lung Squamous Cell Carcinoma (TCGA, Firehose Legacy)","type_of_cancer_id":"lusc","sample_count":512,"has_guide":false},{"cancer_study_identifier":"lusc_tcga_gdc","name":"Lung Squamous Cell Carcinoma (TCGA, GDC)","type_of_cancer_id":"lusc","sample_count":505,"has_guide":false},{"cancer_study_identifier":"prad_tcga_gdc","name":"Prostate Adenocarcinoma (TCGA, GDC)","type_of_cancer_id":"prad","sample_count":502,"has_guide":false},{"cancer_study_identifier":"prad_tcga","name":"Prostate Adenocarcinoma (TCGA, Firehose Legacy)","type_of_cancer_id":"prad","sample_count":502,"has_guide":false},{"cancer_study_identifier":"thca_tcga_pan_can_atlas_2018","name":"Thyroid Carcinoma (TCGA, PanCancer Atlas)","type_of_cancer_id":"thpa","sample_count":501,"has_guide":false},{"cancer_study_identifier":"thca_tcga_pub","name":"Papillary Thyroid Carcinoma (TCGA, Cell 2014)","type_of_cancer_id":"thpa","sample_count":497,"has_guide":false},{"cancer_study_identifier":"prad_tcga_pan_can_atlas_2018","name":"Prostate Adenocarcinoma (TCGA, PanCancer Atlas)","type_of_cancer_id":"prad","sample_count":495,"has_guide":false},{"cancer_study_identifier":"ov_tcga_pub","name":"Ovarian Serous Cystadenocarcinoma (TCGA, Nature 2011)","type_of_cancer_id":"hgsoc","sample_count":490,"has_guide":false},{"cancer_study_identifier":"lusc_tcga_pan_can_atlas_2018","name":"Lung Squamous Cell Carcinoma (TCGA, PanCancer Atlas)","type_of_cancer_id":"lusc","sample_count":488,"has_guide":false},{"cancer_study_identifier":"skcm_tcga","name":"Skin Cutaneous Melanoma (TCGA, Firehose Legacy)","type_of_cancer_id":"skcm","sample_count":481,"has_guide":false},{"cancer_study_identifier":"stad_tcga","name":"Stomach Adenocarcinoma (TCGA, Firehose Legacy)","type_of_cancer_id":"stad","sample_count":479,"has_guide":false},{"cancer_study_identifier":"blca_msk_tcga_2020","name":"Bladder Cancer (MSK/TCGA, 2020)","type_of_cancer_id":"blca","sample_count":477,"has_guide":false},{"cancer_study_identifier":"skcm_tcga_gdc","name":"Cutaneous Melanoma (TCGA, GDC)","type_of_cancer_id":"skcm","sample_count":475,"has_guide":false},{"cancer_study_identifier":"coad_tcga_gdc","name":"Colon Adenocarcinoma (TCGA, GDC)","type_of_cancer_id":"coad","sample_count":465,"has_guide":false},{"cancer_study_identifier":"skcm_tcga_pan_can_atlas_2018","name":"Skin Cutaneous Melanoma (TCGA, PanCancer Atlas)","type_of_cancer_id":"skcm","sample_count":449,"has_guide":false},{"cancer_study_identifier":"kirc_tcga_pub","name":"Kidney Renal Clear Cell Carcinoma (TCGA, Nature 2013)","type_of_cancer_id":"ccrcc","sample_count":447,"has_guide":false}]
```


Great! I can see there are multiple TCGA PanCancer Atlas studies. Let me check what tables are available and look for mRNA expression data.



Calling `clickhouse_list_tables` with args:
```json
{}
```



Result from `clickhouse_list_tables`:
```json
{"tables":[{"name":"allele_specific_copy_number","total_rows":0,"comment":"Allele-specific CNA data for mutations. References mutation_event, genetic_profile, and sample."},{"name":"alteration_driver_annotation","total_rows":37356,"comment":"Annotations for genetic alterations classified as potential drivers. References genetic_profile and sample."},{"name":"cancer_study","total_rows":511,"comment":"Contains metadata for each cancer study in the portal. References type_of_cancer and reference_genome."},{"name":"cancer_study_tags","total_rows":0,"comment":"Tags associated with a cancer study. References cancer_study."},{"name":"clinical_attribute_meta","total_rows":18230,"comment":"Metadata describing clinical attributes. References cancer_study."},{"name":"clinical_data_derived","primary_key":"cancer_study_identifier, type, attribute_name, sample_unique_id","total_rows":11763690,"comment":"Unified clinical data table combining both patient-level and sample-level clinical attributes in a normalized key-value format. Uses FULL OUTER JOIN to ensure all defined clinical attributes appear for each patient/sample, even when no value is recorded (populated with empty string). Enables efficient querying of clinical data across different attribute types and levels."},{"name":"clinical_event","total_rows":2643379,"comment":"Time-bound clinical events for patients. References patient."},{"name":"clinical_event_data","total_rows":14395558,"comment":"Key-value attributes for clinical events. References clinical_event."},{"name":"clinical_event_derived","primary_key":"cancer_study_identifier, event_type, patient_unique_id","total_rows":14422476,"comment":"Denormalized clinical timeline events table combining temporal clinical events with their associated key-value attributes. Each row represents a specific attribute of a clinical event (e.g., treatment, surgery, specimen collection) with start/stop dates. Flattens the normalized clinical_event and clinical_event_data relationship into a queryable format for timeline analysis."},{"name":"clinical_patient","total_rows":4157292,"comment":"Patient-level clinical attribute values. References patient."},{"name":"clinical_sample","total_rows":5323875,"comment":"Sample-level clinical attribute values. References sample."},{"name":"cna_event","total_rows":77018,"comment":"Copy number alteration event definition. References gene."},{"name":"copy_number_seg","total_rows":28149618,"comment":"Raw segmented copy number data. References cancer_study and sample."},{"name":"copy_number_seg_file","total_rows":292,"comment":"File metadata for segmented copy number input. References cancer_study."},{"name":"gene","total_rows":46303,"comment":"Gene metadata (Entrez ID, HUGO symbol). References genetic_entity."},{"name":"gene_alias","total_rows":75207,"comment":"Alternative symbols/aliases for genes. References gene."},{"name":"gene_panel","total_rows":58,"comment":"Defines a targeted gene panel used in sequencing."},{"name":"gene_panel_list","total_rows":21477,"comment":"Join table linking gene panels to genes. References gene_panel and gene."},{"name":"generic_assay_data_derived","primary_key":"profile_type, entity_stable_id, patient_unique_id, sample_unique_id","total_rows":394482832,"comment":"Denormalized generic assay data table that unpivots wide-format genetic_alteration values for generic assay profiles into a long-format structure. Handles diverse assay types like treatment response, phosphosite quantification, and other non-genomic measurements. Each row represents one entity-sample combination with its measured value. Supports both sample-level and patient-level data based on profile configuration."},{"name":"generic_entity_properties","total_rows":2490012,"comment":"Properties for generic entities. References genetic_entity."},{"name":"geneset","total_rows":34837,"comment":"Collection of genes grouped into functional sets. References genetic_entity."},{"name":"geneset_gene","total_rows":8050756,"comment":"Join table linking genesets to genes. References geneset and gene."},{"name":"geneset_hierarchy_leaf","total_rows":0,"comment":"Mapping of hierarchy nodes to specific gene sets. References geneset_hierarchy_node and geneset."},{"name":"geneset_hierarchy_node","total_rows":0,"comment":"Hierarchy node for organizing gene sets. May reference parent node within same table."},{"name":"genetic_alteration","primary_key":"genetic_profile_id, genetic_entity_id","total_rows":33488996,"comment":"Stores genetic alteration values (for many genetic alteration types. e.g. MRNA_EXPRESSION, PROTEIN_LEVEL, GENERIC_ASSAY,...). References genetic_profile and genetic_entity."},{"name":"genetic_alteration_derived","primary_key":"cancer_study_identifier, hugo_gene_symbol, profile_type, sample_unique_id","total_rows":10133300301,"comment":"Denormalized genetic alteration data table that unpivots the wide-format genetic_alteration values into a long-format structure. Each row represents one gene-sample-profile combination with its alteration value. Excludes mutation data (handled separately) and generic assays, focusing on continuous/discrete data like expression, methylation, and copy number. Filters out \"NA\" values to reduce storage and improve query performance."},{"name":"genetic_entity","total_rows":2508068,"comment":"Abstract entity representing a gene, gene set, or other genomic element."},{"name":"genetic_profile","total_rows":2405,"comment":"Defines a molecular profile (e.g. mutations, CNA, mRNA expression). References cancer_study."},{"name":"genetic_profile_link","total_rows":2,"comment":"Links between genetic profiles. References genetic_profile (source and target)."},{"name":"genetic_profile_samples","total_rows":1896,"comment":"Stores ordered sample lists for a genetic profile (for many genetic alteration types. e.g. MRNA_EXPRESSION, PROTEIN_LEVEL, GENERIC_ASSAY,...). References genetic_profile."},{"name":"genomic_event_derived","primary_key":"genetic_profile_stable_id, cancer_study_identifier, variant_type, entrez_gene_id, hugo_gene_symbol, sample_unique_id","total_rows":48903328,"comment":"Unified genomic events table combining mutations, copy number alterations (CNA), and structural variants into a single denormalized view. Each row represents a gene-level genomic event observed in a sample. Structural variants are split into separate rows for site1 and site2 genes (excluding duplicates). Includes off-panel detection to identify events in genes not covered by the associated gene panel."},{"name":"gistic","total_rows":3547,"comment":"GISTIC-identified copy number alteration regions. References cancer_study."},{"name":"gistic_to_gene","total_rows":204806,"comment":"Mapping of GISTIC regions to genes. References gistic and gene."},{"name":"info","total_rows":1},{"name":"mut_sig","total_rows":2850,"comment":"MutSig significance analysis results. References cancer_study and gene."},{"name":"mutation","primary_key":"genetic_profile_id, entrez_gene_id","total_rows":17774534,"comment":"Mutation observations in specific samples and profiles. References mutation_event, gene, genetic_profile, and sample."},{"name":"mutation_count_by_keyword","total_rows":12451447,"comment":"Stores keyword-based aggregated mutation counts. References genetic_profile and gene."},{"name":"mutation_event","total_rows":8850403,"comment":"Defines unique mutation events (by position, gene, allele change). References gene."},{"name":"patient","total_rows":320721,"comment":"Stores patient-level identifiers of patients enrolled in a cancer study. References cancer_study."},{"name":"reference_genome","total_rows":3,"comment":"Reference genome definitions (e.g. hg19, GRCh38)."},{"name":"reference_genome_gene","total_rows":84612,"comment":"Mapping of reference genome builds to genes. References reference_genome and gene."},{"name":"resource_definition","total_rows":43,"comment":"Definitions of external resources (study, patient, sample level). References cancer_study."},{"name":"resource_patient","total_rows":10471,"comment":"Links external resources to patients. References patient."},{"name":"resource_sample","total_rows":3711,"comment":"Links external resources to samples. References sample."},{"name":"resource_study","total_rows":0,"comment":"Links external resources to cancer studies. References cancer_study."},{"name":"sample","total_rows":336873,"comment":"Biological samples collected from patients. References patient."},{"name":"sample_cna_event","primary_key":"genetic_profile_id, cna_event_id, sample_id","total_rows":30879655,"comment":"Observed CNA events per sample and profile. References cna_event, sample, and genetic_profile."},{"name":"sample_derived","primary_key":"cancer_study_identifier, sample_unique_id","total_rows":336873,"comment":"Denormalized sample table with globally unique identifiers and enriched metadata. Combines sample, patient, and cancer_study data with computed flags for sequencing status and copy number segment availability. Optimized for summary and detailed projections with base64-encoded identifiers for URL-safe usage."},{"name":"sample_list","total_rows":2727,"comment":"Named collections of samples within a study. References cancer_study."},{"name":"sample_list_list","total_rows":1452133,"comment":"Join table linking sample lists to samples. References sample and sample_list."},{"name":"sample_profile","total_rows":1090903,"comment":"Links samples to genetic profiles, optionally via a gene panel. References sample, genetic_profile, and gene_panel."},{"name":"sample_to_gene_panel_derived","primary_key":"gene_panel_id, alteration_type, genetic_profile_id, sample_unique_id","total_rows":1090903,"comment":"Denormalized mapping table linking samples to their associated gene panels for each genetic alteration type. Derived from sample_profile, genetic_profile, gene_panel, sample, and cancer_study tables. Defaults to WES (Whole Exome Sequencing) when no specific gene panel is assigned."},{"name":"structural_variant","total_rows":148760,"comment":"Structural variant data (fusions, translocations). References genetic_profile, sample, and gene (site1/site2)."},{"name":"type_of_cancer","total_rows":898,"comment":"Lookup table for cancer types."}]}
```


Perfect! I can see there's a `genetic_alteration_derived` table that contains mRNA expression data. Let me query ERBB2 mRNA expression across different TCGA PanCancer Atlas studies.



Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\nSELECT \n    cancer_study_identifier,\n    COUNT(DISTINCT sample_unique_id) as sample_count,\n    AVG(CAST(value AS Float64)) as mean_expression,\n    median(CAST(value AS Float64)) as median_expression,\n    min(CAST(value AS Float64)) as min_expression,\n    max(CAST(value AS Float64)) as max_expression,\n    stddevPop(CAST(value AS Float64)) as std_dev\nFROM genetic_alteration_derived\nWHERE hugo_gene_symbol = 'ERBB2'\n    AND profile_type = 'MRNA_EXPRESSION'\n    AND cancer_study_identifier LIKE '%pan_can_atlas_2018'\n    AND value != 'NA'\nGROUP BY cancer_study_identifier\nORDER BY mean_expression DESC\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"error_message":"Query execution failed: Received ClickHouse exception, code: 47, server response: Code: 47. DB::Exception: Unknown expression or function identifier `value` in scope SELECT cancer_study_identifier, COUNTDistinct(sample_unique_id) AS sample_count, AVG(CAST(value, 'Float64')) AS mean_expression, median(CAST(value, 'Float64')) AS median_expression, min(CAST(value, 'Float64')) AS min_expression, max(CAST(value, 'Float64')) AS max_expression, stddevPop(CAST(value, 'Float64')) AS std_dev FROM genetic_alteration_derived WHERE (hugo_gene_symbol = 'ERBB2') AND (profile_type = 'MRNA_EXPRESSION') AND (cancer_study_identifier LIKE '%pan_can_atlas_2018') AND (value != 'NA') GROUP BY cancer_study_identifier ORDER BY mean_expression DESC. (UNKNOWN_IDENTIFIER) (version 25.8.1.36912 (official build)) (for url https://dl96orhu96.us-east-1.aws.clickhouse.cloud:8443)"}
```


Let me check the column names in the genetic_alteration_derived table:



Calling `clickhouse_list_table_columns` with args:
```json
{
  "table": "genetic_alteration_derived"
}
```



Result from `clickhouse_list_table_columns`:
```json
{"columns":[{"name":"sample_unique_id","type":"String","comment":"Globally unique sample identifier constructed as cancer_study_identifier + \"_\" + sample.stable_id to ensure uniqueness across all studies."},{"name":"cancer_study_identifier","type":"LowCardinality(String)","comment":"Stable string identifier for the cancer study. References cancer_study.cancer_study_identifier."},{"name":"hugo_gene_symbol","type":"String","comment":"Official HUGO gene symbol for the gene being measured. References gene.hugo_gene_symbol."},{"name":"profile_type","type":"LowCardinality(String)","comment":"Type of genetic profile with study prefix removed (e.g., \"mrna_expression\", \"cna_discrete\", \"methylation\"). Derived from genetic_profile.stable_id by removing the cancer_study_identifier prefix."},{"name":"alteration_value","type":"Nullable(String)","comment":"The actual genetic alteration measurement value (e.g., expression level, methylation beta value, copy number). NULL when no measurement available. Excludes \"NA\" values which are filtered out during insertion."}]}
```


Now I see - the column is called `alteration_value`, not `value`. Let me also check what profile types are available:



Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\nSELECT DISTINCT profile_type\nFROM genetic_alteration_derived\nWHERE hugo_gene_symbol = 'ERBB2'\n    AND cancer_study_identifier LIKE '%pan_can_atlas_2018'\nLIMIT 20\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"profile_type":"gistic"},{"profile_type":"log2CNA"},{"profile_type":"rna_seq_v2_mrna"},{"profile_type":"rna_seq_v2_mrna_median_Zscores"},{"profile_type":"rna_seq_v2_mrna_median_all_sample_Zscores"},{"profile_type":"rppa"},{"profile_type":"rppa_Zscores"},{"profile_type":"rna_seq_v2_mrna_median_all_sample_ref_normal_Zscores"},{"profile_type":"protein_quantification"},{"profile_type":"protein_quantification_zscores"}]}
```


Great! I can see the mRNA expression data is in `rna_seq_v2_mrna`. Let me now query ERBB2 mRNA expression across different TCGA PanCancer Atlas studies:



Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\nSELECT \n    cancer_study_identifier,\n    COUNT(DISTINCT sample_unique_id) as sample_count,\n    ROUND(AVG(CAST(alteration_value AS Float64)), 3) as mean_expression,\n    ROUND(median(CAST(alteration_value AS Float64)), 3) as median_expression,\n    ROUND(min(CAST(alteration_value AS Float64)), 3) as min_expression,\n    ROUND(max(CAST(alteration_value AS Float64)), 3) as max_expression,\n    ROUND(stddevPop(CAST(alteration_value AS Float64)), 3) as std_dev\nFROM genetic_alteration_derived\nWHERE hugo_gene_symbol = 'ERBB2'\n    AND profile_type = 'rna_seq_v2_mrna'\n    AND cancer_study_identifier LIKE '%pan_can_atlas_2018'\n    AND alteration_value IS NOT NULL\nGROUP BY cancer_study_identifier\nORDER BY mean_expression DESC\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"cancer_study_identifier":"brca_tcga_pan_can_atlas_2018","sample_count":1082,"mean_expression":18181.49,"median_expression":7025.295,"min_expression":154.854,"max_expression":380668.0,"std_dev":39606.14},{"cancer_study_identifier":"stad_tcga_pan_can_atlas_2018","sample_count":412,"mean_expression":15151.161,"median_expression":4249.661,"min_expression":160.476,"max_expression":415387.095,"std_dev":45969.818},{"cancer_study_identifier":"esca_tcga_pan_can_atlas_2018","sample_count":181,"mean_expression":13738.1,"median_expression":3778.919,"min_expression":299.781,"max_expression":401888.781,"std_dev":43611.163},{"cancer_study_identifier":"blca_tcga_pan_can_atlas_2018","sample_count":407,"mean_expression":13628.448,"median_expression":7514.38,"min_expression":443.726,"max_expression":307567.0,"std_dev":30638.025},{"cancer_study_identifier":"cesc_tcga_pan_can_atlas_2018","sample_count":294,"mean_expression":11341.8,"median_expression":4534.095,"min_expression":671.495,"max_expression":431024.0,"std_dev":38485.922},{"cancer_study_identifier":"ucec_tcga_pan_can_atlas_2018","sample_count":527,"mean_expression":8972.361,"median_expression":4853.23,"min_expression":200.762,"max_expression":358261.0,"std_dev":26815.9},{"cancer_study_identifier":"coadread_tcga_pan_can_atlas_2018","sample_count":592,"mean_expression":7955.812,"median_expression":4695.852,"min_expression":542.339,"max_expression":511917.0,"std_dev":26692.164},{"cancer_study_identifier":"luad_tcga_pan_can_atlas_2018","sample_count":510,"mean_expression":7780.428,"median_expression":6104.52,"min_expression":353.44,"max_expression":262936.0,"std_dev":14410.396},{"cancer_study_identifier":"kirp_tcga_pan_can_atlas_2018","sample_count":283,"mean_expression":7109.871,"median_expression":6622.07,"min_expression":841.961,"max_expression":25050.9,"std_dev":3169.888},{"cancer_study_identifier":"ucs_tcga_pan_can_atlas_2018","sample_count":57,"mean_expression":6961.146,"median_expression":4555.36,"min_expression":1005.86,"max_expression":72554.7,"std_dev":9688.138},{"cancer_study_identifier":"thca_tcga_pan_can_atlas_2018","sample_count":498,"mean_expression":6939.482,"median_expression":6700.8,"min_expression":1750.57,"max_expression":15358.2,"std_dev":2334.557},{"cancer_study_identifier":"paad_tcga_pan_can_atlas_2018","sample_count":177,"mean_expression":6472.721,"median_expression":4992.93,"min_expression":289.874,"max_expression":233627.0,"std_dev":17332.558},{"cancer_study_identifier":"ov_tcga_pan_can_atlas_2018","sample_count":300,"mean_expression":6216.42,"median_expression":4049.575,"min_expression":1211.918,"max_expression":281396.848,"std_dev":18674.384},{"cancer_study_identifier":"prad_tcga_pan_can_atlas_2018","sample_count":493,"mean_expression":6009.665,"median_expression":5518.56,"min_expression":629.63,"max_expression":110785.0,"std_dev":5101.438},{"cancer_study_identifier":"chol_tcga_pan_can_atlas_2018","sample_count":36,"mean_expression":5189.739,"median_expression":5469.645,"min_expression":128.056,"max_expression":9980.41,"std_dev":2380.857},{"cancer_study_identifier":"kich_tcga_pan_can_atlas_2018","sample_count":65,"mean_expression":4898.763,"median_expression":4552.73,"min_expression":406.97,"max_expression":12264.7,"std_dev":2378.938},{"cancer_study_identifier":"hnsc_tcga_pan_can_atlas_2018","sample_count":515,"mean_expression":4628.341,"median_expression":3310.02,"min_expression":591.561,"max_expression":244889.0,"std_dev":12571.053},{"cancer_study_identifier":"lusc_tcga_pan_can_atlas_2018","sample_count":484,"mean_expression":3986.995,"median_expression":2710.875,"min_expression":320.309,"max_expression":278328.0,"std_dev":13442.292},{"cancer_study_identifier":"meso_tcga_pan_can_atlas_2018","sample_count":87,"mean_expression":3096.242,"median_expression":2697.86,"min_expression":704.572,"max_expression":7399.82,"std_dev":1433.16},{"cancer_study_identifier":"lihc_tcga_pan_can_atlas_2018","sample_count":366,"mean_expression":2797.103,"median_expression":2229.3,"min_expression":69.988,"max_expression":18495.8,"std_dev":2431.738},{"cancer_study_identifier":"kirc_tcga_pan_can_atlas_2018","sample_count":510,"mean_expression":2758.213,"median_expression":2553.03,"min_expression":190.544,"max_expression":8699.15,"std_dev":1326.788},{"cancer_study_identifier":"tgct_tcga_pan_can_atlas_2018","sample_count":149,"mean_expression":2594.417,"median_expression":1966.71,"min_expression":443.079,"max_expression":12233.8,"std_dev":2018.696},{"cancer_study_identifier":"uvm_tcga_pan_can_atlas_2018","sample_count":80,"mean_expression":2039.056,"median_expression":1699.775,"min_expression":915.385,"max_expression":5748.87,"std_dev":948.486},{"cancer_study_identifier":"sarc_tcga_pan_can_atlas_2018","sample_count":253,"mean_expression":1619.653,"median_expression":1380.63,"min_expression":22.371,"max_expression":9313.32,"std_dev":1251.337},{"cancer_study_identifier":"skcm_tcga_pan_can_atlas_2018","sample_count":443,"mean_expression":1516.84,"median_expression":1340.88,"min_expression":70.451,"max_expression":8337.67,"std_dev":1052.21},{"cancer_study_identifier":"gbm_tcga_pan_can_atlas_2018","sample_count":160,"mean_expression":1309.695,"median_expression":1160.83,"min_expression":97.328,"max_expression":5208.08,"std_dev":880.143},{"cancer_study_identifier":"thym_tcga_pan_can_atlas_2018","sample_count":119,"mean_expression":1229.628,"median_expression":794.908,"min_expression":104.245,"max_expression":8314.26,"std_dev":1277.735},{"cancer_study_identifier":"lgg_tcga_pan_can_atlas_2018","sample_count":514,"mean_expression":806.471,"median_expression":639.473,"min_expression":126.746,"max_expression":5170.33,"std_dev":596.036},{"cancer_study_identifier":"dlbc_tcga_pan_can_atlas_2018","sample_count":48,"mean_expression":311.939,"median_expression":232.873,"min_expression":62.052,"max_expression":2949.39,"std_dev":404.388},{"cancer_study_identifier":"pcpg_tcga_pan_can_atlas_2018","sample_count":178,"mean_expression":283.826,"median_expression":236.408,"min_expression":48.679,"max_expression":992.863,"std_dev":169.289},{"cancer_study_identifier":"acc_tcga_pan_can_atlas_2018","sample_count":78,"mean_expression":275.059,"median_expression":165.58,"min_expression":49.818,"max_expression":1579.78,"std_dev":300.778},{"cancer_study_identifier":"laml_tcga_pan_can_atlas_2018","sample_count":173,"mean_expression":84.688,"median_expression":69.623,"min_expression":12.389,"max_expression":303.282,"std_dev":53.965}]}
```


Excellent! Now let me also get the cancer type names to make the results more interpretable:



Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\nSELECT \n    cs.cancer_study_identifier,\n    cs.name as study_name,\n    COUNT(DISTINCT gad.sample_unique_id) as sample_count,\n    ROUND(AVG(CAST(gad.alteration_value AS Float64)), 2) as mean_expression,\n    ROUND(median(CAST(gad.alteration_value AS Float64)), 2) as median_expression,\n    ROUND(min(CAST(gad.alteration_value AS Float64)), 2) as min_expression,\n    ROUND(max(CAST(gad.alteration_value AS Float64)), 2) as max_expression,\n    ROUND(stddevPop(CAST(gad.alteration_value AS Float64)), 2) as std_dev\nFROM genetic_alteration_derived gad\nJOIN cancer_study cs ON gad.cancer_study_identifier = cs.cancer_study_identifier\nWHERE gad.hugo_gene_symbol = 'ERBB2'\n    AND gad.profile_type = 'rna_seq_v2_mrna'\n    AND gad.cancer_study_identifier LIKE '%pan_can_atlas_2018'\n    AND gad.alteration_value IS NOT NULL\nGROUP BY cs.cancer_study_identifier, cs.name\nORDER BY mean_expression DESC\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"cs.cancer_study_identifier":"brca_tcga_pan_can_atlas_2018","study_name":"Breast Invasive Carcinoma (TCGA, PanCancer Atlas)","sample_count":1082,"mean_expression":18181.49,"median_expression":7025.3,"min_expression":154.85,"max_expression":380668.0,"std_dev":39606.14},{"cs.cancer_study_identifier":"stad_tcga_pan_can_atlas_2018","study_name":"Stomach Adenocarcinoma (TCGA, PanCancer Atlas)","sample_count":412,"mean_expression":15151.16,"median_expression":4249.66,"min_expression":160.48,"max_expression":415387.1,"std_dev":45969.82},{"cs.cancer_study_identifier":"esca_tcga_pan_can_atlas_2018","study_name":"Esophageal Adenocarcinoma (TCGA, PanCancer Atlas)","sample_count":181,"mean_expression":13738.1,"median_expression":3778.92,"min_expression":299.78,"max_expression":401888.78,"std_dev":43611.16},{"cs.cancer_study_identifier":"blca_tcga_pan_can_atlas_2018","study_name":"Bladder Urothelial Carcinoma (TCGA, PanCancer Atlas)","sample_count":407,"mean_expression":13628.45,"median_expression":7514.38,"min_expression":443.73,"max_expression":307567.0,"std_dev":30638.03},{"cs.cancer_study_identifier":"cesc_tcga_pan_can_atlas_2018","study_name":"Cervical Squamous Cell Carcinoma (TCGA, PanCancer Atlas)","sample_count":294,"mean_expression":11341.8,"median_expression":4534.1,"min_expression":671.5,"max_expression":431024.0,"std_dev":38485.92},{"cs.cancer_study_identifier":"ucec_tcga_pan_can_atlas_2018","study_name":"Uterine Corpus Endometrial Carcinoma (TCGA, PanCancer Atlas)","sample_count":527,"mean_expression":8972.36,"median_expression":4853.23,"min_expression":200.76,"max_expression":358261.0,"std_dev":26815.9},{"cs.cancer_study_identifier":"coadread_tcga_pan_can_atlas_2018","study_name":"Colorectal Adenocarcinoma (TCGA, PanCancer Atlas)","sample_count":592,"mean_expression":7955.81,"median_expression":4695.85,"min_expression":542.34,"max_expression":511917.0,"std_dev":26692.16},{"cs.cancer_study_identifier":"luad_tcga_pan_can_atlas_2018","study_name":"Lung Adenocarcinoma (TCGA, PanCancer Atlas)","sample_count":510,"mean_expression":7780.43,"median_expression":6104.52,"min_expression":353.44,"max_expression":262936.0,"std_dev":14410.4},{"cs.cancer_study_identifier":"kirp_tcga_pan_can_atlas_2018","study_name":"Kidney Renal Papillary Cell Carcinoma (TCGA, PanCancer Atlas)","sample_count":283,"mean_expression":7109.87,"median_expression":6622.07,"min_expression":841.96,"max_expression":25050.9,"std_dev":3169.89},{"cs.cancer_study_identifier":"ucs_tcga_pan_can_atlas_2018","study_name":"Uterine Carcinosarcoma (TCGA, PanCancer Atlas)","sample_count":57,"mean_expression":6961.15,"median_expression":4555.36,"min_expression":1005.86,"max_expression":72554.7,"std_dev":9688.14},{"cs.cancer_study_identifier":"thca_tcga_pan_can_atlas_2018","study_name":"Thyroid Carcinoma (TCGA, PanCancer Atlas)","sample_count":498,"mean_expression":6939.48,"median_expression":6700.8,"min_expression":1750.57,"max_expression":15358.2,"std_dev":2334.56},{"cs.cancer_study_identifier":"paad_tcga_pan_can_atlas_2018","study_name":"Pancreatic Adenocarcinoma (TCGA, PanCancer Atlas)","sample_count":177,"mean_expression":6472.72,"median_expression":4992.93,"min_expression":289.87,"max_expression":233627.0,"std_dev":17332.56},{"cs.cancer_study_identifier":"ov_tcga_pan_can_atlas_2018","study_name":"Ovarian Serous Cystadenocarcinoma (TCGA, PanCancer Atlas)","sample_count":300,"mean_expression":6216.42,"median_expression":4049.58,"min_expression":1211.92,"max_expression":281396.85,"std_dev":18674.38},{"cs.cancer_study_identifier":"prad_tcga_pan_can_atlas_2018","study_name":"Prostate Adenocarcinoma (TCGA, PanCancer Atlas)","sample_count":493,"mean_expression":6009.66,"median_expression":5518.56,"min_expression":629.63,"max_expression":110785.0,"std_dev":5101.44},{"cs.cancer_study_identifier":"chol_tcga_pan_can_atlas_2018","study_name":"Cholangiocarcinoma (TCGA, PanCancer Atlas)","sample_count":36,"mean_expression":5189.74,"median_expression":5469.64,"min_expression":128.06,"max_expression":9980.41,"std_dev":2380.86},{"cs.cancer_study_identifier":"kich_tcga_pan_can_atlas_2018","study_name":"Kidney Chromophobe (TCGA, PanCancer Atlas)","sample_count":65,"mean_expression":4898.76,"median_expression":4552.73,"min_expression":406.97,"max_expression":12264.7,"std_dev":2378.94},{"cs.cancer_study_identifier":"hnsc_tcga_pan_can_atlas_2018","study_name":"Head and Neck Squamous Cell Carcinoma (TCGA, PanCancer Atlas)","sample_count":515,"mean_expression":4628.34,"median_expression":3310.02,"min_expression":591.56,"max_expression":244889.0,"std_dev":12571.05},{"cs.cancer_study_identifier":"lusc_tcga_pan_can_atlas_2018","study_name":"Lung Squamous Cell Carcinoma (TCGA, PanCancer Atlas)","sample_count":484,"mean_expression":3987.0,"median_expression":2710.88,"min_expression":320.31,"max_expression":278328.0,"std_dev":13442.29},{"cs.cancer_study_identifier":"meso_tcga_pan_can_atlas_2018","study_name":"Mesothelioma (TCGA, PanCancer Atlas)","sample_count":87,"mean_expression":3096.24,"median_expression":2697.86,"min_expression":704.57,"max_expression":7399.82,"std_dev":1433.16},{"cs.cancer_study_identifier":"lihc_tcga_pan_can_atlas_2018","study_name":"Liver Hepatocellular Carcinoma (TCGA, PanCancer Atlas)","sample_count":366,"mean_expression":2797.1,"median_expression":2229.3,"min_expression":69.99,"max_expression":18495.8,"std_dev":2431.74},{"cs.cancer_study_identifier":"kirc_tcga_pan_can_atlas_2018","study_name":"Kidney Renal Clear Cell Carcinoma (TCGA, PanCancer Atlas)","sample_count":510,"mean_expression":2758.21,"median_expression":2553.03,"min_expression":190.54,"max_expression":8699.15,"std_dev":1326.79},{"cs.cancer_study_identifier":"tgct_tcga_pan_can_atlas_2018","study_name":"Testicular Germ Cell Tumors (TCGA, PanCancer Atlas)","sample_count":149,"mean_expression":2594.42,"median_expression":1966.71,"min_expression":443.08,"max_expression":12233.8,"std_dev":2018.7},{"cs.cancer_study_identifier":"uvm_tcga_pan_can_atlas_2018","study_name":"Uveal Melanoma (TCGA, PanCancer Atlas)","sample_count":80,"mean_expression":2039.06,"median_expression":1699.78,"min_expression":915.38,"max_expression":5748.87,"std_dev":948.49},{"cs.cancer_study_identifier":"sarc_tcga_pan_can_atlas_2018","study_name":"Sarcoma (TCGA, PanCancer Atlas)","sample_count":253,"mean_expression":1619.65,"median_expression":1380.63,"min_expression":22.37,"max_expression":9313.32,"std_dev":1251.34},{"cs.cancer_study_identifier":"skcm_tcga_pan_can_atlas_2018","study_name":"Skin Cutaneous Melanoma (TCGA, PanCancer Atlas)","sample_count":443,"mean_expression":1516.84,"median_expression":1340.88,"min_expression":70.45,"max_expression":8337.67,"std_dev":1052.21},{"cs.cancer_study_identifier":"gbm_tcga_pan_can_atlas_2018","study_name":"Glioblastoma Multiforme (TCGA, PanCancer Atlas)","sample_count":160,"mean_expression":1309.7,"median_expression":1160.83,"min_expression":97.33,"max_expression":5208.08,"std_dev":880.14},{"cs.cancer_study_identifier":"thym_tcga_pan_can_atlas_2018","study_name":"Thymoma (TCGA, PanCancer Atlas)","sample_count":119,"mean_expression":1229.63,"median_expression":794.91,"min_expression":104.24,"max_expression":8314.26,"std_dev":1277.73},{"cs.cancer_study_identifier":"lgg_tcga_pan_can_atlas_2018","study_name":"Brain Lower Grade Glioma (TCGA, PanCancer Atlas)","sample_count":514,"mean_expression":806.47,"median_expression":639.47,"min_expression":126.75,"max_expression":5170.33,"std_dev":596.04},{"cs.cancer_study_identifier":"dlbc_tcga_pan_can_atlas_2018","study_name":"Diffuse Large B-Cell Lymphoma (TCGA, PanCancer Atlas)","sample_count":48,"mean_expression":311.94,"median_expression":232.87,"min_expression":62.05,"max_expression":2949.39,"std_dev":404.39},{"cs.cancer_study_identifier":"pcpg_tcga_pan_can_atlas_2018","study_name":"Pheochromocytoma and Paraganglioma (TCGA, PanCancer Atlas)","sample_count":178,"mean_expression":283.83,"median_expression":236.41,"min_expression":48.68,"max_expression":992.86,"std_dev":169.29},{"cs.cancer_study_identifier":"acc_tcga_pan_can_atlas_2018","study_name":"Adrenocortical Carcinoma (TCGA, PanCancer Atlas)","sample_count":78,"mean_expression":275.06,"median_expression":165.58,"min_expression":49.82,"max_expression":1579.78,"std_dev":300.78},{"cs.cancer_study_identifier":"laml_tcga_pan_can_atlas_2018","study_name":"Acute Myeloid Leukemia (TCGA, PanCancer Atlas)","sample_count":173,"mean_expression":84.69,"median_expression":69.62,"min_expression":12.39,"max_expression":303.28,"std_dev":53.96}]}
```


Perfect! Now let me create a summary visualization of the top cancer types with highest ERBB2 expression:

## ERBB2 mRNA Expression Across TCGA Pan-Cancer Atlas Studies

I've analyzed ERBB2 (HER2) mRNA expression across **32 different cancer types** from the TCGA Pan-Cancer Atlas studies. Here are the key findings:

### **Top 10 Cancer Types with Highest ERBB2 Expression:**

| Rank | Cancer Type | Sample Count | Mean Expression | Median Expression | Std Dev |
|------|-------------|--------------|-----------------|-------------------|---------|
| 1 | **Breast Invasive Carcinoma** | 1,082 | 18,181.49 | 7,025.30 | 39,606.14 |
| 2 | **Stomach Adenocarcinoma** | 412 | 15,151.16 | 4,249.66 | 45,969.82 |
| 3 | **Esophageal Adenocarcinoma** | 181 | 13,738.10 | 3,778.92 | 43,611.16 |
| 4 | **Bladder Urothelial Carcinoma** | 407 | 13,628.45 | 7,514.38 | 30,638.03 |
| 5 | **Cervical Squamous Cell Carcinoma** | 294 | 11,341.80 | 4,534.10 | 38,485.92 |
| 6 | **Uterine Corpus Endometrial Carcinoma** | 527 | 8,972.36 | 4,853.23 | 26,815.90 |
| 7 | **Colorectal Adenocarcinoma** | 592 | 7,955.81 | 4,695.85 | 26,692.16 |
| 8 | **Lung Adenocarcinoma** | 510 | 7,780.43 | 6,104.52 | 14,410.40 |
| 9 | **Kidney Renal Papillary Cell Carcinoma** | 283 | 7,109.87 | 6,622.07 | 3,169.89 |
| 10 | **Uterine Carcinosarcoma** | 57 | 6,961.15 | 4,555.36 | 9,688.14 |

### **Bottom 5 Cancer Types with Lowest ERBB2 Expression:**

| Rank | Cancer Type | Sample Count | Mean Expression | Median Expression |
|------|-------------|--------------|-----------------|-------------------|
| 28 | Brain Lower Grade Glioma | 514 | 806.47 | 639.47 |
| 29 | Diffuse Large B-Cell Lymphoma | 48 | 311.94 | 232.87 |
| 30 | Pheochromocytoma and Paraganglioma | 178 | 283.83 | 236.41 |
| 31 | Adrenocortical Carcinoma | 78 | 275.06 | 165.58 |
| 32 | **Acute Myeloid Leukemia** | 173 | **84.69** | **69.62** |

### **Key Observations:**

1. **Breast cancer shows the highest ERBB2 expression** (mean: 18,181), which is clinically significant as ERBB2/HER2 is a well-known therapeutic target in breast cancer.

2. **Gastrointestinal cancers** (stomach, esophageal, colorectal) show elevated ERBB2 expression, consistent with known HER2-positive subsets in these cancers.

3. **Wide variability within cancer types**: The high standard deviations (especially in breast, stomach, and esophageal cancers) indicate substantial heterogeneity, likely reflecting HER2-positive and HER2-negative subgroups.

4. **Brain tumors and hematologic malignancies** show the lowest ERBB2 expression,

---

## Model Information
- **model**: us.anthropic.claude-sonnet-4-5-20250929-v1:0
- **temperature**: 0.0
- **max_output_tokens**: 1024
- **thinking_enabled**: False
- **thinking_budget_tokens**: 1024
- **response_time_seconds**: 47.061684462009
- **agent_type**: mcp-clickhouse

### Usage
- **input_tokens**: 83506
- **output_tokens**: 2561
- **total_tokens**: 86067
- **cache_creation_input_tokens**: 0
- **cache_read_input_tokens**: 0

---

*Generated on 2026-02-05 13:15:34*