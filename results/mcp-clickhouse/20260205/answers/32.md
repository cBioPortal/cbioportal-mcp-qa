# Question 32

**Type:** Hotspot Mutation Analysis

**Question:** What are the most frequent EGFR mutation variants in lung adenocarcinoma and what percentage are known hotspot mutations?

**Answer:**

I'll help you find the most frequent EGFR mutation variants in lung adenocarcinoma and determine what percentage are known hotspot mutations.

Let me start by querying the data:



Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\nWITH egfr_mutations AS (\n  SELECT \n    protein_change,\n    mutation_type,\n    COUNT(*) as mutation_count,\n    COUNT(DISTINCT sample_unique_id) as sample_count\n  FROM genomic_event_derived\n  WHERE hugo_gene_symbol = 'EGFR'\n    AND variant_type = 'mutation'\n    AND cancer_study_identifier = 'msk_chord_2024'\n    AND sample_unique_id IN (\n      SELECT DISTINCT sample_unique_id\n      FROM clinical_data_derived\n      WHERE attribute_name = 'CANCER_TYPE_DETAILED'\n        AND attribute_value LIKE '%Lung Adenocarcinoma%'\n        AND cancer_study_identifier = 'msk_chord_2024'\n    )\n    AND protein_change != ''\n  GROUP BY protein_change, mutation_type\n)\nSELECT \n  protein_change,\n  mutation_type,\n  sample_count,\n  mutation_count,\n  ROUND(100.0 * sample_count / (SELECT COUNT(DISTINCT sample_unique_id) \n                                  FROM clinical_data_derived \n                                  WHERE attribute_name = 'CANCER_TYPE_DETAILED' \n                                    AND attribute_value LIKE '%Lung Adenocarcinoma%'\n                                    AND cancer_study_identifier = 'msk_chord_2024'), 2) as percentage_of_samples\nFROM egfr_mutations\nORDER BY sample_count DESC\nLIMIT 20\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"error_message":"Query execution failed: Received ClickHouse exception, code: 47, server response: Code: 47. DB::Exception: Unknown expression identifier `protein_change` in scope egfr_mutations AS (SELECT protein_change, mutation_type, COUNT(*) AS mutation_count, COUNTDistinct(sample_unique_id) AS sample_count FROM genomic_event_derived WHERE (hugo_gene_symbol = 'EGFR') AND (variant_type = 'mutation') AND (cancer_study_identifier = 'msk_chord_2024') AND (sample_unique_id IN (SELECT DISTINCT sample_unique_id FROM clinical_data_derived WHERE (attribute_name = 'CANCER_TYPE_DETAILED') AND (attribute_value LIKE '%Lung Adenocarcinoma%') AND (cancer_study_identifier = 'msk_chord_2024'))) AND (protein_change != '') GROUP BY protein_change, mutation_type). (UNKNOWN_IDENTIFIER) (version 25.8.1.36912 (official build)) (for url https://dl96orhu96.us-east-1.aws.clickhouse.cloud:8443)"}
```


Let me check the available columns in the genomic_event_derived table:



Calling `clickhouse_list_table_columns` with args:
```json
{
  "table": "genomic_event_derived"
}
```



Result from `clickhouse_list_table_columns`:
```json
{"columns":[{"name":"sample_unique_id","type":"String","comment":"Globally unique sample identifier constructed as cancer_study_identifier + \"_\" + sample.stable_id to ensure uniqueness across all studies."},{"name":"hugo_gene_symbol","type":"String","comment":"Official HUGO gene symbol for the affected gene. References gene.hugo_gene_symbol."},{"name":"entrez_gene_id","type":"Int32","comment":"Entrez Gene ID for the affected gene. References gene.entrez_gene_id."},{"name":"gene_panel_stable_id","type":"LowCardinality(String)","comment":"Identifier of the gene panel used for this sample. Defaults to \"WES\" (Whole Exome Sequencing) when no specific panel is assigned."},{"name":"cancer_study_identifier","type":"LowCardinality(String)","comment":"Stable string identifier for the cancer study. References cancer_study.cancer_study_identifier."},{"name":"genetic_profile_stable_id","type":"LowCardinality(String)","comment":"Stable identifier of the genetic profile containing this event. References genetic_profile.stable_id."},{"name":"variant_type","type":"LowCardinality(String)","comment":"Type of genomic variant: \"mutation\" for point mutations/indels, \"cna\" for copy number alterations, \"structural_variant\" for structural rearrangements."},{"name":"mutation_variant","type":"String","comment":"Protein-level change for mutations (e.g., p.V600E). Set to \"NA\" for non-mutation events. References mutation_event.protein_change."},{"name":"mutation_type","type":"LowCardinality(String)","comment":"Classification of mutation type (e.g., Missense, Nonsense, Frame_Shift). Set to \"NA\" for non-mutation events. References mutation_event.mutation_type."},{"name":"mutation_status","type":"LowCardinality(String)","comment":"Mutation status: Germline, Somatic, or LOH. Set to \"NA\" for non-mutation events. References mutation.mutation_status."},{"name":"driver_filter","type":"LowCardinality(String)","comment":"Driver annotation filter applied to the alteration. Currently set to \"NA\" for all events (driver annotations not yet implemented)."},{"name":"driver_tiers_filter","type":"LowCardinality(String)","comment":"Driver tiers annotation filter. Currently set to \"NA\" for all events (driver annotations not yet implemented)."},{"name":"cna_alteration","type":"Nullable(Int8)","comment":"Copy number alteration value (e.g., -2 for deep deletion, +2 for amplification). NULL for non-CNA events. References cna_event.alteration."},{"name":"cna_cytoband","type":"String","comment":"Cytogenetic band location of the gene for CNA events. Empty string for non-CNA events. References reference_genome_gene.cytoband."},{"name":"sv_event_info","type":"String","comment":"Additional information about structural variant events. Empty string for non-SV events. References structural_variant.event_info."},{"name":"patient_unique_id","type":"String","comment":"Globally unique patient identifier constructed as cancer_study_identifier + \"_\" + patient.stable_id to ensure uniqueness across all studies."},{"name":"off_panel","type":"Bool","comment":"Boolean flag indicating whether this genomic event occurred in a gene not covered by the associated gene panel (TRUE=off-panel, FALSE=on-panel). Determined by checking presence in gene_panel_to_gene_derived table."}]}
```


Now I can see the correct column name is `mutation_variant`. Let me also check if there's information about hotspot mutations:



Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\nWITH egfr_mutations AS (\n  SELECT \n    mutation_variant,\n    mutation_type,\n    COUNT(*) as mutation_count,\n    COUNT(DISTINCT sample_unique_id) as sample_count\n  FROM genomic_event_derived\n  WHERE hugo_gene_symbol = 'EGFR'\n    AND variant_type = 'mutation'\n    AND cancer_study_identifier = 'msk_chord_2024'\n    AND sample_unique_id IN (\n      SELECT DISTINCT sample_unique_id\n      FROM clinical_data_derived\n      WHERE attribute_name = 'CANCER_TYPE_DETAILED'\n        AND attribute_value LIKE '%Lung Adenocarcinoma%'\n        AND cancer_study_identifier = 'msk_chord_2024'\n    )\n    AND mutation_variant != 'NA'\n    AND mutation_variant != ''\n  GROUP BY mutation_variant, mutation_type\n)\nSELECT \n  mutation_variant,\n  mutation_type,\n  sample_count,\n  mutation_count,\n  ROUND(100.0 * sample_count / (SELECT COUNT(DISTINCT sample_unique_id) \n                                  FROM clinical_data_derived \n                                  WHERE attribute_name = 'CANCER_TYPE_DETAILED' \n                                    AND attribute_value LIKE '%Lung Adenocarcinoma%'\n                                    AND cancer_study_identifier = 'msk_chord_2024'), 2) as percentage_of_samples\nFROM egfr_mutations\nORDER BY sample_count DESC\nLIMIT 20\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"mutation_variant":"L858R","mutation_type":"Missense_Mutation","sample_count":568,"mutation_count":568,"percentage_of_samples":9.53},{"mutation_variant":"E746_A750del","mutation_type":"In_Frame_Del","sample_count":475,"mutation_count":475,"percentage_of_samples":7.97},{"mutation_variant":"T790M","mutation_type":"Missense_Mutation","sample_count":114,"mutation_count":114,"percentage_of_samples":1.91},{"mutation_variant":"L861Q","mutation_type":"Missense_Mutation","sample_count":60,"mutation_count":60,"percentage_of_samples":1.01},{"mutation_variant":"L747_P753delinsS","mutation_type":"In_Frame_Del","sample_count":59,"mutation_count":59,"percentage_of_samples":0.99},{"mutation_variant":"G719A","mutation_type":"Missense_Mutation","sample_count":54,"mutation_count":54,"percentage_of_samples":0.91},{"mutation_variant":"S768I","mutation_type":"Missense_Mutation","sample_count":46,"mutation_count":46,"percentage_of_samples":0.77},{"mutation_variant":"L747_A750delinsP","mutation_type":"In_Frame_Del","sample_count":44,"mutation_count":44,"percentage_of_samples":0.74},{"mutation_variant":"L747_T751del","mutation_type":"In_Frame_Del","sample_count":41,"mutation_count":41,"percentage_of_samples":0.69},{"mutation_variant":"E746_S752delinsV","mutation_type":"In_Frame_Del","sample_count":32,"mutation_count":32,"percentage_of_samples":0.54},{"mutation_variant":"A767_V769dup","mutation_type":"In_Frame_Ins","sample_count":28,"mutation_count":28,"percentage_of_samples":0.47},{"mutation_variant":"S768_D770dup","mutation_type":"In_Frame_Ins","sample_count":27,"mutation_count":27,"percentage_of_samples":0.45},{"mutation_variant":"G719C","mutation_type":"Missense_Mutation","sample_count":23,"mutation_count":23,"percentage_of_samples":0.39},{"mutation_variant":"E746_T751delinsA","mutation_type":"In_Frame_Del","sample_count":18,"mutation_count":18,"percentage_of_samples":0.3},{"mutation_variant":"G719S","mutation_type":"Missense_Mutation","sample_count":17,"mutation_count":17,"percentage_of_samples":0.29},{"mutation_variant":"C797S","mutation_type":"Missense_Mutation","sample_count":15,"mutation_count":15,"percentage_of_samples":0.25},{"mutation_variant":"E709_T710delinsD","mutation_type":"In_Frame_Del","sample_count":14,"mutation_count":14,"percentage_of_samples":0.23},{"mutation_variant":"N771_H773dup","mutation_type":"In_Frame_Ins","sample_count":13,"mutation_count":13,"percentage_of_samples":0.22},{"mutation_variant":"E709K","mutation_type":"Missense_Mutation","sample_count":12,"mutation_count":12,"percentage_of_samples":0.2},{"mutation_variant":"E709A","mutation_type":"Missense_Mutation","sample_count":11,"mutation_count":11,"percentage_of_samples":0.18}]}
```


Great! Now let me check if there's information about hotspot mutations in the mutation table or related tables:



Calling `clickhouse_list_tables` with args:
```json
{}
```



Result from `clickhouse_list_tables`:
```json
{"tables":[{"name":"allele_specific_copy_number","total_rows":0,"comment":"Allele-specific CNA data for mutations. References mutation_event, genetic_profile, and sample."},{"name":"alteration_driver_annotation","total_rows":37356,"comment":"Annotations for genetic alterations classified as potential drivers. References genetic_profile and sample."},{"name":"cancer_study","total_rows":511,"comment":"Contains metadata for each cancer study in the portal. References type_of_cancer and reference_genome."},{"name":"cancer_study_tags","total_rows":0,"comment":"Tags associated with a cancer study. References cancer_study."},{"name":"clinical_attribute_meta","total_rows":18230,"comment":"Metadata describing clinical attributes. References cancer_study."},{"name":"clinical_data_derived","primary_key":"cancer_study_identifier, type, attribute_name, sample_unique_id","total_rows":11763690,"comment":"Unified clinical data table combining both patient-level and sample-level clinical attributes in a normalized key-value format. Uses FULL OUTER JOIN to ensure all defined clinical attributes appear for each patient/sample, even when no value is recorded (populated with empty string). Enables efficient querying of clinical data across different attribute types and levels."},{"name":"clinical_event","total_rows":2643379,"comment":"Time-bound clinical events for patients. References patient."},{"name":"clinical_event_data","total_rows":14395558,"comment":"Key-value attributes for clinical events. References clinical_event."},{"name":"clinical_event_derived","primary_key":"cancer_study_identifier, event_type, patient_unique_id","total_rows":14422476,"comment":"Denormalized clinical timeline events table combining temporal clinical events with their associated key-value attributes. Each row represents a specific attribute of a clinical event (e.g., treatment, surgery, specimen collection) with start/stop dates. Flattens the normalized clinical_event and clinical_event_data relationship into a queryable format for timeline analysis."},{"name":"clinical_patient","total_rows":4157292,"comment":"Patient-level clinical attribute values. References patient."},{"name":"clinical_sample","total_rows":5323875,"comment":"Sample-level clinical attribute values. References sample."},{"name":"cna_event","total_rows":77018,"comment":"Copy number alteration event definition. References gene."},{"name":"copy_number_seg","total_rows":28149618,"comment":"Raw segmented copy number data. References cancer_study and sample."},{"name":"copy_number_seg_file","total_rows":292,"comment":"File metadata for segmented copy number input. References cancer_study."},{"name":"gene","total_rows":46303,"comment":"Gene metadata (Entrez ID, HUGO symbol). References genetic_entity."},{"name":"gene_alias","total_rows":75207,"comment":"Alternative symbols/aliases for genes. References gene."},{"name":"gene_panel","total_rows":58,"comment":"Defines a targeted gene panel used in sequencing."},{"name":"gene_panel_list","total_rows":21477,"comment":"Join table linking gene panels to genes. References gene_panel and gene."},{"name":"generic_assay_data_derived","primary_key":"profile_type, entity_stable_id, patient_unique_id, sample_unique_id","total_rows":394482832,"comment":"Denormalized generic assay data table that unpivots wide-format genetic_alteration values for generic assay profiles into a long-format structure. Handles diverse assay types like treatment response, phosphosite quantification, and other non-genomic measurements. Each row represents one entity-sample combination with its measured value. Supports both sample-level and patient-level data based on profile configuration."},{"name":"generic_entity_properties","total_rows":2490012,"comment":"Properties for generic entities. References genetic_entity."},{"name":"geneset","total_rows":34837,"comment":"Collection of genes grouped into functional sets. References genetic_entity."},{"name":"geneset_gene","total_rows":8050756,"comment":"Join table linking genesets to genes. References geneset and gene."},{"name":"geneset_hierarchy_leaf","total_rows":0,"comment":"Mapping of hierarchy nodes to specific gene sets. References geneset_hierarchy_node and geneset."},{"name":"geneset_hierarchy_node","total_rows":0,"comment":"Hierarchy node for organizing gene sets. May reference parent node within same table."},{"name":"genetic_alteration","primary_key":"genetic_profile_id, genetic_entity_id","total_rows":33488996,"comment":"Stores genetic alteration values (for many genetic alteration types. e.g. MRNA_EXPRESSION, PROTEIN_LEVEL, GENERIC_ASSAY,...). References genetic_profile and genetic_entity."},{"name":"genetic_alteration_derived","primary_key":"cancer_study_identifier, hugo_gene_symbol, profile_type, sample_unique_id","total_rows":10133300301,"comment":"Denormalized genetic alteration data table that unpivots the wide-format genetic_alteration values into a long-format structure. Each row represents one gene-sample-profile combination with its alteration value. Excludes mutation data (handled separately) and generic assays, focusing on continuous/discrete data like expression, methylation, and copy number. Filters out \"NA\" values to reduce storage and improve query performance."},{"name":"genetic_entity","total_rows":2508068,"comment":"Abstract entity representing a gene, gene set, or other genomic element."},{"name":"genetic_profile","total_rows":2405,"comment":"Defines a molecular profile (e.g. mutations, CNA, mRNA expression). References cancer_study."},{"name":"genetic_profile_link","total_rows":2,"comment":"Links between genetic profiles. References genetic_profile (source and target)."},{"name":"genetic_profile_samples","total_rows":1896,"comment":"Stores ordered sample lists for a genetic profile (for many genetic alteration types. e.g. MRNA_EXPRESSION, PROTEIN_LEVEL, GENERIC_ASSAY,...). References genetic_profile."},{"name":"genomic_event_derived","primary_key":"genetic_profile_stable_id, cancer_study_identifier, variant_type, entrez_gene_id, hugo_gene_symbol, sample_unique_id","total_rows":48903328,"comment":"Unified genomic events table combining mutations, copy number alterations (CNA), and structural variants into a single denormalized view. Each row represents a gene-level genomic event observed in a sample. Structural variants are split into separate rows for site1 and site2 genes (excluding duplicates). Includes off-panel detection to identify events in genes not covered by the associated gene panel."},{"name":"gistic","total_rows":3547,"comment":"GISTIC-identified copy number alteration regions. References cancer_study."},{"name":"gistic_to_gene","total_rows":204806,"comment":"Mapping of GISTIC regions to genes. References gistic and gene."},{"name":"info","total_rows":1},{"name":"mut_sig","total_rows":2850,"comment":"MutSig significance analysis results. References cancer_study and gene."},{"name":"mutation","primary_key":"genetic_profile_id, entrez_gene_id","total_rows":17774534,"comment":"Mutation observations in specific samples and profiles. References mutation_event, gene, genetic_profile, and sample."},{"name":"mutation_count_by_keyword","total_rows":12451447,"comment":"Stores keyword-based aggregated mutation counts. References genetic_profile and gene."},{"name":"mutation_event","total_rows":8850403,"comment":"Defines unique mutation events (by position, gene, allele change). References gene."},{"name":"patient","total_rows":320721,"comment":"Stores patient-level identifiers of patients enrolled in a cancer study. References cancer_study."},{"name":"reference_genome","total_rows":3,"comment":"Reference genome definitions (e.g. hg19, GRCh38)."},{"name":"reference_genome_gene","total_rows":84612,"comment":"Mapping of reference genome builds to genes. References reference_genome and gene."},{"name":"resource_definition","total_rows":43,"comment":"Definitions of external resources (study, patient, sample level). References cancer_study."},{"name":"resource_patient","total_rows":10471,"comment":"Links external resources to patients. References patient."},{"name":"resource_sample","total_rows":3711,"comment":"Links external resources to samples. References sample."},{"name":"resource_study","total_rows":0,"comment":"Links external resources to cancer studies. References cancer_study."},{"name":"sample","total_rows":336873,"comment":"Biological samples collected from patients. References patient."},{"name":"sample_cna_event","primary_key":"genetic_profile_id, cna_event_id, sample_id","total_rows":30879655,"comment":"Observed CNA events per sample and profile. References cna_event, sample, and genetic_profile."},{"name":"sample_derived","primary_key":"cancer_study_identifier, sample_unique_id","total_rows":336873,"comment":"Denormalized sample table with globally unique identifiers and enriched metadata. Combines sample, patient, and cancer_study data with computed flags for sequencing status and copy number segment availability. Optimized for summary and detailed projections with base64-encoded identifiers for URL-safe usage."},{"name":"sample_list","total_rows":2727,"comment":"Named collections of samples within a study. References cancer_study."},{"name":"sample_list_list","total_rows":1452133,"comment":"Join table linking sample lists to samples. References sample and sample_list."},{"name":"sample_profile","total_rows":1090903,"comment":"Links samples to genetic profiles, optionally via a gene panel. References sample, genetic_profile, and gene_panel."},{"name":"sample_to_gene_panel_derived","primary_key":"gene_panel_id, alteration_type, genetic_profile_id, sample_unique_id","total_rows":1090903,"comment":"Denormalized mapping table linking samples to their associated gene panels for each genetic alteration type. Derived from sample_profile, genetic_profile, gene_panel, sample, and cancer_study tables. Defaults to WES (Whole Exome Sequencing) when no specific gene panel is assigned."},{"name":"structural_variant","total_rows":148760,"comment":"Structural variant data (fusions, translocations). References genetic_profile, sample, and gene (site1/site2)."},{"name":"type_of_cancer","total_rows":898,"comment":"Lookup table for cancer types."}]}
```


Let me check the mutation_event table to see if it contains hotspot information:



Calling `clickhouse_list_table_columns` with args:
```json
{
  "table": "mutation_event"
}
```



Result from `clickhouse_list_table_columns`:
```json
{"columns":[{"name":"mutation_event_id","type":"Nullable(Int64)","comment":"Primary key. Unique identifier for the mutation event."},{"name":"entrez_gene_id","type":"Nullable(Int64)","comment":"References gene.entrez_gene_id."},{"name":"chr","type":"Nullable(String)","comment":"Chromosome where mutation occurs."},{"name":"start_position","type":"Nullable(Int64)","comment":"Start genomic position."},{"name":"end_position","type":"Nullable(Int64)","comment":"End genomic position."},{"name":"reference_allele","type":"Nullable(String)","comment":"Reference allele sequence."},{"name":"tumor_seq_allele","type":"Nullable(String)","comment":"Tumor allele sequence."},{"name":"protein_change","type":"Nullable(String)","comment":"Protein-level change caused by mutation."},{"name":"mutation_type","type":"Nullable(String)","comment":"Type of mutation (e.g., Missense, Nonsense)."},{"name":"ncbi_build","type":"Nullable(String)","comment":"NCBI genome build used."},{"name":"strand","type":"Nullable(String)","comment":"Strand (+/-) of the mutation."},{"name":"variant_type","type":"Nullable(String)","comment":"Variant type (e.g., SNP, INDEL)."},{"name":"db_snp_rs","type":"Nullable(String)","comment":"dbSNP identifier."},{"name":"db_snp_val_status","type":"Nullable(String)","comment":"Validation status in dbSNP."},{"name":"refseq_mrna_id","type":"Nullable(String)","comment":"RefSeq mRNA ID."},{"name":"codon_change","type":"Nullable(String)","comment":"Codon change."},{"name":"uniprot_accession","type":"Nullable(String)","comment":"UniProt accession ID."},{"name":"protein_pos_start","type":"Nullable(Int64)","comment":"Start position on protein."},{"name":"protein_pos_end","type":"Nullable(Int64)","comment":"End position on protein."},{"name":"canonical_transcript","type":"Nullable(Int32)","comment":"Flag for canonical transcript."},{"name":"keyword","type":"Nullable(String)","comment":"Keyword annotation (e.g., truncating, V200 Missense)."}]}
```


Let me check the mutation table to see if there's hotspot information there:



Calling `clickhouse_list_table_columns` with args:
```json
{
  "table": "mutation"
}
```



Result from `clickhouse_list_table_columns`:
```json
{"columns":[{"name":"mutation_event_id","type":"Int64","comment":"References mutation_event.mutation_event_id."},{"name":"genetic_profile_id","type":"Int64","comment":"References genetic_profile.genetic_profile_id."},{"name":"sample_id","type":"Int64","comment":"References sample.internal_id."},{"name":"entrez_gene_id","type":"Int64","comment":"References gene.entrez_gene_id."},{"name":"center","type":"Nullable(String)","comment":"Center where sequencing was performed."},{"name":"sequencer","type":"Nullable(String)","comment":"Sequencing platform used."},{"name":"mutation_status","type":"Nullable(String)","comment":"Mutation status: Germline, Somatic, or LOH."},{"name":"validation_status","type":"Nullable(String)","comment":"Validation status."},{"name":"tumor_seq_allele1","type":"Nullable(String)","comment":"Tumor allele 1 sequence."},{"name":"tumor_seq_allele2","type":"Nullable(String)","comment":"Tumor allele 2 sequence."},{"name":"matched_norm_sample_barcode","type":"Nullable(String)","comment":"Matched normal sample barcode."},{"name":"match_norm_seq_allele1","type":"Nullable(String)","comment":"Matched normal allele 1 sequence."},{"name":"match_norm_seq_allele2","type":"Nullable(String)","comment":"Matched normal allele 2 sequence."},{"name":"tumor_validation_allele1","type":"Nullable(String)","comment":"Tumor validation allele 1 sequence."},{"name":"tumor_validation_allele2","type":"Nullable(String)","comment":"Tumor validation allele 2 sequence."},{"name":"match_norm_validation_allele1","type":"Nullable(String)","comment":"Matched normal validation allele 1."},{"name":"match_norm_validation_allele2","type":"Nullable(String)","comment":"Matched normal validation allele 2."},{"name":"verification_status","type":"Nullable(String)","comment":"Verification status."},{"name":"sequencing_phase","type":"Nullable(String)","comment":"Sequencing phase."},{"name":"sequence_source","type":"Nullable(String)","comment":"Source of sequencing data."},{"name":"validation_method","type":"Nullable(String)","comment":"Validation method used."},{"name":"score","type":"Nullable(String)","comment":"Score or quality metric."},{"name":"bam_file","type":"Nullable(String)","comment":"Associated BAM file."},{"name":"tumor_alt_count","type":"Nullable(Int64)","comment":"Tumor alternate allele count."},{"name":"tumor_ref_count","type":"Nullable(Int64)","comment":"Tumor reference allele count."},{"name":"normal_alt_count","type":"Nullable(Int64)","comment":"Normal alternate allele count."},{"name":"normal_ref_count","type":"Nullable(Int64)","comment":"Normal reference allele count."},{"name":"amino_acid_change","type":"Nullable(String)","comment":"Amino acid change from mutation."},{"name":"annotation_json","type":"Nullable(String)","comment":"JSON-formatted annotations."}]}
```


Let me check if there's hotspot information in the annotation_json field or if we need to look elsewhere. Let me also get the total count of EGFR mutations and samples:



Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\nSELECT \n  COUNT(DISTINCT sample_unique_id) as total_samples_with_egfr,\n  COUNT(*) as total_egfr_mutations,\n  COUNT(DISTINCT mutation_variant) as unique_variants\nFROM genomic_event_derived\nWHERE hugo_gene_symbol = 'EGFR'\n  AND variant_type = 'mutation'\n  AND cancer_study_identifier = 'msk_chord_2024'\n  AND sample_unique_id IN (\n    SELECT DISTINCT sample_unique_id\n    FROM clinical_data_derived\n    WHERE attribute_name = 'CANCER_TYPE_DETAILED'\n      AND attribute_value LIKE '%Lung Adenocarcinoma%'\n      AND cancer_study_identifier = 'msk_chord_2024'\n  )\n  AND mutation_variant != 'NA'\n  AND mutation_variant != ''\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"total_samples_with_egfr":1761,"total_egfr_mutations":2121,"unique_variants":282}]}
```


Now let me check if there's annotation data that might indicate hotspot status:



Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\nSELECT annotation_json\nFROM mutation m\nJOIN mutation_event me ON m.mutation_event_id = me.mutation_event_id\nJOIN sample s ON m.sample_id = s.internal_id\nJOIN patient p ON s.patient_id = p.internal_id\nJOIN cancer_study cs ON p.cancer_study_id = cs.cancer_study_id\nWHERE me.protein_change IN ('L858R', 'E746_A750del', 'T790M')\n  AND m.entrez_gene_id = 1956\n  AND cs.cancer_study_identifier = 'msk_chord_2024'\n  AND annotation_json IS NOT NULL\n  AND annotation_json != ''\nLIMIT 5\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[]}
```


Let me check the alteration_driver_annotation table which might have hotspot information:



Calling `clickhouse_list_table_columns` with args:
```json
{
  "table": "alteration_driver_annotation"
}
```



Result from `clickhouse_list_table_columns`:
```json
{"columns":[{"name":"alteration_event_id","type":"Nullable(Int64)","comment":"Identifier of the alteration event."},{"name":"genetic_profile_id","type":"Nullable(Int64)","comment":"References genetic_profile.genetic_profile_id."},{"name":"sample_id","type":"Nullable(Int64)","comment":"References sample.internal_id."},{"name":"driver_filter","type":"Nullable(String)","comment":"Driver filter applied."},{"name":"driver_filter_annotation","type":"Nullable(String)","comment":"Annotation for driver filter."},{"name":"driver_tiers_filter","type":"Nullable(String)","comment":"Driver tiers filter applied."},{"name":"driver_tiers_filter_annotation","type":"Nullable(String)","comment":"Annotation for driver tiers filter."}]}
```




Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\nSELECT \n  me.protein_change,\n  ada.driver_filter,\n  ada.driver_filter_annotation,\n  COUNT(*) as count\nFROM alteration_driver_annotation ada\nJOIN mutation m ON ada.alteration_event_id = m.mutation_event_id \n  AND ada.genetic_profile_id = m.genetic_profile_id \n  AND ada.sample_id = m.sample_id\nJOIN mutation_event me ON m.mutation_event_id = me.mutation_event_id\nJOIN sample s ON m.sample_id = s.internal_id\nJOIN patient p ON s.patient_id = p.internal_id\nJOIN cancer_study cs ON p.cancer_study_id = cs.cancer_study_id\nWHERE m.entrez_gene_id = 1956\n  AND cs.cancer_study_identifier = 'msk_chord_2024'\n  AND me.protein_change IN ('L858R', 'E746_A750del', 'T790M', 'L861Q', 'G719A')\nGROUP BY me.protein_change, ada.driver_filter, ada.driver_filter_annotation\nORDER BY count DESC\nLIMIT 20\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[]}
```


Let me check what data exists in the alteration_driver_annotation table:



Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\nSELECT DISTINCT driver_filter, driver_filter_annotation\nFROM alteration_driver_annotation\nWHERE driver_filter IS NOT NULL OR driver_filter_annotation IS NOT NULL\nLIMIT 10\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"driver_filter":"Putative_Driver","driver_filter_annotation":"Pathogenic or Likely-Pathogenic"},{"driver_filter":"Putative_Driver","driver_filter_annotation":"CH-PD"},{"driver_filter":"Putative_Driver","driver_filter_annotation":"CH putative driver"},{"driver_filter":"Putative_Driver","driver_filter_annotation":"CH putative non-driver"},{"driver_filter":"Putative_Passenger","driver_filter_annotation":"VUS"}]}
```


Good! Now let me query for EGFR mutations with driver annotations in lung adenocarcinoma:



Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\nWITH lung_adeno_samples AS (\n  SELECT DISTINCT sample_unique_id\n  FROM clinical_data_derived\n  WHERE attribute_name = 'CANCER_TYPE_DETAILED'\n    AND attribute_value LIKE '%Lung Adenocarcinoma%'\n    AND cancer_study_identifier = 'msk_chord_2024'\n),\negfr_mutations_annotated AS (\n  SELECT \n    me.protein_change,\n    me.mutation_type,\n    ada.driver_filter,\n    ada.driver_filter_annotation,\n    s.stable_id as sample_id,\n    cs.cancer_study_identifier || '_' || s.stable_id as sample_unique_id\n  FROM mutation m\n  JOIN mutation_event me ON m.mutation_event_id = me.mutation_event_id\n  JOIN sample s ON m.sample_id = s.internal_id\n  JOIN patient p ON s.patient_id = p.internal_id\n  JOIN cancer_study cs ON p.cancer_study_id = cs.cancer_study_id\n  LEFT JOIN alteration_driver_annotation ada ON \n    ada.alteration_event_id = m.mutation_event_id \n    AND ada.genetic_profile_id = m.genetic_profile_id \n    AND ada.sample_id = m.sample_id\n  WHERE m.entrez_gene_id = 1956\n    AND cs.cancer_study_identifier = 'msk_chord_2024'\n    AND me.protein_change IS NOT NULL\n    AND me.protein_change != ''\n)\nSELECT \n  protein_change,\n  mutation_type,\n  driver_filter,\n  driver_filter_annotation,\n  COUNT(*) as sample_count\nFROM egfr_mutations_annotated\nWHERE sample_unique_id IN (SELECT sample_unique_id FROM lung_adeno_samples)\nGROUP BY protein_change, mutation_type, driver_filter, driver_filter_annotation\nORDER BY sample_count DESC\nLIMIT 30\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"protein_change":"L858R","mutation_type":"Missense_Mutation","sample_count":568},{"protein_change":"E746_A750del","mutation_type":"In_Frame_Del","sample_count":475},{"protein_change":"T790M","mutation_type":"Missense_Mutation","sample_count":114},{"protein_change":"L861Q","mutation_type":"Missense_Mutation","sample_count":60},{"protein_change":"L747_P753delinsS","mutation_type":"In_Frame_Del","sample_count":59},{"protein_change":"G719A","mutation_type":"Missense_Mutation","sample_count":54},{"protein_change":"S768I","mutation_type":"Missense_Mutation","sample_count":46},{"protein_change":"L747_A750delinsP","mutation_type":"In_Frame_Del","sample_count":44},{"protein_change":"L747_T751del","mutation_type":"In_Frame_Del","sample_count":41},{"protein_change":"E746_S752delinsV","mutation_type":"In_Frame_Del","sample_count":32},{"protein_change":"A767_V769dup","mutation_type":"In_Frame_Ins","sample_count":28},{"protein_change":"S768_D770dup","mutation_type":"In_Frame_Ins","sample_count":27},{"protein_change":"G719C","mutation_type":"Missense_Mutation","sample_count":23},{"protein_change":"E746_T751delinsA","mutation_type":"In_Frame_Del","sample_count":18},{"protein_change":"G719S","mutation_type":"Missense_Mutation","sample_count":17},{"protein_change":"C797S","mutation_type":"Missense_Mutation","sample_count":15},{"protein_change":"E709_T710delinsD","mutation_type":"In_Frame_Del","sample_count":14},{"protein_change":"N771_H773dup","mutation_type":"In_Frame_Ins","sample_count":13},{"protein_change":"E709K","mutation_type":"Missense_Mutation","sample_count":12},{"protein_change":"L833V","mutation_type":"Missense_Mutation","sample_count":11},{"protein_change":"E709A","mutation_type":"Missense_Mutation","sample_count":11},{"protein_change":"S752_I759del","mutation_type":"In_Frame_Del","sample_count":9},{"protein_change":"L62R","mutation_type":"Missense_Mutation","sample_count":9},{"protein_change":"L747P","mutation_type":"Missense_Mutation","sample_count":9},{"protein_change":"I740_K745dup","mutation_type":"In_Frame_Ins","sample_count":8},{"protein_change":"S768_V769delinsIL","mutation_type":"Missense_Mutation","sample_count":8},{"protein_change":"L747_S752del","mutation_type":"In_Frame_Del","sample_count":8},{"protein_change":"V834L","mutation_type":"Missense_Mutation","sample_count":8},{"protein_change":"H773_V774insAH","mutation_type":"In_Frame_Ins","sample_count":7},{"protein_change":"L747_E749del","mutation_type":"In_Frame_Del","sample_count":7}]}
```


I notice the driver annotations are NULL. Let me check if there's a different way to identify hotspot mutations. Let me look at the mutation_event keyword field which might contain hotspot information:



Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\nWITH lung_adeno_samples AS (\n  SELECT DISTINCT sample_unique_id\n  FROM clinical_data_derived\n  WHERE attribute_name = 'CANCER_TYPE_DETAILED'\n    AND attribute_value LIKE '%Lung Adenocarcinoma%'\n    AND cancer_study_identifier = 'msk_chord_2024'\n)\nSELECT \n  me.protein_change,\n  me.mutation_type,\n  me.keyword,\n  COUNT(DISTINCT cs.cancer_study_identifier || '_' || s.stable_id) as sample_count\nFROM mutation m\nJOIN mutation_event me ON m.mutation_event_id = me.mutation_event_id\nJOIN sample s ON m.sample_id = s.internal_id\nJOIN patient p ON s.patient_id = p.internal_id\nJOIN cancer_study cs ON p.cancer_study_id = cs.cancer_study_id\nWHERE m.entrez_gene_id = 1956\n  AND cs.cancer_study_identifier = 'msk_chord_2024'\n  AND me.protein_change IS NOT NULL\n  AND me.protein_change != ''\n  AND cs.cancer_study_identifier || '_' || s.stable_id IN (SELECT sample_unique_id FROM lung_adeno_samples)\nGROUP BY me.protein_change, me.mutation_type, me.keyword\nORDER BY sample_count DESC\nLIMIT 30\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"protein_change":"L858R","mutation_type":"Missense_Mutation","keyword":"EGFR L858 missense","sample_count":568},{"protein_change":"E746_A750del","mutation_type":"In_Frame_Del","sample_count":475},{"protein_change":"T790M","mutation_type":"Missense_Mutation","keyword":"EGFR T790 missense","sample_count":114},{"protein_change":"L861Q","mutation_type":"Missense_Mutation","keyword":"EGFR L861 missense","sample_count":60},{"protein_change":"L747_P753delinsS","mutation_type":"In_Frame_Del","sample_count":59},{"protein_change":"G719A","mutation_type":"Missense_Mutation","keyword":"EGFR G719 missense","sample_count":54},{"protein_change":"S768I","mutation_type":"Missense_Mutation","keyword":"EGFR S768 missense","sample_count":46},{"protein_change":"L747_A750delinsP","mutation_type":"In_Frame_Del","sample_count":44},{"protein_change":"L747_T751del","mutation_type":"In_Frame_Del","sample_count":41},{"protein_change":"E746_S752delinsV","mutation_type":"In_Frame_Del","sample_count":32},{"protein_change":"A767_V769dup","mutation_type":"In_Frame_Ins","sample_count":28},{"protein_change":"S768_D770dup","mutation_type":"In_Frame_Ins","sample_count":27},{"protein_change":"G719C","mutation_type":"Missense_Mutation","keyword":"EGFR G719 missense","sample_count":23},{"protein_change":"E746_T751delinsA","mutation_type":"In_Frame_Del","sample_count":18},{"protein_change":"G719S","mutation_type":"Missense_Mutation","keyword":"EGFR G719 missense","sample_count":17},{"protein_change":"C797S","mutation_type":"Missense_Mutation","keyword":"EGFR C797 missense","sample_count":15},{"protein_change":"E709_T710delinsD","mutation_type":"In_Frame_Del","sample_count":14},{"protein_change":"N771_H773dup","mutation_type":"In_Frame_Ins","sample_count":13},{"protein_change":"E709K","mutation_type":"Missense_Mutation","keyword":"EGFR E709 missense","sample_count":12},{"protein_change":"E709A","mutation_type":"Missense_Mutation","keyword":"EGFR E709 missense","sample_count":11},{"protein_change":"L833V","mutation_type":"Missense_Mutation","keyword":"EGFR L833 missense","sample_count":11},{"protein_change":"S752_I759del","mutation_type":"In_Frame_Del","sample_count":9},{"protein_change":"L62R","mutation_type":"Missense_Mutation","keyword":"EGFR L62 missense","sample_count":9},{"protein_change":"L747P","mutation_type":"Missense_Mutation","keyword":"EGFR L747 missense","sample_count":9},{"protein_change":"S768_V769delinsIL","mutation_type":"Missense_Mutation","sample_count":8},{"protein_change":"L747_S752del","mutation_type":"In_Frame_Del","sample_count":8},{"protein_change":"I740_K745dup","mutation_type":"In_Frame_Ins","sample_count":8},{"protein_change":"V834L","mutation_type":"Missense_Mutation","keyword":"EGFR V834 missense","sample_count":8},{"protein_change":"P772_H773dup","mutation_type":"In_Frame_Ins","sample_count":7},{"protein_change":"L747_E749del","mutation_type":"In_Frame_Del","sample_count":7}]}
```


Good! Now let me identify which are known hotspot mutations. Based on clinical knowledge, the major EGFR hotspot mutations in lung adenocarcinoma are:
- L858R (exon 21)
- Exon 19 deletions (E746_A750del and related deletions)
- T790M (resistance mutation, exon 20)
- L861Q (exon 21)
- G719X (exon 18)
- S768I (exon 20)
- Exon 20 insertions

Let me create a comprehensive analysis:

---

## Model Information
- **model**: us.anthropic.claude-sonnet-4-5-20250929-v1:0
- **temperature**: 0.0
- **max_output_tokens**: 1024
- **thinking_enabled**: False
- **thinking_budget_tokens**: 1024
- **response_time_seconds**: 66.06166699097957
- **agent_type**: mcp-clickhouse

### Usage
- **input_tokens**: 133725
- **output_tokens**: 4351
- **total_tokens**: 138076
- **cache_creation_input_tokens**: 0
- **cache_read_input_tokens**: 0

---

*Generated on 2026-02-05 12:57:55*