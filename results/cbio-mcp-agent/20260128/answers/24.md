# Question 24

**Type:** Genomic Alteration Comparison

**Question:** How does the mutation landscape differ between primary and metastatic samples from the same patients in the MSK-CHORD Study?

**Answer:**

I'll analyze the mutation landscape differences between primary and metastatic samples from the same patients in the MSK-CHORD study. Let me start by exploring the data structure and then compare the mutation patterns.



Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\n-- First, let's identify patients with both primary and metastatic samples\nSELECT \n    patient_unique_id,\n    COUNT(DISTINCT CASE WHEN attribute_value = 'Primary' THEN sample_unique_id END) as primary_samples,\n    COUNT(DISTINCT CASE WHEN attribute_value = 'Metastasis' THEN sample_unique_id END) as metastatic_samples\nFROM clinical_data_derived\nWHERE cancer_study_identifier = 'msk_chord_2024'\n    AND attribute_name = 'SAMPLE_TYPE'\n    AND attribute_value IN ('Primary', 'Metastasis')\nGROUP BY patient_unique_id\nHAVING primary_samples > 0 AND metastatic_samples > 0\nORDER BY patient_unique_id\nLIMIT 20\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"patient_unique_id":"msk_chord_2024_P-0000012","primary_samples":1,"metastatic_samples":1},{"patient_unique_id":"msk_chord_2024_P-0000825","primary_samples":1,"metastatic_samples":1},{"patient_unique_id":"msk_chord_2024_P-0007080","primary_samples":1,"metastatic_samples":1},{"patient_unique_id":"msk_chord_2024_P-0007887","primary_samples":1,"metastatic_samples":1},{"patient_unique_id":"msk_chord_2024_P-0008077","primary_samples":1,"metastatic_samples":1},{"patient_unique_id":"msk_chord_2024_P-0010785","primary_samples":1,"metastatic_samples":1},{"patient_unique_id":"msk_chord_2024_P-0010965","primary_samples":1,"metastatic_samples":1},{"patient_unique_id":"msk_chord_2024_P-0011043","primary_samples":1,"metastatic_samples":1},{"patient_unique_id":"msk_chord_2024_P-0016181","primary_samples":1,"metastatic_samples":1},{"patient_unique_id":"msk_chord_2024_P-0016731","primary_samples":1,"metastatic_samples":1},{"patient_unique_id":"msk_chord_2024_P-0018588","primary_samples":1,"metastatic_samples":1},{"patient_unique_id":"msk_chord_2024_P-0021156","primary_samples":1,"metastatic_samples":1},{"patient_unique_id":"msk_chord_2024_P-0025952","primary_samples":1,"metastatic_samples":1},{"patient_unique_id":"msk_chord_2024_P-0028809","primary_samples":1,"metastatic_samples":1},{"patient_unique_id":"msk_chord_2024_P-0038062","primary_samples":1,"metastatic_samples":1},{"patient_unique_id":"msk_chord_2024_P-0039656","primary_samples":1,"metastatic_samples":1},{"patient_unique_id":"msk_chord_2024_P-0042066","primary_samples":1,"metastatic_samples":1},{"patient_unique_id":"msk_chord_2024_P-0043580","primary_samples":1,"metastatic_samples":1},{"patient_unique_id":"msk_chord_2024_P-0046090","primary_samples":1,"metastatic_samples":1},{"patient_unique_id":"msk_chord_2024_P-0047234","primary_samples":1,"metastatic_samples":1}]}
```




Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\n-- Get total count of patients with both sample types\nSELECT \n    COUNT(DISTINCT patient_unique_id) as patients_with_both_types\nFROM (\n    SELECT \n        patient_unique_id,\n        COUNT(DISTINCT CASE WHEN attribute_value = 'Primary' THEN sample_unique_id END) as primary_samples,\n        COUNT(DISTINCT CASE WHEN attribute_value = 'Metastasis' THEN sample_unique_id END) as metastatic_samples\n    FROM clinical_data_derived\n    WHERE cancer_study_identifier = 'msk_chord_2024'\n        AND attribute_name = 'SAMPLE_TYPE'\n        AND attribute_value IN ('Primary', 'Metastasis')\n    GROUP BY patient_unique_id\n    HAVING primary_samples > 0 AND metastatic_samples > 0\n)\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"patients_with_both_types":26}]}
```




Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\n-- Compare mutation counts between primary and metastatic samples for the same patients\nWITH paired_patients AS (\n    SELECT DISTINCT patient_unique_id\n    FROM (\n        SELECT \n            patient_unique_id,\n            COUNT(DISTINCT CASE WHEN attribute_value = 'Primary' THEN sample_unique_id END) as primary_samples,\n            COUNT(DISTINCT CASE WHEN attribute_value = 'Metastasis' THEN sample_unique_id END) as metastatic_samples\n        FROM clinical_data_derived\n        WHERE cancer_study_identifier = 'msk_chord_2024'\n            AND attribute_name = 'SAMPLE_TYPE'\n            AND attribute_value IN ('Primary', 'Metastasis')\n        GROUP BY patient_unique_id\n        HAVING primary_samples > 0 AND metastatic_samples > 0\n    )\n),\nsample_types AS (\n    SELECT \n        cd.sample_unique_id,\n        cd.patient_unique_id,\n        cd.attribute_value as sample_type\n    FROM clinical_data_derived cd\n    INNER JOIN paired_patients pp ON cd.patient_unique_id = pp.patient_unique_id\n    WHERE cd.cancer_study_identifier = 'msk_chord_2024'\n        AND cd.attribute_name = 'SAMPLE_TYPE'\n        AND cd.attribute_value IN ('Primary', 'Metastasis')\n)\nSELECT \n    st.sample_type,\n    COUNT(DISTINCT st.sample_unique_id) as sample_count,\n    COUNT(DISTINCT g.hugo_gene_symbol) as unique_genes_mutated,\n    COUNT(*) as total_mutations,\n    ROUND(COUNT(*) / COUNT(DISTINCT st.sample_unique_id), 2) as avg_mutations_per_sample\nFROM sample_types st\nLEFT JOIN genomic_event_derived g \n    ON st.sample_unique_id = g.sample_unique_id\n    AND g.cancer_study_identifier = 'msk_chord_2024'\n    AND g.variant_type = 'mutation'\nGROUP BY st.sample_type\nORDER BY st.sample_type\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"sample_type":"Metastasis","sample_count":26,"unique_genes_mutated":164,"total_mutations":280,"avg_mutations_per_sample":10.77},{"sample_type":"Primary","sample_count":26,"unique_genes_mutated":222,"total_mutations":412,"avg_mutations_per_sample":15.85}]}
```




Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\n-- Get top mutated genes in primary vs metastatic samples\nWITH paired_patients AS (\n    SELECT DISTINCT patient_unique_id\n    FROM (\n        SELECT \n            patient_unique_id,\n            COUNT(DISTINCT CASE WHEN attribute_value = 'Primary' THEN sample_unique_id END) as primary_samples,\n            COUNT(DISTINCT CASE WHEN attribute_value = 'Metastasis' THEN sample_unique_id END) as metastatic_samples\n        FROM clinical_data_derived\n        WHERE cancer_study_identifier = 'msk_chord_2024'\n            AND attribute_name = 'SAMPLE_TYPE'\n            AND attribute_value IN ('Primary', 'Metastasis')\n        GROUP BY patient_unique_id\n        HAVING primary_samples > 0 AND metastatic_samples > 0\n    )\n),\nsample_types AS (\n    SELECT \n        cd.sample_unique_id,\n        cd.patient_unique_id,\n        cd.attribute_value as sample_type\n    FROM clinical_data_derived cd\n    INNER JOIN paired_patients pp ON cd.patient_unique_id = pp.patient_unique_id\n    WHERE cd.cancer_study_identifier = 'msk_chord_2024'\n        AND cd.attribute_name = 'SAMPLE_TYPE'\n        AND cd.attribute_value IN ('Primary', 'Metastasis')\n)\nSELECT \n    g.hugo_gene_symbol,\n    COUNT(DISTINCT CASE WHEN st.sample_type = 'Primary' THEN st.sample_unique_id END) as primary_mutated_samples,\n    COUNT(DISTINCT CASE WHEN st.sample_type = 'Metastasis' THEN st.sample_unique_id END) as metastatic_mutated_samples,\n    ROUND(COUNT(DISTINCT CASE WHEN st.sample_type = 'Primary' THEN st.sample_unique_id END) * 100.0 / 26, 1) as primary_freq_pct,\n    ROUND(COUNT(DISTINCT CASE WHEN st.sample_type = 'Metastasis' THEN st.sample_unique_id END) * 100.0 / 26, 1) as metastatic_freq_pct\nFROM sample_types st\nINNER JOIN genomic_event_derived g \n    ON st.sample_unique_id = g.sample_unique_id\n    AND g.cancer_study_identifier = 'msk_chord_2024'\n    AND g.variant_type = 'mutation'\nGROUP BY g.hugo_gene_symbol\nHAVING primary_mutated_samples >= 2 OR metastatic_mutated_samples >= 2\nORDER BY (primary_mutated_samples + metastatic_mutated_samples) DESC\nLIMIT 30\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"hugo_gene_symbol":"TP53","primary_mutated_samples":13,"metastatic_mutated_samples":15,"primary_freq_pct":50.0,"metastatic_freq_pct":57.7},{"hugo_gene_symbol":"KRAS","primary_mutated_samples":10,"metastatic_mutated_samples":8,"primary_freq_pct":38.5,"metastatic_freq_pct":30.8},{"hugo_gene_symbol":"APC","primary_mutated_samples":7,"metastatic_mutated_samples":5,"primary_freq_pct":26.9,"metastatic_freq_pct":19.2},{"hugo_gene_symbol":"ATR","primary_mutated_samples":3,"metastatic_mutated_samples":5,"primary_freq_pct":11.5,"metastatic_freq_pct":19.2},{"hugo_gene_symbol":"PIK3CA","primary_mutated_samples":3,"metastatic_mutated_samples":4,"primary_freq_pct":11.5,"metastatic_freq_pct":15.4},{"hugo_gene_symbol":"KMT2C","primary_mutated_samples":3,"metastatic_mutated_samples":4,"primary_freq_pct":11.5,"metastatic_freq_pct":15.4},{"hugo_gene_symbol":"ARID1A","primary_mutated_samples":3,"metastatic_mutated_samples":3,"primary_freq_pct":11.5,"metastatic_freq_pct":11.5},{"hugo_gene_symbol":"PTPRS","primary_mutated_samples":4,"metastatic_mutated_samples":2,"primary_freq_pct":15.4,"metastatic_freq_pct":7.7},{"hugo_gene_symbol":"RNF43","primary_mutated_samples":5,"metastatic_mutated_samples":1,"primary_freq_pct":19.2,"metastatic_freq_pct":3.8},{"hugo_gene_symbol":"KMT2D","primary_mutated_samples":3,"metastatic_mutated_samples":3,"primary_freq_pct":11.5,"metastatic_freq_pct":11.5},{"hugo_gene_symbol":"BRAF","primary_mutated_samples":4,"metastatic_mutated_samples":1,"primary_freq_pct":15.4,"metastatic_freq_pct":3.8},{"hugo_gene_symbol":"MAP3K1","primary_mutated_samples":1,"metastatic_mutated_samples":4,"primary_freq_pct":3.8,"metastatic_freq_pct":15.4},{"hugo_gene_symbol":"KMT2B","primary_mutated_samples":3,"metastatic_mutated_samples":2,"primary_freq_pct":11.5,"metastatic_freq_pct":7.7},{"hugo_gene_symbol":"FAT1","primary_mutated_samples":3,"metastatic_mutated_samples":2,"primary_freq_pct":11.5,"metastatic_freq_pct":7.7},{"hugo_gene_symbol":"TET1","primary_mutated_samples":3,"metastatic_mutated_samples":2,"primary_freq_pct":11.5,"metastatic_freq_pct":7.7},{"hugo_gene_symbol":"EGFR","primary_mutated_samples":3,"metastatic_mutated_samples":2,"primary_freq_pct":11.5,"metastatic_freq_pct":7.7},{"hugo_gene_symbol":"ATRX","primary_mutated_samples":2,"metastatic_mutated_samples":3,"primary_freq_pct":7.7,"metastatic_freq_pct":11.5},{"hugo_gene_symbol":"STK11","primary_mutated_samples":1,"metastatic_mutated_samples":4,"primary_freq_pct":3.8,"metastatic_freq_pct":15.4},{"hugo_gene_symbol":"POLE","primary_mutated_samples":4,"metastatic_mutated_samples":1,"primary_freq_pct":15.4,"metastatic_freq_pct":3.8},{"hugo_gene_symbol":"ARID1B","primary_mutated_samples":1,"metastatic_mutated_samples":3,"primary_freq_pct":3.8,"metastatic_freq_pct":11.5},{"hugo_gene_symbol":"NSD1","primary_mutated_samples":2,"metastatic_mutated_samples":2,"primary_freq_pct":7.7,"metastatic_freq_pct":7.7},{"hugo_gene_symbol":"RBM10","primary_mutated_samples":2,"metastatic_mutated_samples":2,"primary_freq_pct":7.7,"metastatic_freq_pct":7.7},{"hugo_gene_symbol":"PDGFRA","primary_mutated_samples":1,"metastatic_mutated_samples":3,"primary_freq_pct":3.8,"metastatic_freq_pct":11.5},{"hugo_gene_symbol":"ZFHX3","primary_mutated_samples":1,"metastatic_mutated_samples":3,"primary_freq_pct":3.8,"metastatic_freq_pct":11.5},{"hugo_gene_symbol":"MED12","primary_mutated_samples":4,"metastatic_mutated_samples":0,"primary_freq_pct":15.4,"metastatic_freq_pct":0.0},{"hugo_gene_symbol":"CREBBP","primary_mutated_samples":3,"metastatic_mutated_samples":1,"primary_freq_pct":11.5,"metastatic_freq_pct":3.8},{"hugo_gene_symbol":"EPHA3","primary_mutated_samples":2,"metastatic_mutated_samples":2,"primary_freq_pct":7.7,"metastatic_freq_pct":7.7},{"hugo_gene_symbol":"TERT","primary_mutated_samples":3,"metastatic_mutated_samples":1,"primary_freq_pct":11.5,"metastatic_freq_pct":3.8},{"hugo_gene_symbol":"PTPRD","primary_mutated_samples":2,"metastatic_mutated_samples":2,"primary_freq_pct":7.7,"metastatic_freq_pct":7.7},{"hugo_gene_symbol":"NOTCH3","primary_mutated_samples":2,"metastatic_mutated_samples":2,"primary_freq_pct":7.7,"metastatic_freq_pct":7.7}]}
```




Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\n-- Analyze genes enriched in metastatic vs primary samples\nWITH paired_patients AS (\n    SELECT DISTINCT patient_unique_id\n    FROM (\n        SELECT \n            patient_unique_id,\n            COUNT(DISTINCT CASE WHEN attribute_value = 'Primary' THEN sample_unique_id END) as primary_samples,\n            COUNT(DISTINCT CASE WHEN attribute_value = 'Metastasis' THEN sample_unique_id END) as metastatic_samples\n        FROM clinical_data_derived\n        WHERE cancer_study_identifier = 'msk_chord_2024'\n            AND attribute_name = 'SAMPLE_TYPE'\n            AND attribute_value IN ('Primary', 'Metastasis')\n        GROUP BY patient_unique_id\n        HAVING primary_samples > 0 AND metastatic_samples > 0\n    )\n),\nsample_types AS (\n    SELECT \n        cd.sample_unique_id,\n        cd.patient_unique_id,\n        cd.attribute_value as sample_type\n    FROM clinical_data_derived cd\n    INNER JOIN paired_patients pp ON cd.patient_unique_id = pp.patient_unique_id\n    WHERE cd.cancer_study_identifier = 'msk_chord_2024'\n        AND cd.attribute_name = 'SAMPLE_TYPE'\n        AND cd.attribute_value IN ('Primary', 'Metastasis')\n)\nSELECT \n    g.hugo_gene_symbol,\n    COUNT(DISTINCT CASE WHEN st.sample_type = 'Primary' THEN st.sample_unique_id END) as primary_mutated,\n    COUNT(DISTINCT CASE WHEN st.sample_type = 'Metastasis' THEN st.sample_unique_id END) as metastatic_mutated,\n    ROUND(COUNT(DISTINCT CASE WHEN st.sample_type = 'Metastasis' THEN st.sample_unique_id END) * 100.0 / 26, 1) as metastatic_freq_pct,\n    ROUND(COUNT(DISTINCT CASE WHEN st.sample_type = 'Primary' THEN st.sample_unique_id END) * 100.0 / 26, 1) as primary_freq_pct,\n    ROUND(COUNT(DISTINCT CASE WHEN st.sample_type = 'Metastasis' THEN st.sample_unique_id END) * 100.0 / 26 - \n          COUNT(DISTINCT CASE WHEN st.sample_type = 'Primary' THEN st.sample_unique_id END) * 100.0 / 26, 1) as enrichment_diff\nFROM sample_types st\nINNER JOIN genomic_event_derived g \n    ON st.sample_unique_id = g.sample_unique_id\n    AND g.cancer_study_identifier = 'msk_chord_2024'\n    AND g.variant_type = 'mutation'\nGROUP BY g.hugo_gene_symbol\nHAVING (primary_mutated >= 2 OR metastatic_mutated >= 2)\nORDER BY enrichment_diff DESC\nLIMIT 20\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"hugo_gene_symbol":"STK11","primary_mutated":1,"metastatic_mutated":4,"metastatic_freq_pct":15.4,"primary_freq_pct":3.8,"enrichment_diff":11.5},{"hugo_gene_symbol":"MAP3K1","primary_mutated":1,"metastatic_mutated":4,"metastatic_freq_pct":15.4,"primary_freq_pct":3.8,"enrichment_diff":11.5},{"hugo_gene_symbol":"MGA","primary_mutated":0,"metastatic_mutated":3,"metastatic_freq_pct":11.5,"primary_freq_pct":0.0,"enrichment_diff":11.5},{"hugo_gene_symbol":"CDKN2A","primary_mutated":1,"metastatic_mutated":3,"metastatic_freq_pct":11.5,"primary_freq_pct":3.8,"enrichment_diff":7.7},{"hugo_gene_symbol":"PTPRT","primary_mutated":1,"metastatic_mutated":3,"metastatic_freq_pct":11.5,"primary_freq_pct":3.8,"enrichment_diff":7.7},{"hugo_gene_symbol":"KEAP1","primary_mutated":1,"metastatic_mutated":3,"metastatic_freq_pct":11.5,"primary_freq_pct":3.8,"enrichment_diff":7.7},{"hugo_gene_symbol":"TP53","primary_mutated":13,"metastatic_mutated":15,"metastatic_freq_pct":57.7,"primary_freq_pct":50.0,"enrichment_diff":7.7},{"hugo_gene_symbol":"PDGFRA","primary_mutated":1,"metastatic_mutated":3,"metastatic_freq_pct":11.5,"primary_freq_pct":3.8,"enrichment_diff":7.7},{"hugo_gene_symbol":"BRCA1","primary_mutated":0,"metastatic_mutated":2,"metastatic_freq_pct":7.7,"primary_freq_pct":0.0,"enrichment_diff":7.7},{"hugo_gene_symbol":"ARID1B","primary_mutated":1,"metastatic_mutated":3,"metastatic_freq_pct":11.5,"primary_freq_pct":3.8,"enrichment_diff":7.7},{"hugo_gene_symbol":"ZFHX3","primary_mutated":1,"metastatic_mutated":3,"metastatic_freq_pct":11.5,"primary_freq_pct":3.8,"enrichment_diff":7.7},{"hugo_gene_symbol":"HGF","primary_mutated":0,"metastatic_mutated":2,"metastatic_freq_pct":7.7,"primary_freq_pct":0.0,"enrichment_diff":7.7},{"hugo_gene_symbol":"CUL3","primary_mutated":0,"metastatic_mutated":2,"metastatic_freq_pct":7.7,"primary_freq_pct":0.0,"enrichment_diff":7.7},{"hugo_gene_symbol":"SMO","primary_mutated":0,"metastatic_mutated":2,"metastatic_freq_pct":7.7,"primary_freq_pct":0.0,"enrichment_diff":7.7},{"hugo_gene_symbol":"NCOR1","primary_mutated":1,"metastatic_mutated":3,"metastatic_freq_pct":11.5,"primary_freq_pct":3.8,"enrichment_diff":7.7},{"hugo_gene_symbol":"TBX3","primary_mutated":1,"metastatic_mutated":3,"metastatic_freq_pct":11.5,"primary_freq_pct":3.8,"enrichment_diff":7.7},{"hugo_gene_symbol":"ATR","primary_mutated":3,"metastatic_mutated":5,"metastatic_freq_pct":19.2,"primary_freq_pct":11.5,"enrichment_diff":7.7},{"hugo_gene_symbol":"PIK3CA","primary_mutated":3,"metastatic_mutated":4,"metastatic_freq_pct":15.4,"primary_freq_pct":11.5,"enrichment_diff":3.8},{"hugo_gene_symbol":"CDK12","primary_mutated":1,"metastatic_mutated":2,"metastatic_freq_pct":7.7,"primary_freq_pct":3.8,"enrichment_diff":3.8},{"hugo_gene_symbol":"GATA3","primary_mutated":1,"metastatic_mutated":2,"metastatic_freq_pct":7.7,"primary_freq_pct":3.8,"enrichment_diff":3.8}]}
```




Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\n-- Genes enriched in primary samples\nWITH paired_patients AS (\n    SELECT DISTINCT patient_unique_id\n    FROM (\n        SELECT \n            patient_unique_id,\n            COUNT(DISTINCT CASE WHEN attribute_value = 'Primary' THEN sample_unique_id END) as primary_samples,\n            COUNT(DISTINCT CASE WHEN attribute_value = 'Metastasis' THEN sample_unique_id END) as metastatic_samples\n        FROM clinical_data_derived\n        WHERE cancer_study_identifier = 'msk_chord_2024'\n            AND attribute_name = 'SAMPLE_TYPE'\n            AND attribute_value IN ('Primary', 'Metastasis')\n        GROUP BY patient_unique_id\n        HAVING primary_samples > 0 AND metastatic_samples > 0\n    )\n),\nsample_types AS (\n    SELECT \n        cd.sample_unique_id,\n        cd.patient_unique_id,\n        cd.attribute_value as sample_type\n    FROM clinical_data_derived cd\n    INNER JOIN paired_patients pp ON cd.patient_unique_id = pp.patient_unique_id\n    WHERE cd.cancer_study_identifier = 'msk_chord_2024'\n        AND cd.attribute_name = 'SAMPLE_TYPE'\n        AND cd.attribute_value IN ('Primary', 'Metastasis')\n)\nSELECT \n    g.hugo_gene_symbol,\n    COUNT(DISTINCT CASE WHEN st.sample_type = 'Primary' THEN st.sample_unique_id END) as primary_mutated,\n    COUNT(DISTINCT CASE WHEN st.sample_type = 'Metastasis' THEN st.sample_unique_id END) as metastatic_mutated,\n    ROUND(COUNT(DISTINCT CASE WHEN st.sample_type = 'Primary' THEN st.sample_unique_id END) * 100.0 / 26, 1) as primary_freq_pct,\n    ROUND(COUNT(DISTINCT CASE WHEN st.sample_type = 'Metastasis' THEN st.sample_unique_id END) * 100.0 / 26, 1) as metastatic_freq_pct,\n    ROUND(COUNT(DISTINCT CASE WHEN st.sample_type = 'Primary' THEN st.sample_unique_id END) * 100.0 / 26 - \n          COUNT(DISTINCT CASE WHEN st.sample_type = 'Metastasis' THEN st.sample_unique_id END) * 100.0 / 26, 1) as enrichment_diff\nFROM sample_types st\nINNER JOIN genomic_event_derived g \n    ON st.sample_unique_id = g.sample_unique_id\n    AND g.cancer_study_identifier = 'msk_chord_2024'\n    AND g.variant_type = 'mutation'\nGROUP BY g.hugo_gene_symbol\nHAVING (primary_mutated >= 2 OR metastatic_mutated >= 2)\nORDER BY enrichment_diff DESC\nLIMIT 20\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"hugo_gene_symbol":"MED12","primary_mutated":4,"metastatic_mutated":0,"primary_freq_pct":15.4,"metastatic_freq_pct":0.0,"enrichment_diff":15.4},{"hugo_gene_symbol":"RNF43","primary_mutated":5,"metastatic_mutated":1,"primary_freq_pct":19.2,"metastatic_freq_pct":3.8,"enrichment_diff":15.4},{"hugo_gene_symbol":"RECQL","primary_mutated":3,"metastatic_mutated":0,"primary_freq_pct":11.5,"metastatic_freq_pct":0.0,"enrichment_diff":11.5},{"hugo_gene_symbol":"DROSHA","primary_mutated":3,"metastatic_mutated":0,"primary_freq_pct":11.5,"metastatic_freq_pct":0.0,"enrichment_diff":11.5},{"hugo_gene_symbol":"EPHA5","primary_mutated":3,"metastatic_mutated":0,"primary_freq_pct":11.5,"metastatic_freq_pct":0.0,"enrichment_diff":11.5},{"hugo_gene_symbol":"NKX2-1","primary_mutated":3,"metastatic_mutated":0,"primary_freq_pct":11.5,"metastatic_freq_pct":0.0,"enrichment_diff":11.5},{"hugo_gene_symbol":"NOTCH4","primary_mutated":3,"metastatic_mutated":0,"primary_freq_pct":11.5,"metastatic_freq_pct":0.0,"enrichment_diff":11.5},{"hugo_gene_symbol":"AR","primary_mutated":3,"metastatic_mutated":0,"primary_freq_pct":11.5,"metastatic_freq_pct":0.0,"enrichment_diff":11.5},{"hugo_gene_symbol":"SOS1","primary_mutated":3,"metastatic_mutated":0,"primary_freq_pct":11.5,"metastatic_freq_pct":0.0,"enrichment_diff":11.5},{"hugo_gene_symbol":"FANCA","primary_mutated":3,"metastatic_mutated":0,"primary_freq_pct":11.5,"metastatic_freq_pct":0.0,"enrichment_diff":11.5},{"hugo_gene_symbol":"ERBB2","primary_mutated":3,"metastatic_mutated":0,"primary_freq_pct":11.5,"metastatic_freq_pct":0.0,"enrichment_diff":11.5},{"hugo_gene_symbol":"BRAF","primary_mutated":4,"metastatic_mutated":1,"primary_freq_pct":15.4,"metastatic_freq_pct":3.8,"enrichment_diff":11.5},{"hugo_gene_symbol":"POLE","primary_mutated":4,"metastatic_mutated":1,"primary_freq_pct":15.4,"metastatic_freq_pct":3.8,"enrichment_diff":11.5},{"hugo_gene_symbol":"MSH3","primary_mutated":2,"metastatic_mutated":0,"primary_freq_pct":7.7,"metastatic_freq_pct":0.0,"enrichment_diff":7.7},{"hugo_gene_symbol":"KDM6A","primary_mutated":2,"metastatic_mutated":0,"primary_freq_pct":7.7,"metastatic_freq_pct":0.0,"enrichment_diff":7.7},{"hugo_gene_symbol":"KDM5C","primary_mutated":2,"metastatic_mutated":0,"primary_freq_pct":7.7,"metastatic_freq_pct":0.0,"enrichment_diff":7.7},{"hugo_gene_symbol":"RICTOR","primary_mutated":2,"metastatic_mutated":0,"primary_freq_pct":7.7,"metastatic_freq_pct":0.0,"enrichment_diff":7.7},{"hugo_gene_symbol":"KRAS","primary_mutated":10,"metastatic_mutated":8,"primary_freq_pct":38.5,"metastatic_freq_pct":30.8,"enrichment_diff":7.7},{"hugo_gene_symbol":"MAP2K1","primary_mutated":2,"metastatic_mutated":0,"primary_freq_pct":7.7,"metastatic_freq_pct":0.0,"enrichment_diff":7.7},{"hugo_gene_symbol":"STAT5B","primary_mutated":2,"metastatic_mutated":0,"primary_freq_pct":7.7,"metastatic_freq_pct":0.0,"enrichment_diff":7.7}]}
```




Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\n-- Compare TMB between primary and metastatic samples\nWITH paired_patients AS (\n    SELECT DISTINCT patient_unique_id\n    FROM (\n        SELECT \n            patient_unique_id,\n            COUNT(DISTINCT CASE WHEN attribute_value = 'Primary' THEN sample_unique_id END) as primary_samples,\n            COUNT(DISTINCT CASE WHEN attribute_value = 'Metastasis' THEN sample_unique_id END) as metastatic_samples\n        FROM clinical_data_derived\n        WHERE cancer_study_identifier = 'msk_chord_2024'\n            AND attribute_name = 'SAMPLE_TYPE'\n            AND attribute_value IN ('Primary', 'Metastasis')\n        GROUP BY patient_unique_id\n        HAVING primary_samples > 0 AND metastatic_samples > 0\n    )\n),\nsample_types AS (\n    SELECT \n        cd.sample_unique_id,\n        cd.patient_unique_id,\n        cd.attribute_value as sample_type\n    FROM clinical_data_derived cd\n    INNER JOIN paired_patients pp ON cd.patient_unique_id = pp.patient_unique_id\n    WHERE cd.cancer_study_identifier = 'msk_chord_2024'\n        AND cd.attribute_name = 'SAMPLE_TYPE'\n        AND cd.attribute_value IN ('Primary', 'Metastasis')\n),\ntmb_data AS (\n    SELECT \n        st.sample_unique_id,\n        st.sample_type,\n        CAST(cd.attribute_value AS Float64) as tmb\n    FROM sample_types st\n    LEFT JOIN clinical_data_derived cd \n        ON st.sample_unique_id = cd.sample_unique_id\n        AND cd.cancer_study_identifier = 'msk_chord_2024'\n        AND cd.attribute_name = 'TMB_NONSYNONYMOUS'\n    WHERE cd.attribute_value IS NOT NULL\n)\nSELECT \n    sample_type,\n    COUNT(*) as sample_count,\n    ROUND(AVG(tmb), 2) as avg_tmb,\n    ROUND(median(tmb), 2) as median_tmb,\n    ROUND(MIN(tmb), 2) as min_tmb,\n    ROUND(MAX(tmb), 2) as max_tmb\nFROM tmb_data\nGROUP BY sample_type\nORDER BY sample_type\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"sample_type":"Metastasis","sample_count":26,"avg_tmb":9.68,"median_tmb":5.96,"min_tmb":0.98,"max_tmb":51.02},{"sample_type":"Primary","sample_count":26,"avg_tmb":13.41,"median_tmb":4.92,"min_tmb":1.11,"max_tmb":103.36}]}
```




Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\n-- Look at cancer types represented in paired samples\nWITH paired_patients AS (\n    SELECT DISTINCT patient_unique_id\n    FROM (\n        SELECT \n            patient_unique_id,\n            COUNT(DISTINCT CASE WHEN attribute_value = 'Primary' THEN sample_unique_id END) as primary_samples,\n            COUNT(DISTINCT CASE WHEN attribute_value = 'Metastasis' THEN sample_unique_id END) as metastatic_samples\n        FROM clinical_data_derived\n        WHERE cancer_study_identifier = 'msk_chord_2024'\n            AND attribute_name = 'SAMPLE_TYPE'\n            AND attribute_value IN ('Primary', 'Metastasis')\n        GROUP BY patient_unique_id\n        HAVING primary_samples > 0 AND metastatic_samples > 0\n    )\n)\nSELECT \n    cd.attribute_value as cancer_type,\n    COUNT(DISTINCT cd.patient_unique_id) as patient_count\nFROM clinical_data_derived cd\nINNER JOIN paired_patients pp ON cd.patient_unique_id = pp.patient_unique_id\nWHERE cd.cancer_study_identifier = 'msk_chord_2024'\n    AND cd.attribute_name = 'CANCER_TYPE'\nGROUP BY cd.attribute_value\nORDER BY patient_count DESC\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"cancer_type":"Non-Small Cell Lung Cancer","patient_count":18},{"cancer_type":"Colorectal Cancer","patient_count":12},{"cancer_type":"Pancreatic Cancer","patient_count":9},{"cancer_type":"Prostate Cancer","patient_count":7},{"cancer_type":"Breast Cancer","patient_count":6}]}
```




Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\n-- Analyze mutation type distribution (missense, nonsense, etc.)\nWITH paired_patients AS (\n    SELECT DISTINCT patient_unique_id\n    FROM (\n        SELECT \n            patient_unique_id,\n            COUNT(DISTINCT CASE WHEN attribute_value = 'Primary' THEN sample_unique_id END) as primary_samples,\n            COUNT(DISTINCT CASE WHEN attribute_value = 'Metastasis' THEN sample_unique_id END) as metastatic_samples\n        FROM clinical_data_derived\n        WHERE cancer_study_identifier = 'msk_chord_2024'\n            AND attribute_name = 'SAMPLE_TYPE'\n            AND attribute_value IN ('Primary', 'Metastasis')\n        GROUP BY patient_unique_id\n        HAVING primary_samples > 0 AND metastatic_samples > 0\n    )\n),\nsample_types AS (\n    SELECT \n        cd.sample_unique_id,\n        cd.patient_unique_id,\n        cd.attribute_value as sample_type\n    FROM clinical_data_derived cd\n    INNER JOIN paired_patients pp ON cd.patient_unique_id = pp.patient_unique_id\n    WHERE cd.cancer_study_identifier = 'msk_chord_2024'\n        AND cd.attribute_name = 'SAMPLE_TYPE'\n        AND cd.attribute_value IN ('Primary', 'Metastasis')\n)\nSELECT \n    st.sample_type,\n    g.mutation_type,\n    COUNT(*) as mutation_count,\n    ROUND(COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY st.sample_type), 1) as pct_of_type\nFROM sample_types st\nINNER JOIN genomic_event_derived g \n    ON st.sample_unique_id = g.sample_unique_id\n    AND g.cancer_study_identifier = 'msk_chord_2024'\n    AND g.variant_type = 'mutation'\nWHERE g.mutation_type IS NOT NULL AND g.mutation_type != ''\nGROUP BY st.sample_type, g.mutation_type\nORDER BY st.sample_type, mutation_count DESC\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"sample_type":"Metastasis","mutation_type":"Missense_Mutation","mutation_count":190,"pct_of_type":67.9},{"sample_type":"Metastasis","mutation_type":"Frame_Shift_Del","mutation_count":38,"pct_of_type":13.6},{"sample_type":"Metastasis","mutation_type":"Nonsense_Mutation","mutation_count":27,"pct_of_type":9.6},{"sample_type":"Metastasis","mutation_type":"Frame_Shift_Ins","mutation_count":12,"pct_of_type":4.3},{"sample_type":"Metastasis","mutation_type":"Splice_Site","mutation_count":7,"pct_of_type":2.5},{"sample_type":"Metastasis","mutation_type":"In_Frame_Del","mutation_count":3,"pct_of_type":1.1},{"sample_type":"Metastasis","mutation_type":"Translation_Start_Site","mutation_count":2,"pct_of_type":0.7},{"sample_type":"Metastasis","mutation_type":"5'Flank","mutation_count":1,"pct_of_type":0.4},{"sample_type":"Primary","mutation_type":"Missense_Mutation","mutation_count":294,"pct_of_type":71.4},{"sample_type":"Primary","mutation_type":"Frame_Shift_Del","mutation_count":61,"pct_of_type":14.8},{"sample_type":"Primary","mutation_type":"Nonsense_Mutation","mutation_count":30,"pct_of_type":7.3},{"sample_type":"Primary","mutation_type":"Frame_Shift_Ins","mutation_count":13,"pct_of_type":3.2},{"sample_type":"Primary","mutation_type":"Splice_Site","mutation_count":7,"pct_of_type":1.7},{"sample_type":"Primary","mutation_type":"In_Frame_Del","mutation_count":6,"pct_of_type":1.5},{"sample_type":"Primary","mutation_type":"In_Frame_Ins","mutation_count":1,"pct_of_type":0.2}]}
```




Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\n-- Analyze shared vs unique mutations within patient pairs\nWITH paired_patients AS (\n    SELECT DISTINCT patient_unique_id\n    FROM (\n        SELECT \n            patient_unique_id,\n            COUNT(DISTINCT CASE WHEN attribute_value = 'Primary' THEN sample_unique_id END) as primary_samples,\n            COUNT(DISTINCT CASE WHEN attribute_value = 'Metastasis' THEN sample_unique_id END) as metastatic_samples\n        FROM clinical_data_derived\n        WHERE cancer_study_identifier = 'msk_chord_2024'\n            AND attribute_name = 'SAMPLE_TYPE'\n            AND attribute_value IN ('Primary', 'Metastasis')\n        GROUP BY patient_unique_id\n        HAVING primary_samples > 0 AND metastatic_samples > 0\n    )\n),\nsample_types AS (\n    SELECT \n        cd.sample_unique_id,\n        cd.patient_unique_id,\n        cd.attribute_value as sample_type\n    FROM clinical_data_derived cd\n    INNER JOIN paired_patients pp ON cd.patient_unique_id = pp.patient_unique_id\n    WHERE cd.cancer_study_identifier = 'msk_chord_2024'\n        AND cd.attribute_name = 'SAMPLE_TYPE'\n        AND cd.attribute_value IN ('Primary', 'Metastasis')\n),\npatient_gene_mutations AS (\n    SELECT \n        st.patient_unique_id,\n        g.hugo_gene_symbol,\n        COUNT(DISTINCT CASE WHEN st.sample_type = 'Primary' THEN st.sample_unique_id END) > 0 as in_primary,\n        COUNT(DISTINCT CASE WHEN st.sample_type = 'Metastasis' THEN st.sample_unique_id END) > 0 as in_metastasis\n    FROM sample_types st\n    INNER JOIN genomic_event_derived g \n        ON st.sample_unique_id = g.sample_unique_id\n        AND g.cancer_study_identifier = 'msk_chord_2024'\n        AND g.variant_type = 'mutation'\n    GROUP BY st.patient_unique_id, g.hugo_gene_symbol\n)\nSELECT \n    COUNT(DISTINCT CASE WHEN in_primary AND in_metastasis THEN hugo_gene_symbol END) as shared_genes,\n    COUNT(DISTINCT CASE WHEN in_primary AND NOT in_metastasis THEN hugo_gene_symbol END) as primary_only_genes,\n    COUNT(DISTINCT CASE WHEN in_metastasis AND NOT in_primary THEN hugo_gene_symbol END) as metastasis_only_genes,\n    COUNT(DISTINCT hugo_gene_symbol) as total_unique_genes\nFROM patient_gene_mutations\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"shared_genes":20,"primary_only_genes":216,"metastasis_only_genes":157,"total_unique_genes":280}]}
```




Calling `clickhouse_run_select_query` with args:
```json
{
  "query": "\n-- Get the shared genes between primary and metastatic samples\nWITH paired_patients AS (\n    SELECT DISTINCT patient_unique_id\n    FROM (\n        SELECT \n            patient_unique_id,\n            COUNT(DISTINCT CASE WHEN attribute_value = 'Primary' THEN sample_unique_id END) as primary_samples,\n            COUNT(DISTINCT CASE WHEN attribute_value = 'Metastasis' THEN sample_unique_id END) as metastatic_samples\n        FROM clinical_data_derived\n        WHERE cancer_study_identifier = 'msk_chord_2024'\n            AND attribute_name = 'SAMPLE_TYPE'\n            AND attribute_value IN ('Primary', 'Metastasis')\n        GROUP BY patient_unique_id\n        HAVING primary_samples > 0 AND metastatic_samples > 0\n    )\n),\nsample_types AS (\n    SELECT \n        cd.sample_unique_id,\n        cd.patient_unique_id,\n        cd.attribute_value as sample_type\n    FROM clinical_data_derived cd\n    INNER JOIN paired_patients pp ON cd.patient_unique_id = pp.patient_unique_id\n    WHERE cd.cancer_study_identifier = 'msk_chord_2024'\n        AND cd.attribute_name = 'SAMPLE_TYPE'\n        AND cd.attribute_value IN ('Primary', 'Metastasis')\n),\npatient_gene_mutations AS (\n    SELECT \n        st.patient_unique_id,\n        g.hugo_gene_symbol,\n        COUNT(DISTINCT CASE WHEN st.sample_type = 'Primary' THEN st.sample_unique_id END) > 0 as in_primary,\n        COUNT(DISTINCT CASE WHEN st.sample_type = 'Metastasis' THEN st.sample_unique_id END) > 0 as in_metastasis\n    FROM sample_types st\n    INNER JOIN genomic_event_derived g \n        ON st.sample_unique_id = g.sample_unique_id\n        AND g.cancer_study_identifier = 'msk_chord_2024'\n        AND g.variant_type = 'mutation'\n    GROUP BY st.patient_unique_id, g.hugo_gene_symbol\n)\nSELECT \n    hugo_gene_symbol,\n    COUNT(*) as patients_with_shared_mutation\nFROM patient_gene_mutations\nWHERE in_primary AND in_metastasis\nGROUP BY hugo_gene_symbol\nORDER BY patients_with_shared_mutation DESC\nLIMIT 20\n"
}
```



Result from `clickhouse_run_select_query`:
```json
{"rows":[{"hugo_gene_symbol":"TP53","patients_with_shared_mutation":6},{"hugo_gene_symbol":"KRAS","patients_with_shared_mutation":3},{"hugo_gene_symbol":"APC","patients_with_shared_mutation":2},{"hugo_gene_symbol":"ARID1B","patients_with_shared_mutation":1},{"hugo_gene_symbol":"NOTCH1","patients_with_shared_mutation":1},{"hugo_gene_symbol":"PTPRD","patients_with_shared_mutation":1},{"hugo_gene_symbol":"IRS2","patients_with_shared_mutation":1},{"hugo_gene_symbol":"FAT1","patients_with_shared_mutation":1},{"hugo_gene_symbol":"LATS2","patients_with_shared_mutation":1},{"hugo_gene_symbol":"POLE","patients_with_shared_mutation":1},{"hugo_gene_symbol":"KMT2C","patients_with_shared_mutation":1},{"hugo_gene_symbol":"INPP4A","patients_with_shared_mutation":1},{"hugo_gene_symbol":"PTEN","patients_with_shared_mutation":1},{"hugo_gene_symbol":"KMT2D","patients_with_shared_mutation":1},{"hugo_gene_symbol":"TBX3","patients_with_shared_mutation":1},{"hugo_gene_symbol":"MST1","patients_with_shared_mutation":1},{"hugo_gene_symbol":"KMT2B","patients_with_shared_mutation":1},{"hugo_gene_symbol":"CDKN2A","patients_with_shared_mutation":1},{"hugo_gene_symbol":"BRAF","patients_with_shared_mutation":1},{"hugo_gene_symbol":"PTCH1","patients_with_shared_mutation":1}]}
```


Now let me create a comprehensive summary of the mutation landscape differences:

## Mutation Landscape Differences Between Primary and Metastatic Samples in MSK-CHORD Study

### Study Overview
I analyzed **26 patients** who had both primary and metastatic samples sequenced in the MSK-CHORD study. These patients represent multiple cancer types:
- **Non-Small Cell Lung Cancer**: 18 patients
- **Colorectal Cancer**: 12 patients  
- **Pancreatic Cancer**: 9 patients
- **Prostate Cancer**: 7 patients
- **Breast Cancer**: 6 patients

*(Note: Some patients may have multiple cancer type classifications)*

---

### Key Findings

#### 1. **Overall Mutation Burden**
Primary tumors showed **higher mutation burden** than metastatic samples:

| Sample Type | Total Mutations | Avg Mutations/Sample | Unique Genes Mutated |
|-------------|----------------|---------------------|---------------------|
| **Primary** | 412 | 15.85 | 222 |
| **Metastasis** | 280 | 10.77 | 164 |

**Tumor Mutational Burden (TMB):**
- Primary: Average 13.41, Median 4.92 (range: 1.11-103.36)
- Metastatic: Average 9.68, Median 5.96 (range: 0.98-51.02)

#### 2. **Mutation Type Distribution**
Both sample types showed similar proportions of mutation types:

| Mutation Type | Primary | Metastasis |
|--------------|---------|------------|
| Missense | 71.4% | 67.9% |
| Frameshift Deletion | 14.8% | 13.6% |
| Nonsense | 7.3% | 9.6% |
| Frameshift Insertion | 3.2% | 4.3% |
| Splice Site | 1.7% | 2.5% |

---

### 3. **Genes Enriched in Metastatic Samples**

Several genes showed **higher mutation frequency in metastases**, suggesting potential roles in metastatic progression:

| Gene | Primary Freq | Metastatic Freq | Enrichment |
|------|-------------|----------------|------------|
| **STK11** | 3.8% | 15.4% | +11.5% |
| **MAP3K1** | 3.8% | 15.4% | +11.5% |
| **MGA** | 0% | 11.5% | +11.5% |
| **CDKN2A** | 3.8% | 11.5% | +7.7% |
| **KEAP1** | 3.8% | 11.5% | +7.7% |
| **TP53** | 50.0% | 57.7% | +7.7% |
| **BRCA1** | 0% | 7.7% | +7.7% |
| **ATR** | 11.5% | 19.2% | +7.7% |

**Notable patterns:**
- **STK11** and **MAP3K1** showed 4-fold enrichment in metastases
- **MGA** was exclusively mutated in metastatic samples
- **TP53** remained the most frequently mutated gene in both types, with slight enrichment in metastases

---

### 4. **Genes Enriched in Primary Samples**

Conversely, several genes were **more frequently mutated in primary tumors**:

| Gene | Primary Freq | Metastatic Freq | Enrichment |
|------|-------------|----------------|------------|
| **RNF43** | 19.2% | 3.8% | +15.4% |
| **MED12** | 15.4% | 0% | +15.4% |
| **BRAF** | 15.4% | 3.8% | +11.5% |
| **POLE** | 15.4% | 3.8% | +11.5% |
| **Multiple genes** | 11.5% | 0% | +11.5% |

---

## Model Information
**Model:** anthropic:claude-sonnet-4-5-20250929
**Provider:** Anthropic
**Max Tokens:** 4096

---

*Generated on 2026-01-28 12:25:35*